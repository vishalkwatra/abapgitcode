sap.ui.define([                                                                                                                                                                                                                                                
	"./BaseController",                                                                                                                                                                                                                                           
	"sap/ui/model/json/JSONModel",                                                                                                                                                                                                                                
	"../model/formatter",                                                                                                                                                                                                                                         
	"sap/ui/model/Filter",                                                                                                                                                                                                                                        
	"sap/ui/model/FilterOperator",                                                                                                                                                                                                                                
	"sap/m/MessageToast",                                                                                                                                                                                                                                         
	"sap/m/MessageBox",                                                                                                                                                                                                                                           
	"sap/ui/core/ListItem",                                                                                                                                                                                                                                       
	"sap/ui/core/format/NumberFormat",                                                                                                                                                                                                                            
	"sap/ui/generic/app/navigation/service/NavigationHandler"                                                                                                                                                                                                     
], function (BaseController, JSONModel, formatter, Filter, FilterOperator, MessageToast, MessageBox, ListItem, NumberFormat,                                                                                                                                   
	NavigationHandler) {                                                                                                                                                                                                                                          
	"use strict";                                                                                                                                                                                                                                                 
	const sLocal = "Local",                                                                                                                                                                                                                                       
		sGlobal = "Global";                                                                                                                                                                                                                                          
	let aModelTable = [];                                                                                                                                                                                                                                         
	return BaseController.extend("ey.sap.fin.cs.effectivetaxrate.controller.MainReport", {                                                                                                                                                                        
                                                                                                                                                                                                                                                               
		formatter: formatter,                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                               
		/* =========================================================== */                                                                                                                                                                                            
		/* lifecycle methods                                           */                                                                                                                                                                                            
		/* =========================================================== */                                                                                                                                                                                            
		onInit: function () {                                                                                                                                                                                                                                        
			this.oRouter = this.getOwnerComponent().getRouter();                                                                                                                                                                                                        
			this.oRouter.getRoute("RouteMainReport").attachMatched(this._onRouteMatched, this);                                                                                                                                                                         
                                                                                                                                                                                                                                                               
			let oViewDataModel = new JSONModel();                                                                                                                                                                                                                       
			this.setModel(oViewDataModel, "viewConfigDataModel");                                                                                                                                                                                                       
                                                                                                                                                                                                                                                               
			this._fetchGlobalParameters();                                                                                                                                                                                                                              
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		/* =========================================================== */                                                                                                                                                                                            
		/* internal methods  -PRIVATE                                  */                                                                                                                                                                                            
		/* =========================================================== */                                                                                                                                                                                            
                                                                                                                                                                                                                                                               
		_onRouteMatched: function () {                                                                                                                                                                                                                               
			this.getBusyDialog().close();                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                               
			// Defaulting Reporting Type Model                                                                                                                                                                                                                          
			this.getView().setModel(new JSONModel({                                                                                                                                                                                                                     
				results: [{                                                                                                                                                                                                                                                
					key: "RGAAP",                                                                                                                                                                                                                                             
					text: this.getI18nText("sBtnTextReportingGAAP")                                                                                                                                                                                                           
				}, {                                                                                                                                                                                                                                                       
					key: "SGAAP",                                                                                                                                                                                                                                             
					text: this.getI18nText("sBtnTextStatutoryReporting")                                                                                                                                                                                                      
				}]                                                                                                                                                                                                                                                         
			}), "modelReportingType");                                                                                                                                                                                                                                  
                                                                                                                                                                                                                                                               
			// Declare global variables here                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                               
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		_fetchGlobalParameters: function () {                                                                                                                                                                                                                        
			var that = this;                                                                                                                                                                                                                                            
			var oModel = this.getOwnerComponent().getModel();                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
			oModel.callFunction("/GlobalParameter", {                                                                                                                                                                                                                   
				method: "GET",                                                                                                                                                                                                                                             
				success: function (oData) {                                                                                                                                                                                                                                
					// Saving global parameters in Model                                                                                                                                                                                                                      
					that.getView().getModel("viewConfigDataModel").setData({                                                                                                                                                                                                  
						"globalParameters": oData                                                                                                                                                                                                                                
					});                                                                                                                                                                                                                                                       
                                                                                                                                                                                                                                                               
					// If 'VARIANT' is being used, Do Not over write global parameters                                                                                                                                                                                        
					let oFilterBar = that.getView().byId("idETRSmartFilterBar");                                                                                                                                                                                              
					if (!oFilterBar.getCurrentVariantId()) {                                                                                                                                                                                                                  
						that._setFilterBarParameters(oData);                                                                                                                                                                                                                     
					}                                                                                                                                                                                                                                                         
				},                                                                                                                                                                                                                                                         
				error: function (oError) {                                                                                                                                                                                                                                 
					MessageBox.error(that.getI18nText("errorReadingGlobalParameters"));                                                                                                                                                                                       
				}                                                                                                                                                                                                                                                          
			});                                                                                                                                                                                                                                                         
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		_setFilterBarParameters: function (oGlobalParameters) {                                                                                                                                                                                                      
			let oView = this.getView(),                                                                                                                                                                                                                                 
				oCurrency = oView.byId("idCurrency");                                                                                                                                                                                                                      
                                                                                                                                                                                                                                                               
			if (oGlobalParameters.LocalCurrencyType && oGlobalParameters.LocalCurrency) {                                                                                                                                                                               
				oCurrency.setSelectedKey(oGlobalParameters.LocalCurrency);                                                                                                                                                                                                 
			} else {                                                                                                                                                                                                                                                    
				oCurrency.setSelectedKey(oGlobalParameters.GroupCurrency);                                                                                                                                                                                                 
			}                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
			if (oGlobalParameters.ConsolidationUnit) {                                                                                                                                                                                                                  
				oView.byId("idConsUnit").setSelectedKey(oGlobalParameters.ConsolidationUnit);                                                                                                                                                                              
				oCurrency.setVisible(true);                                                                                                                                                                                                                                
				this._fetchCurrencyData(true);                                                                                                                                                                                                                             
                                                                                                                                                                                                                                                               
				this.fetchReconLedgerData();                                                                                                                                                                                                                               
			}                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
			if (oGlobalParameters.FiscalYear) {                                                                                                                                                                                                                         
				// Generating a Date mid-year 6th of June - with provided fiscal year.                                                                                                                                                                                     
				let oFiscalYearDate = new Date("06/06/".concat(oGlobalParameters.FiscalYear.toString()));                                                                                                                                                                  
				oView.byId("idFiscalYearFilter").setDateValue(oFiscalYearDate);                                                                                                                                                                                            
			}                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
			if (oGlobalParameters.Intention) {                                                                                                                                                                                                                          
				oView.byId("idIntentionComboBox").setSelectedKey(oGlobalParameters.Intention);                                                                                                                                                                             
			}                                                                                                                                                                                                                                                           
			// Fetch data for Intention. This is independent of Intention data stored in Global Parameter App.                                                                                                                                                          
			//	this._fetchIntentionData(oparam);                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                               
			var aParam = [oGlobalParameters.ConsolidationUnit, oGlobalParameters.FiscalYear];                                                                                                                                                                           
			this._fetchIntentionStatus(aParam);                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                               
			if (oGlobalParameters.PeriodFrom) {                                                                                                                                                                                                                         
				oView.byId("idPeriodFromInput").setValue(formatter.convertStringToInt(oGlobalParameters.PeriodFrom));                                                                                                                                                      
			}                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
			if (oGlobalParameters.PeriodTo) {                                                                                                                                                                                                                           
				oView.byId("idPeriodToInput").setValue(formatter.convertStringToInt(oGlobalParameters.PeriodTo));                                                                                                                                                          
			}                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
			// Check If Valid Tax Rate maintained.                                                                                                                                                                                                                      
			if (oGlobalParameters.ConsolidationUnit && oGlobalParameters.FiscalYear && oGlobalParameters.Intention && oGlobalParameters.PeriodTo) {                                                                                                                     
				this._fetchValidTaxRates();                                                                                                                                                                                                                                
			}                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		getI18nText: function (sTextKey) {                                                                                                                                                                                                                           
			return this.getResourceBundle().getText(sTextKey);                                                                                                                                                                                                          
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		_fetchCurrencyData: function (bIsVariantCall) {                                                                                                                                                                                                              
			var oView = this.getView(),                                                                                                                                                                                                                                 
				consKey = oView.byId("idConsUnit").getSelectedKey(),                                                                                                                                                                                                       
				oFilter = new Filter("ConsolidationUnit", FilterOperator.EQ, consKey),                                                                                                                                                                                     
				oServiceCallModel = this.getModel(),                                                                                                                                                                                                                       
				that = this,                                                                                                                                                                                                                                               
				oCurrencyCtrl = oView.byId("idCurrType"),                                                                                                                                                                                                                  
				oCurrControl = oView.byId("idCurrency");                                                                                                                                                                                                                   
                                                                                                                                                                                                                                                               
			oCurrencyCtrl.setVisible(true);                                                                                                                                                                                                                             
			oCurrControl.setBusy(true);                                                                                                                                                                                                                                 
			oServiceCallModel.read("/xEY1xSAV_C_CurrLocalGroupVH", {                                                                                                                                                                                                    
				method: "GET",                                                                                                                                                                                                                                             
				filters: [oFilter],                                                                                                                                                                                                                                        
				success: function (oData, oResponse) {                                                                                                                                                                                                                     
					oCurrControl.setBusy(false);                                                                                                                                                                                                                              
					that.setModel(new JSONModel(oData), "currLocalGroupVHModel");                                                                                                                                                                                             
					if (!bIsVariantCall && oData.results.length > 0) {                                                                                                                                                                                                        
						oCurrControl.setSelectedKey(oData.results[0].Currency);                                                                                                                                                                                                  
					}                                                                                                                                                                                                                                                         
				},                                                                                                                                                                                                                                                         
				error: function (oError) {                                                                                                                                                                                                                                 
					oCurrControl.setBusy(false);                                                                                                                                                                                                                              
				}                                                                                                                                                                                                                                                          
			});                                                                                                                                                                                                                                                         
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		/*_fetchIntentionData: function () {                                                                                                                                                                                                                         
			let oServiceCallModel = this.getModel();                                                                                                                                                                                                                    
			let sServiceURL = "/xEY1xSAV_C_ReadIntentVH";                                                                                                                                                                                                               
			let that = this;                                                                                                                                                                                                                                            
			this.getBusyDialog().open();                                                                                                                                                                                                                                
			oServiceCallModel.read(sServiceURL, {                                                                                                                                                                                                                       
				method: "GET",                                                                                                                                                                                                                                             
				sorters: [                                                                                                                                                                                                                                                 
					new sap.ui.model.Sorter("SerialNumber")                                                                                                                                                                                                                   
				],                                                                                                                                                                                                                                                         
				success: function (oData, oResponse) {                                                                                                                                                                                                                     
					that.getBusyDialog().close();                                                                                                                                                                                                                             
					let oModel = new JSONModel(oData);                                                                                                                                                                                                                        
					that.getView().setModel(oModel, "intentionVHModel");                                                                                                                                                                                                      
					that._managePeriodFieldsEditability(false);                                                                                                                                                                                                               
				},                                                                                                                                                                                                                                                         
				error: function (oError) {                                                                                                                                                                                                                                 
					that.getBusyDialog().close();                                                                                                                                                                                                                             
					MessageToast.show(that.getI18nText("errorFetchingIntentions"));                                                                                                                                                                                           
				}                                                                                                                                                                                                                                                          
			});                                                                                                                                                                                                                                                         
		},*/                                                                                                                                                                                                                                                         
		_fetchIntentionStatus: function (aParam) {                                                                                                                                                                                                                   
                                                                                                                                                                                                                                                               
			let oServiceCallModel = this.getModel();                                                                                                                                                                                                                    
			let sBunit = aParam[0],                                                                                                                                                                                                                                     
				sYear = aParam[1],                                                                                                                                                                                                                                         
				sServiceURL = "/xEY1xSAV_C_IntentionsStatus(p_bunit='" + sBunit + "')/Set",                                                                                                                                                                                
				oFilter = new Filter("Gjahr", FilterOperator.EQ, sYear),                                                                                                                                                                                                   
				that = this,                                                                                                                                                                                                                                               
				oView = that.getView(),                                                                                                                                                                                                                                    
				oIntentionCtrl = oView.byId("idIntentionComboBox");                                                                                                                                                                                                        
                                                                                                                                                                                                                                                               
			this.getBusyDialog().open();                                                                                                                                                                                                                                
			oServiceCallModel.read(sServiceURL, {                                                                                                                                                                                                                       
				method: "GET",                                                                                                                                                                                                                                             
				sorters: [                                                                                                                                                                                                                                                 
					new sap.ui.model.Sorter("SerialNumber")                                                                                                                                                                                                                   
				],                                                                                                                                                                                                                                                         
				filters: [oFilter],                                                                                                                                                                                                                                        
				success: function (oData, oResponse) {                                                                                                                                                                                                                     
					that.getBusyDialog().close();                                                                                                                                                                                                                             
                                                                                                                                                                                                                                                               
					if (oData.results.length === 0) {                                                                                                                                                                                                                         
						oIntentionCtrl.setSelectedKey('');                                                                                                                                                                                                                       
						oIntentionCtrl.setEnabled(false);                                                                                                                                                                                                                        
						MessageBox.error(that.getI18nText("IntentionNotYetOpen") + sYear);                                                                                                                                                                                       
						return;                                                                                                                                                                                                                                                  
					}                                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                               
					oIntentionCtrl.setEnabled(true);                                                                                                                                                                                                                          
                                                                                                                                                                                                                                                               
					let oGlobalParamter = that.getView().getModel("viewConfigDataModel").getData().globalParameters;                                                                                                                                                          
					oIntentionCtrl.setSelectedKey(oGlobalParamter.Intention);                                                                                                                                                                                                 
                                                                                                                                                                                                                                                               
					let oModel = new JSONModel(oData);                                                                                                                                                                                                                        
					that.getView().setModel(oModel, "intentionVHModel");                                                                                                                                                                                                      
                                                                                                                                                                                                                                                               
					that._managePeriodFieldsEditability(false);                                                                                                                                                                                                               
				},                                                                                                                                                                                                                                                         
				error: function (oError) {                                                                                                                                                                                                                                 
					that.getBusyDialog().close();                                                                                                                                                                                                                             
					MessageBox.error(that.getI18nText("errorFetchingIntentionStatus"));                                                                                                                                                                                       
				}                                                                                                                                                                                                                                                          
			});                                                                                                                                                                                                                                                         
		},                                                                                                                                                                                                                                                           
		_managePeriodFieldsEditability: function (bIsChangeEventCalled) {                                                                                                                                                                                            
			let oView = this.getView(),                                                                                                                                                                                                                                 
				oIntentionCtrl = oView.byId("idIntentionComboBox");                                                                                                                                                                                                        
                                                                                                                                                                                                                                                               
			if (!bIsChangeEventCalled) {                                                                                                                                                                                                                                
				oIntentionCtrl.setSelectedKey(oIntentionCtrl.getSelectedKey());                                                                                                                                                                                            
			}                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
			let oSelectedItem = oIntentionCtrl.getSelectedItem(),                                                                                                                                                                                                       
				oSelectedData = oSelectedItem.getBindingContext("intentionVHModel").getObject();                                                                                                                                                                           
                                                                                                                                                                                                                                                               
			let oPeriodTo = oView.byId("idPeriodToInput"),                                                                                                                                                                                                              
				iTaxIntentionVal = formatter.convertStringToInt(oSelectedData.TaxIntention);                                                                                                                                                                               
                                                                                                                                                                                                                                                               
			if (iTaxIntentionVal !== formatter.convertStringToInt(0)) {                                                                                                                                                                                                 
				this._manageIntentionStatus(oSelectedData);                                                                                                                                                                                                                
				oPeriodTo.setEditable(false);                                                                                                                                                                                                                              
				oPeriodTo.setValue(formatter.convertStringToInt(oSelectedData.PeriodTo));                                                                                                                                                                                  
			} else {                                                                                                                                                                                                                                                    
				this._managePerodicIntentionStatus(oSelectedData.PeriodTo);                                                                                                                                                                                                
				// IF 'PERIODIC' selected, then set Editable                                                                                                                                                                                                               
				oPeriodTo.setEditable(true);                                                                                                                                                                                                                               
				oPeriodTo.setValue(formatter.convertStringToInt(oSelectedData.CurrOpenPeriod));                                                                                                                                                                            
				// oPeriodTo.setValue(0);}                                                                                                                                                                                                                                 
			}                                                                                                                                                                                                                                                           
		},                                                                                                                                                                                                                                                           
		_manageIntentionStatus: function (oSelectedData) {                                                                                                                                                                                                           
			let that = this;                                                                                                                                                                                                                                            
			if (oSelectedData.status === this.getI18nText("YetToOpen")) {                                                                                                                                                                                               
				that.getBusyDialog().close();                                                                                                                                                                                                                              
				MessageBox.error(oSelectedData.IntentDescription + " " + that.getI18nText("ThisIntentionNotYetOpen") + oSelectedData.Gjahr);                                                                                                                               
				return;                                                                                                                                                                                                                                                    
			} else {                                                                                                                                                                                                                                                    
				return;                                                                                                                                                                                                                                                    
			}                                                                                                                                                                                                                                                           
		},                                                                                                                                                                                                                                                           
		_managePerodicIntentionStatus: function (paramToYb) {                                                                                                                                                                                                        
			let oSelectedIntention = this.getView().byId("idIntentionComboBox").getSelectedItem().getBindingContext("intentionVHModel").getObject(),                                                                                                                    
				iCurrentPeriod = parseInt(oSelectedIntention.CurrOpenPeriod, [10]);                                                                                                                                                                                        
			if (paramToYb > iCurrentPeriod) {                                                                                                                                                                                                                           
				this.getBusyDialog().close();                                                                                                                                                                                                                              
				MessageBox.error(this.getModel("i18n").getResourceBundle().getText("errorPeriodnotopen", [paramToYb, iCurrentPeriod]));                                                                                                                                    
				return;                                                                                                                                                                                                                                                    
			} else {                                                                                                                                                                                                                                                    
				return;                                                                                                                                                                                                                                                    
			}                                                                                                                                                                                                                                                           
		},                                                                                                                                                                                                                                                           
		fetchReconLedgerData: function () {                                                                                                                                                                                                                          
			let oServiceCallModel = this.getModel();                                                                                                                                                                                                                    
			let sServiceURL = oServiceCallModel.createKey("/xEY1xSAV_C_Recon_Ledger", {                                                                                                                                                                                 
				"bunit": this.byId("idConsUnit").getSelectedKey()                                                                                                                                                                                                          
			});                                                                                                                                                                                                                                                         
			let that = this;                                                                                                                                                                                                                                            
			oServiceCallModel.read(sServiceURL, {                                                                                                                                                                                                                       
				method: "GET",                                                                                                                                                                                                                                             
				success: function (oData, oResponse) {                                                                                                                                                                                                                     
					var oModel = that.getModel("viewConfigDataModel");                                                                                                                                                                                                        
					oModel.getData().reconData = oData;                                                                                                                                                                                                                       
					oModel.refresh();                                                                                                                                                                                                                                         
				},                                                                                                                                                                                                                                                         
				error: function (oError) {                                                                                                                                                                                                                                 
					if (parseInt(oError.statusCode, [10]) !== 404) {                                                                                                                                                                                                          
						MessageToast.show(that.getI18nText("reconServiceCallError"));                                                                                                                                                                                            
					}                                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                               
				}                                                                                                                                                                                                                                                          
			});                                                                                                                                                                                                                                                         
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		_fetchValidTaxRates: function () {                                                                                                                                                                                                                           
			let that = this,                                                                                                                                                                                                                                            
				oView = this.getView(),                                                                                                                                                                                                                                    
				sCnsldtnUnitKey = oView.byId("idConsUnit").getSelectedKey(),                                                                                                                                                                                               
				sPeriodTo = oView.byId("idPeriodToInput").getValue(),                                                                                                                                                                                                      
				oFiscalDate = oView.byId("idFiscalYearFilter").getDateValue(),                                                                                                                                                                                             
				oServiceCallModel = this.getModel();                                                                                                                                                                                                                       
                                                                                                                                                                                                                                                               
			// For change Events of controls - If value blank, do not proceed.                                                                                                                                                                                          
			if (!sCnsldtnUnitKey || !sPeriodTo || !oFiscalDate) {                                                                                                                                                                                                       
				return;                                                                                                                                                                                                                                                    
			}                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
			let sFiscalYearVal = oFiscalDate.getFullYear();                                                                                                                                                                                                             
                                                                                                                                                                                                                                                               
			// If no value exists - return                                                                                                                                                                                                                              
			if (!sCnsldtnUnitKey || !sPeriodTo || !oFiscalDate || !sFiscalYearVal) {                                                                                                                                                                                    
				return;                                                                                                                                                                                                                                                    
			}                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
			let sServiceURL = "/xEY1xSAV_C_Get_Tax_Rate(p_toperiod='" + sPeriodTo + "',p_ryear='" +                                                                                                                                                                     
				sFiscalYearVal + "',p_rbunit='" + sCnsldtnUnitKey + "')/Set";                                                                                                                                                                                              
			oServiceCallModel.read(sServiceURL, {                                                                                                                                                                                                                       
				method: "GET",                                                                                                                                                                                                                                             
				success: function (oData) {                                                                                                                                                                                                                                
					if (oData.results.length < 1) {                                                                                                                                                                                                                           
						MessageBox.warning(that.getI18nText("warningTaxRatesNotMaintained"));                                                                                                                                                                                    
					}                                                                                                                                                                                                                                                         
				},                                                                                                                                                                                                                                                         
				error: function (oError) {                                                                                                                                                                                                                                 
					MessageToast.show(that.getI18nText("warningFetchingTaxRates"));                                                                                                                                                                                           
				}                                                                                                                                                                                                                                                          
			});                                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                               
		},                                                                                                                                                                                                                                                           
		_getIntentionForManageTier: function () {                                                                                                                                                                                                                    
			let iPeriodTo = this.getView().byId("idPeriodToInput").getValue(),                                                                                                                                                                                          
				sIntention;                                                                                                                                                                                                                                                
			if (parseInt(iPeriodTo, [10]) <= 3) {                                                                                                                                                                                                                       
				sIntention = "Q1";                                                                                                                                                                                                                                         
			} else if (parseInt(iPeriodTo, [10]) > 3 && parseInt(iPeriodTo, [10]) <= 6) {                                                                                                                                                                               
				sIntention = "Q2";                                                                                                                                                                                                                                         
			} else if (parseInt(iPeriodTo, [10]) > 6 && parseInt(iPeriodTo, [10]) <= 9) {                                                                                                                                                                               
				sIntention = "Q3";                                                                                                                                                                                                                                         
			} else {                                                                                                                                                                                                                                                    
				sIntention = "TXP";                                                                                                                                                                                                                                        
			}                                                                                                                                                                                                                                                           
			return sIntention;                                                                                                                                                                                                                                          
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		_fetchTiers: function () {                                                                                                                                                                                                                                   
			let that = this,                                                                                                                                                                                                                                            
				oView = this.getView(),                                                                                                                                                                                                                                    
				sCountryKeyVal = oView.byId("idConsUnit").getSelectedItem().getBindingContext().getObject().Country,                                                                                                                                                       
				sFiscalYearVal = oView.byId("idFiscalYearFilter").getDateValue().getFullYear(),                                                                                                                                                                            
				sIntention = oView.byId("idIntentionComboBox").getSelectedKey(),                                                                                                                                                                                           
				oServiceCallModel = this.getModel();                                                                                                                                                                                                                       
                                                                                                                                                                                                                                                               
			if (sIntention === "PER") {                                                                                                                                                                                                                                 
				sIntention = this._getIntentionForManageTier();                                                                                                                                                                                                            
			}                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
			// If no value exists - return                                                                                                                                                                                                                              
			if (!sCountryKeyVal || !sFiscalYearVal || !sIntention) {                                                                                                                                                                                                    
				return;                                                                                                                                                                                                                                                    
			}                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
			let sServiceURL = "/xEY1xSAV_C_TIERS";                                                                                                                                                                                                                      
			oServiceCallModel.read(sServiceURL, {                                                                                                                                                                                                                       
				method: "GET",                                                                                                                                                                                                                                             
				filters: [new Filter("CountryKey", "EQ", sCountryKeyVal), new Filter("FiscalYear", "EQ", sFiscalYearVal), new Filter(                                                                                                                                      
					"Intention",                                                                                                                                                                                                                                              
					"EQ", sIntention)],                                                                                                                                                                                                                                       
				success: function (oData) {                                                                                                                                                                                                                                
					if (oData.results.length < 1) {                                                                                                                                                                                                                           
						MessageBox.warning(that.getI18nText("errorTiersNotMaintained"));                                                                                                                                                                                         
					}                                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                               
					//	Save Tiers data in view model.                                                                                                                                                                                                                         
					that.getView().setModel(new JSONModel(oData), "ManageTiersModel");                                                                                                                                                                                        
				},                                                                                                                                                                                                                                                         
				error: function (oError) {                                                                                                                                                                                                                                 
					MessageToast.show(that.getI18nText("warningFetchingTiers"));                                                                                                                                                                                              
				}                                                                                                                                                                                                                                                          
			});                                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                               
		},                                                                                                                                                                                                                                                           
		_EmptyTableCall: function () {                                                                                                                                                                                                                               
			let oView = this.getView();                                                                                                                                                                                                                                 
			oView.byId("idTableITDCTR").getModel("ITDCTRTableModel").setData([]);                                                                                                                                                                                       
			oView.byId("idITDCTRFooter").getModel("ITDCTRFooterTableModel").setData([]);                                                                                                                                                                                
			oView.byId("idTableSummaryTEB").getModel("SummaryTEBTableModel").setData([]);                                                                                                                                                                               
			oView.byId("idTableDDCTRTD").getModel("DDCTRTDTableModel").setData([]);                                                                                                                                                                                     
			oView.byId("idDDCTRTDFooter").getModel("DDCTRFooterTableModel").setData([]);                                                                                                                                                                                
			oView.byId("idTableBDNDTCPD").getModel("BDNDTCPDTableModel").setData([]);                                                                                                                                                                                   
			oView.byId("idBDNDTCPDFooter").getModel("BDNDTCPDFooterTableModel").setData([]);                                                                                                                                                                            
			oView.byId("idTablePTA").getModel("PTATableModel").setData([]);                                                                                                                                                                                             
			oView.byId("idPTAFooter").getModel("PTAFooterTableModel").setData([]);                                                                                                                                                                                      
			oView.byId("idTableCTRETD").getModel("CTRETDTableModel").setData([]);                                                                                                                                                                                       
			oView.byId("idCTRETDFooter").getModel("CTRETDFooterTableModel").setData([]);                                                                                                                                                                                
		},                                                                                                                                                                                                                                                           
		//service calls to fetch data for all the tabs                                                                                                                                                                                                               
		_fetchAllTabsData: function () {                                                                                                                                                                                                                             
                                                                                                                                                                                                                                                               
			let oView = this.getView(),                                                                                                                                                                                                                                 
				globalParameterData = oView.getModel("viewConfigDataModel").getData();                                                                                                                                                                                     
			if (!globalParameterData.globalParameters || !globalParameterData.globalParameters.ConsolidationChartofAccounts || !                                                                                                                                        
				globalParameterData.globalParameters.ConsolidationGroup) {                                                                                                                                                                                                 
				MessageBox.error(this.getI18nText("errorMaintainGlobalParameter"));                                                                                                                                                                                        
				return;                                                                                                                                                                                                                                                    
			}                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
			let idConsUnit = oView.byId("idConsUnit"),                                                                                                                                                                                                                  
				oConsUnit = idConsUnit.getSelectedKey(),                                                                                                                                                                                                                   
				idCurrType = oView.byId("idCurrency"),                                                                                                                                                                                                                     
				sCurrencyUnit = idCurrType.getSelectedKey(),                                                                                                                                                                                                               
				sCurrText = idCurrType.getSelectedItem().getProperty("additionalText"),                                                                                                                                                                                    
				sCountry = idConsUnit.getSelectedItem().getBindingContext().getObject().Country,                                                                                                                                                                           
				sIntention = oView.byId("idIntentionComboBox").getSelectedKey(),                                                                                                                                                                                           
				oFiscalYear = oView.byId("idFiscalYearFilter"),                                                                                                                                                                                                            
				sFiscalYearVal = oFiscalYear.getDateValue().getFullYear(),                                                                                                                                                                                                 
				oPeriodTo = oView.byId("idPeriodToInput"),                                                                                                                                                                                                                 
				paramToYB = parseInt(oPeriodTo.getValue(), [10]),                                                                                                                                                                                                          
				oPeriodFrom = oView.byId("idPeriodFromInput"),                                                                                                                                                                                                             
				paramFromYB = parseInt(oPeriodFrom.getValue(), [10]),                                                                                                                                                                                                      
				sSwitch = "X";                                                                                                                                                                                                                                             
                                                                                                                                                                                                                                                               
			if (oView.byId("idIntentionComboBox").getEnabled() === false) {                                                                                                                                                                                             
				MessageBox.error(this.getI18nText("IntentionNotYetOpen") + sFiscalYearVal);                                                                                                                                                                                
				if (aModelTable.length > 0) {                                                                                                                                                                                                                              
					this._EmptyTableCall();                                                                                                                                                                                                                                   
				}                                                                                                                                                                                                                                                          
				return;                                                                                                                                                                                                                                                    
			}                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
			// Intention Filter Data                                                                                                                                                                                                                                    
			let oIntentionBinding = oView.byId("idIntentionComboBox").getSelectedItem().getBindingContext("intentionVHModel"),                                                                                                                                          
				oSelectedData = oIntentionBinding.getObject(),                                                                                                                                                                                                             
				iCurrentPeriod = parseInt(oSelectedData.CurrOpenPeriod, [10]);                                                                                                                                                                                             
			if (oSelectedData.status === this.getI18nText("YetToOpen")) {                                                                                                                                                                                               
				this.getBusyDialog().close();                                                                                                                                                                                                                              
				MessageBox.error(oSelectedData.IntentDescription + " " + this.getI18nText("ThisIntentionNotYetOpen") + oSelectedData.Gjahr);                                                                                                                               
				if (aModelTable.length > 0) {                                                                                                                                                                                                                              
					this._EmptyTableCall();                                                                                                                                                                                                                                   
				}                                                                                                                                                                                                                                                          
				return;                                                                                                                                                                                                                                                    
			}                                                                                                                                                                                                                                                           
			if (paramToYB > iCurrentPeriod) {                                                                                                                                                                                                                           
				this.getBusyDialog().close();                                                                                                                                                                                                                              
				MessageBox.error(this.getModel("i18n").getResourceBundle().getText("errorPeriodnotopen", [paramToYB, iCurrentPeriod]));                                                                                                                                    
				if (aModelTable.length > 0) {                                                                                                                                                                                                                              
					this._EmptyTableCall();                                                                                                                                                                                                                                   
				}                                                                                                                                                                                                                                                          
				return;                                                                                                                                                                                                                                                    
			}                                                                                                                                                                                                                                                           
			// Intention Filter Data                                                                                                                                                                                                                                    
			let iTaxIntentionVal = (oView.byId("idIntentionComboBox").getSelectedItem()) ? parseInt(oView.byId("idIntentionComboBox").getSelectedItem()                                                                                                                 
					.getBindingContext("intentionVHModel").getObject().TaxIntention, [10]) : globalParameterData.globalParameters.TaxIntention,                                                                                                                               
				//intentionValue = sIntention,//iSpecialPeriodVal > 12 ? iSpecialPeriodVal : '',                                                                                                                                                                           
				intentionValue = iTaxIntentionVal > 100 ? iTaxIntentionVal : '',                                                                                                                                                                                           
				oReportTypeContent = this.getView().byId("idFragContent--idETRReconSegmentedBtn"),                                                                                                                                                                         
				oReportTypeSnapContent = this.getView().byId("idFragSnapContent--idETRReconSegmentedBtn"),                                                                                                                                                                 
				sReportingType;                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                               
			if (sIntention === "PER") {                                                                                                                                                                                                                                 
				sIntention = this._getIntentionForManageTier();                                                                                                                                                                                                            
			}                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
			// If keys for both fragments same.                                                                                                                                                                                                                         
			if (oReportTypeContent.getSelectedKey() === oReportTypeSnapContent.getSelectedKey()) {                                                                                                                                                                      
				sReportingType = oReportTypeContent.getSelectedKey();                                                                                                                                                                                                      
			} else { // Default Reporting Type                                                                                                                                                                                                                          
				sReportingType = "RGAAP";                                                                                                                                                                                                                                  
			}                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
			// Filters                                                                                                                                                                                                                                                  
			let afilters = [new Filter("ConsolidationUnit", FilterOperator.EQ, oConsUnit),                                                                                                                                                                              
					new Filter("ChartOfAccounts", FilterOperator.EQ, "CANA"),                                                                                                                                                                                                 
					new Filter("ConsolidationChartofAccounts", FilterOperator.EQ, globalParameterData.globalParameters.ConsolidationChartofAccounts),                                                                                                                         
					new Filter("MainCurrency", FilterOperator.EQ, sCurrencyUnit)                                                                                                                                                                                              
				],                                                                                                                                                                                                                                                         
				aTypeFilters = [new Filter("CurrencyType", FilterOperator.EQ, sCurrText),                                                                                                                                                                                  
					new Filter("ReportingType", FilterOperator.EQ, sReportingType)                                                                                                                                                                                            
				],                                                                                                                                                                                                                                                         
				oMandFilters = new Filter({                                                                                                                                                                                                                                
					filters: [...afilters],                                                                                                                                                                                                                                   
					and: true                                                                                                                                                                                                                                                 
				}),                                                                                                                                                                                                                                                        
				oAllFilters = new Filter({                                                                                                                                                                                                                                 
					filters: [...afilters, ...aTypeFilters],                                                                                                                                                                                                                  
					and: true                                                                                                                                                                                                                                                 
				});                                                                                                                                                                                                                                                        
			aModelTable = [];                                                                                                                                                                                                                                           
			//---------------------------------- Service Call  -------------------------------------------                                                                                                                                                              
			// --------------------	Service URL for Summary ITDCTR section	-----------------------------------                                                                                                                                                          
			let sServiceURLITDCTR = "/xEY1xSAV_C_ETR_SUM_ITDCTR(p_rbunit='" + oConsUnit + "',p_ryear='" + sFiscalYearVal + "',p_fromperiod='" +                                                                                                                         
				paramFromYB + "',p_toperiod='" + paramToYB + "',p_switch='" + sSwitch + "',p_taxintention='" + intentionValue + "',p_currtype='" +                                                                                                                         
				sCurrText + "',p_intention='" + sIntention + "')/Set";                                                                                                                                                                                                     
                                                                                                                                                                                                                                                               
			let oParameters = {                                                                                                                                                                                                                                         
				"p_cntry": sCountry,                                                                                                                                                                                                                                       
				"p_ryear": sFiscalYearVal,                                                                                                                                                                                                                                 
				"p_fromperiod": paramFromYB,                                                                                                                                                                                                                               
				"p_toperiod": paramToYB,                                                                                                                                                                                                                                   
				"p_switch": sSwitch,                                                                                                                                                                                                                                       
				"p_taxintention": intentionValue,                                                                                                                                                                                                                          
				"p_intention": sIntention,                                                                                                                                                                                                                                 
				"p_rbunit": oConsUnit,                                                                                                                                                                                                                                     
				"p_currtype": sCurrText,                                                                                                                                                                                                                                   
				"oMandFilters": oMandFilters,                                                                                                                                                                                                                              
				"oAllFilters": oAllFilters                                                                                                                                                                                                                                 
			};                                                                                                                                                                                                                                                          
                                                                                                                                                                                                                                                               
			this._serviceCallITDCTR(sServiceURLITDCTR, oParameters);                                                                                                                                                                                                    
                                                                                                                                                                                                                                                               
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		//----------------------	Service Call for Summary ITDCTR section	--------------------------                                                                                                                                                                  
		_serviceCallITDCTR: function (sServiceURLITDCTR, oParams) {                                                                                                                                                                                                  
			let oServiceCallModel = this.getModel(),                                                                                                                                                                                                                    
				oITDCTRTable = this.getView().byId("idTableITDCTR"),                                                                                                                                                                                                       
				oFooterTableITDCTR = this.getView().byId("idITDCTRFooter"),                                                                                                                                                                                                
				oSummaryTEBTable = this.getView().byId("idTableSummaryTEB"),                                                                                                                                                                                               
				that = this;                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                               
			oITDCTRTable.setBusy(true);                                                                                                                                                                                                                                 
			oFooterTableITDCTR.setBusy(true);                                                                                                                                                                                                                           
			oSummaryTEBTable.setBusy(true);                                                                                                                                                                                                                             
			oServiceCallModel.read(sServiceURLITDCTR, {                                                                                                                                                                                                                 
				method: "GET",                                                                                                                                                                                                                                             
				success: function (oData, oResponse) {                                                                                                                                                                                                                     
					oITDCTRTable.setBusy(false);                                                                                                                                                                                                                              
					oITDCTRTable.setModel(new JSONModel(oData), "ITDCTRTableModel");                                                                                                                                                                                          
					oITDCTRTable.setVisibleRowCount(oData.results.length);                                                                                                                                                                                                    
					aModelTable.push(oITDCTRTable.getModel("ITDCTRTableModel"));                                                                                                                                                                                              
					that._fetchRemainingSections(oParams);                                                                                                                                                                                                                    
				},                                                                                                                                                                                                                                                         
				error: function (oError) {                                                                                                                                                                                                                                 
					oITDCTRTable.setBusy(false);                                                                                                                                                                                                                              
					MessageToast.show(that.getI18nText("ITDCTRServiceCallError"));                                                                                                                                                                                            
				}                                                                                                                                                                                                                                                          
			});                                                                                                                                                                                                                                                         
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		_fetchRemainingSections: function (oParams) {                                                                                                                                                                                                                
			//---------------------------------service call for Summary ITDCTR footer section---------------------------------                                                                                                                                          
			let sServiceURLITDCTRDetails = "/xEY1xSAV_C_ETR_SUM_ITDCTRTotal(p_cntry='" + oParams.p_cntry + "',p_ryear='" + oParams.p_ryear +                                                                                                                            
				"',p_intention='" + oParams.p_intention + "')/Set";                                                                                                                                                                                                        
			this._serviceCallITDCTRFooter(sServiceURLITDCTRDetails, oParams.oMandFilters);                                                                                                                                                                              
                                                                                                                                                                                                                                                               
			//---------------------------------service call for Summary Overview section---------------------------------                                                                                                                                               
			let sServiceURLSummaryTEB = "/xEY1xSAV_C_ETR_SUM_Overview(p_cntry='" + oParams.p_cntry + "',p_ryear='" + oParams.p_ryear +                                                                                                                                  
				"',p_fromperiod='" + oParams.p_fromperiod + "',p_toperiod='" + oParams.p_toperiod + "',p_switch='" + oParams.p_switch +                                                                                                                                    
				"',p_taxintention='" + oParams.p_taxintention + "',p_intention='" + oParams.p_intention + "',p_rbunit='" + oParams.p_rbunit +                                                                                                                              
				"')/Set";                                                                                                                                                                                                                                                  
			this._serviceCallSummaryTEB(sServiceURLSummaryTEB, oParams.oAllFilters);                                                                                                                                                                                    
                                                                                                                                                                                                                                                               
			//---------------------------------service call for DD CTR Temorary Difference---------------------------------                                                                                                                                             
			let sServiceURLSummaryDDCTRTD = "/xEY1xSAV_C_ETR_SUM_DDCTRTD(p_fromperiod='" + oParams.p_fromperiod + "',p_toperiod='" + oParams                                                                                                                            
				.p_toperiod + "',p_ryear='" + oParams.p_ryear + "',p_switch='" + oParams.p_switch + "',p_taxintention='" + oParams.p_taxintention +                                                                                                                        
				"',p_rbunit='" + oParams.p_rbunit + "')/Set";                                                                                                                                                                                                              
			this._serviceCallSummaryDDCTRTD(sServiceURLSummaryDDCTRTD, oParams.oAllFilters);                                                                                                                                                                            
                                                                                                                                                                                                                                                               
			//---------------------------------service call for DD CTR Temorary Difference FOOTER---------------------------------                                                                                                                                      
			let sServiceURLSummaryDDCTRTDFooter = "/xEY1xSAV_C_ETR_SUM_DDCTRTotal(p_fromperiod='" + oParams.p_fromperiod + "',p_toperiod='" +                                                                                                                           
				oParams                                                                                                                                                                                                                                                    
				.p_toperiod + "',p_ryear='" + oParams.p_ryear + "',p_switch='" + oParams.p_switch + "',p_taxintention='" + oParams.p_taxintention +                                                                                                                        
				"',p_rbunit='" + oParams.p_rbunit + "')/Set";                                                                                                                                                                                                              
			this._serviceCallSummaryDDCTRTDFooter(sServiceURLSummaryDDCTRTDFooter, oParams.oAllFilters);                                                                                                                                                                
                                                                                                                                                                                                                                                               
			//---------------------------------service call for BDNDTCPD Permanent Difference---------------------------------                                                                                                                                          
			let sServiceURLBDNDTCPD = "/xEY1xSAV_C_ETR_BDTPD_BDNDTPD(p_fromperiod='" + oParams.p_fromperiod + "',p_toperiod='" + oParams                                                                                                                                
				.p_toperiod + "',p_ryear='" + oParams.p_ryear + "',p_switch='" + oParams.p_switch + "',p_taxintention='" + oParams.p_taxintention +                                                                                                                        
				"',p_rbunit='" + oParams.p_rbunit + "')/Set";                                                                                                                                                                                                              
			this._serviceCallBDNDTCPD(sServiceURLBDNDTCPD, oParams.oAllFilters);                                                                                                                                                                                        
                                                                                                                                                                                                                                                               
			//---------------------------------service call for BDNDTCPD Permanent Difference FOOTER---------------------------------                                                                                                                                   
			let sServiceURLBDNDTCPDFooter = "/xEY1xSAV_C_ETR_BDTPD_BDNDTotal(p_fromperiod='" + oParams.p_fromperiod + "',p_toperiod='" +                                                                                                                                
				oParams.p_toperiod + "',p_ryear='" + oParams.p_ryear + "',p_switch='" + oParams.p_switch + "',p_taxintention='" + oParams.p_taxintention +                                                                                                                 
				"',p_rbunit='" + oParams.p_rbunit + "')/Set";                                                                                                                                                                                                              
			this._serviceCallBDNDTCPDFooter(sServiceURLBDNDTCPDFooter, oParams.oAllFilters);                                                                                                                                                                            
                                                                                                                                                                                                                                                               
			//---------------------------------service call for Permanent Tax Adjustments---------------------------------                                                                                                                                              
			let sServiceURLPTA = "/xEY1xSAV_C_ETR_PTA_Mvmnt(p_fromperiod='" + oParams.p_fromperiod + "',p_toperiod='" + oParams                                                                                                                                         
				.p_toperiod + "',p_ryear='" + oParams.p_ryear + "',p_switch='" + oParams.p_switch + "',p_taxintention='" + oParams.p_taxintention +                                                                                                                        
				"',p_rbunit='" + oParams.p_rbunit + "')/Set";                                                                                                                                                                                                              
			this._serviceCallPTA(sServiceURLPTA, oParams.oAllFilters);                                                                                                                                                                                                  
                                                                                                                                                                                                                                                               
			//---------------------------------service call for Permanent Tax Adjustments FOOTER---------------------------------                                                                                                                                       
			let sServiceURLPTAFooter = "/xEY1xSAV_C_ETR_PTA_Total(p_fromperiod='" + oParams.p_fromperiod + "',p_toperiod='" +                                                                                                                                           
				oParams.p_toperiod + "',p_ryear='" + oParams.p_ryear + "',p_switch='" + oParams.p_switch + "',p_taxintention='" + oParams.p_taxintention +                                                                                                                 
				"',p_rbunit='" + oParams.p_rbunit + "')/Set";                                                                                                                                                                                                              
			this._serviceCallPTAFooter(sServiceURLPTAFooter, oParams.oAllFilters);                                                                                                                                                                                      
                                                                                                                                                                                                                                                               
			//---------------------------------service call for Change in tax rate effect - temporary differences---------------------------------                                                                                                                      
			let sServiceURLCTRETD = "/xEY1xSAV_C_ETR_CTRTDCB(p_fromperiod='" + oParams.p_fromperiod + "',p_toperiod='" + oParams                                                                                                                                        
				.p_toperiod + "',p_ryear='" + oParams.p_ryear + "',p_switch='" + oParams.p_switch + "',p_taxintention='" + oParams.p_taxintention +                                                                                                                        
				"',p_rbunit='" + oParams.p_rbunit + "')/Set";                                                                                                                                                                                                              
			this._serviceCallCTRETD(sServiceURLCTRETD, oParams.oAllFilters);                                                                                                                                                                                            
                                                                                                                                                                                                                                                               
			//---------------------------------service call for Change in tax rate effect - temporary differences FOOTER---------------------------------                                                                                                               
			let sServiceURLCTRETDFooter = "/xEY1xSAV_C_ETR_CTRTDCBTotal(p_fromperiod='" + oParams.p_fromperiod + "',p_toperiod='" +                                                                                                                                     
				oParams.p_toperiod + "',p_ryear='" + oParams.p_ryear + "',p_switch='" + oParams.p_switch + "',p_taxintention='" + oParams.p_taxintention +                                                                                                                 
				"',p_rbunit='" + oParams.p_rbunit + "')/Set";                                                                                                                                                                                                              
			this._serviceCallCTRETDFooter(sServiceURLCTRETDFooter, oParams.oAllFilters);                                                                                                                                                                                
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		//----------------------	service call for Summary ITDCTR footer section                                                                                                                                                                                      
		_serviceCallITDCTRFooter: function (sServiceURLITDCTRDetails, oFilters) {                                                                                                                                                                                    
			let oServiceCallModel = this.getModel(),                                                                                                                                                                                                                    
				oFooterTableITDCTR = this.getView().byId("idITDCTRFooter"),                                                                                                                                                                                                
				that = this;                                                                                                                                                                                                                                               
			//	oFooterTableITDCTR.setBusy(true);                                                                                                                                                                                                                        
			oServiceCallModel.read(sServiceURLITDCTRDetails, {                                                                                                                                                                                                          
				method: "GET",                                                                                                                                                                                                                                             
				filters: [oFilters],                                                                                                                                                                                                                                       
				success: function (oData, oResponse) {                                                                                                                                                                                                                     
                                                                                                                                                                                                                                                               
					// If no data exists, Add dummy entry to show enty structure.                                                                                                                                                                                             
					if (oData.results.length === 0 || that.getView().getModel("ManageTiersModel").getData().results.length === 0) {                                                                                                                                           
						oData.results = [{                                                                                                                                                                                                                                       
							Percentage: "0.00",                                                                                                                                                                                                                                     
							Tax: "0.00"                                                                                                                                                                                                                                             
						}];                                                                                                                                                                                                                                                      
					}                                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                               
					oFooterTableITDCTR.setBusy(false);                                                                                                                                                                                                                        
					oFooterTableITDCTR.setModel(new JSONModel(oData), "ITDCTRFooterTableModel");                                                                                                                                                                              
					aModelTable.push(oFooterTableITDCTR.getModel("ITDCTRFooterTableModel"));                                                                                                                                                                                  
				},                                                                                                                                                                                                                                                         
				error: function (oError) {                                                                                                                                                                                                                                 
					oFooterTableITDCTR.setBusy(false);                                                                                                                                                                                                                        
					MessageToast.show(that.getI18nText("ITDCTRServiceCallError"));                                                                                                                                                                                            
				}                                                                                                                                                                                                                                                          
			});                                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                               
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		//----------------------	Service Call for Summary Overview section	--------------------------                                                                                                                                                                
		_serviceCallSummaryTEB: function (sServiceURLSummaryTEB, oFilters) {                                                                                                                                                                                         
			let oServiceCallModel = this.getModel(),                                                                                                                                                                                                                    
				oSummaryTEBTable = this.getView().byId("idTableSummaryTEB"),                                                                                                                                                                                               
				that = this;                                                                                                                                                                                                                                               
			oServiceCallModel.read(sServiceURLSummaryTEB, {                                                                                                                                                                                                             
				method: "GET",                                                                                                                                                                                                                                             
				filters: [oFilters],                                                                                                                                                                                                                                       
				sorters: [                                                                                                                                                                                                                                                 
					new sap.ui.model.Sorter("SerialNo")                                                                                                                                                                                                                       
				],                                                                                                                                                                                                                                                         
				success: function (oData, oResponse) {                                                                                                                                                                                                                     
					oSummaryTEBTable.setBusy(false);                                                                                                                                                                                                                          
					oSummaryTEBTable.setModel(new JSONModel(oData), "SummaryTEBTableModel");                                                                                                                                                                                  
					oSummaryTEBTable.setVisibleRowCount(oData.results.length);                                                                                                                                                                                                
					aModelTable.push(oSummaryTEBTable.getModel("SummaryTEBTableModel"));                                                                                                                                                                                      
				},                                                                                                                                                                                                                                                         
				error: function (oError) {                                                                                                                                                                                                                                 
					oSummaryTEBTable.setBusy(false);                                                                                                                                                                                                                          
					MessageToast.show(that.getI18nText("ITDCTRServiceCallError"));                                                                                                                                                                                            
				}                                                                                                                                                                                                                                                          
			});                                                                                                                                                                                                                                                         
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		//----------------------	Service Call for Summary DDCTRTD section	--------------------------                                                                                                                                                                 
		_serviceCallSummaryDDCTRTD: function (sServiceURLSummaryDDCTRTD, oFilters) {                                                                                                                                                                                 
			let oServiceCallModel = this.getModel(),                                                                                                                                                                                                                    
				oSummaryDDCTRTDTable = this.getView().byId("idTableDDCTRTD"),                                                                                                                                                                                              
				that = this;                                                                                                                                                                                                                                               
			oServiceCallModel.read(sServiceURLSummaryDDCTRTD, {                                                                                                                                                                                                         
				method: "GET",                                                                                                                                                                                                                                             
				filters: [oFilters],                                                                                                                                                                                                                                       
				sorters: [                                                                                                                                                                                                                                                 
					new sap.ui.model.Sorter("GLAccount")                                                                                                                                                                                                                      
				],                                                                                                                                                                                                                                                         
				success: function (oData, oResponse) {                                                                                                                                                                                                                     
					oSummaryDDCTRTDTable.setBusy(false);                                                                                                                                                                                                                      
					oSummaryDDCTRTDTable.setModel(new JSONModel(oData), "DDCTRTDTableModel");                                                                                                                                                                                 
					oSummaryDDCTRTDTable.setVisibleRowCount(oData.results.length);                                                                                                                                                                                            
					aModelTable.push(oSummaryDDCTRTDTable.getModel("DDCTRTDTableModel"));                                                                                                                                                                                     
				},                                                                                                                                                                                                                                                         
				error: function (oError) {                                                                                                                                                                                                                                 
					oSummaryDDCTRTDTable.setBusy(false);                                                                                                                                                                                                                      
					MessageToast.show(that.getI18nText("DDCTRTDServiceCallError"));                                                                                                                                                                                           
				}                                                                                                                                                                                                                                                          
			});                                                                                                                                                                                                                                                         
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		//----------------------	Service Call for Summary DDCTRTD section	--------------------------                                                                                                                                                                 
		_serviceCallSummaryDDCTRTDFooter: function (sServiceURLSummaryDDCTRTDFooter, oFilters) {                                                                                                                                                                     
			let oServiceCallModel = this.getModel(),                                                                                                                                                                                                                    
				oSummaryDDCTRTDTableFooter = this.getView().byId("idDDCTRTDFooter"),                                                                                                                                                                                       
				that = this;                                                                                                                                                                                                                                               
			oServiceCallModel.read(sServiceURLSummaryDDCTRTDFooter, {                                                                                                                                                                                                   
				method: "GET",                                                                                                                                                                                                                                             
				filters: [oFilters],                                                                                                                                                                                                                                       
				success: function (oData, oResponse) {                                                                                                                                                                                                                     
					oSummaryDDCTRTDTableFooter.setBusy(false);                                                                                                                                                                                                                
					oSummaryDDCTRTDTableFooter.setModel(new JSONModel(oData), "DDCTRFooterTableModel");                                                                                                                                                                       
					// oSummaryDDCTRTDTableFooter.setVisibleRowCount(oData.results.length);                                                                                                                                                                                   
					aModelTable.push(oSummaryDDCTRTDTableFooter.getModel("DDCTRFooterTableModel"));                                                                                                                                                                           
				},                                                                                                                                                                                                                                                         
				error: function (oError) {                                                                                                                                                                                                                                 
					oSummaryDDCTRTDTableFooter.setBusy(false);                                                                                                                                                                                                                
					MessageToast.show(that.getI18nText("DDCTRFooterServiceCallError"));                                                                                                                                                                                       
				}                                                                                                                                                                                                                                                          
			});                                                                                                                                                                                                                                                         
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		//---------------------------------service call for BDNDTCPD Permanent Difference---------------------------------                                                                                                                                           
		_serviceCallBDNDTCPD: function (sServiceURLBDNDTCPD, oFilters) {                                                                                                                                                                                             
			let oServiceCallModel = this.getModel(),                                                                                                                                                                                                                    
				oBDNDTCPDTable = this.getView().byId("idTableBDNDTCPD"),                                                                                                                                                                                                   
				that = this;                                                                                                                                                                                                                                               
			oServiceCallModel.read(sServiceURLBDNDTCPD, {                                                                                                                                                                                                               
				method: "GET",                                                                                                                                                                                                                                             
				filters: [oFilters],                                                                                                                                                                                                                                       
				sorters: [                                                                                                                                                                                                                                                 
					new sap.ui.model.Sorter("GLAccount")                                                                                                                                                                                                                      
				],                                                                                                                                                                                                                                                         
				success: function (oData, oResponse) {                                                                                                                                                                                                                     
					oBDNDTCPDTable.setBusy(false);                                                                                                                                                                                                                            
					oBDNDTCPDTable.setModel(new JSONModel(oData), "BDNDTCPDTableModel");                                                                                                                                                                                      
					oBDNDTCPDTable.setVisibleRowCount(oData.results.length);                                                                                                                                                                                                  
					aModelTable.push(oBDNDTCPDTable.getModel("BDNDTCPDTableModel"));                                                                                                                                                                                          
				},                                                                                                                                                                                                                                                         
				error: function (oError) {                                                                                                                                                                                                                                 
					oBDNDTCPDTable.setBusy(false);                                                                                                                                                                                                                            
					MessageToast.show(that.getI18nText("BDNDTCPDServiceCallError"));                                                                                                                                                                                          
				}                                                                                                                                                                                                                                                          
			});                                                                                                                                                                                                                                                         
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		//---------------------------------service call for BDNDTCPD Permanent Difference FOOTER---------------------------------                                                                                                                                    
		_serviceCallBDNDTCPDFooter: function (sServiceURLBDNDTCPDFooter, oFilters) {                                                                                                                                                                                 
			let oServiceCallModel = this.getModel(),                                                                                                                                                                                                                    
				oBDNDTCPDTableFooter = this.getView().byId("idBDNDTCPDFooter"),                                                                                                                                                                                            
				that = this;                                                                                                                                                                                                                                               
			oServiceCallModel.read(sServiceURLBDNDTCPDFooter, {                                                                                                                                                                                                         
				method: "GET",                                                                                                                                                                                                                                             
				filters: [oFilters],                                                                                                                                                                                                                                       
				success: function (oData, oResponse) {                                                                                                                                                                                                                     
					oBDNDTCPDTableFooter.setBusy(false);                                                                                                                                                                                                                      
					oBDNDTCPDTableFooter.setModel(new JSONModel(oData), "BDNDTCPDFooterTableModel");                                                                                                                                                                          
					aModelTable.push(oBDNDTCPDTableFooter.getModel("BDNDTCPDFooterTableModel"));                                                                                                                                                                              
				},                                                                                                                                                                                                                                                         
				error: function (oError) {                                                                                                                                                                                                                                 
					oBDNDTCPDTableFooter.setBusy(false);                                                                                                                                                                                                                      
					MessageToast.show(that.getI18nText("BDNDTCPDFooterServiceCallError"));                                                                                                                                                                                    
				}                                                                                                                                                                                                                                                          
			});                                                                                                                                                                                                                                                         
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		//---------------------------------service call for Permanent Tax Adjustments---------------------------------                                                                                                                                               
		_serviceCallPTA: function (sServiceURLPTA, oFilters) {                                                                                                                                                                                                       
			let oServiceCallModel = this.getModel(),                                                                                                                                                                                                                    
				oPTATable = this.getView().byId("idTablePTA"),                                                                                                                                                                                                             
				that = this;                                                                                                                                                                                                                                               
			oServiceCallModel.read(sServiceURLPTA, {                                                                                                                                                                                                                    
				method: "GET",                                                                                                                                                                                                                                             
				filters: [oFilters],                                                                                                                                                                                                                                       
				sorters: [                                                                                                                                                                                                                                                 
					new sap.ui.model.Sorter("GLAccount")                                                                                                                                                                                                                      
				],                                                                                                                                                                                                                                                         
				success: function (oData, oResponse) {                                                                                                                                                                                                                     
					oPTATable.setBusy(false);                                                                                                                                                                                                                                 
					oPTATable.setModel(new JSONModel(oData), "PTATableModel");                                                                                                                                                                                                
					oPTATable.setVisibleRowCount(oData.results.length);                                                                                                                                                                                                       
					aModelTable.push(oPTATable.getModel("PTATableModel"));                                                                                                                                                                                                    
				},                                                                                                                                                                                                                                                         
				error: function (oError) {                                                                                                                                                                                                                                 
					oPTATable.setBusy(false);                                                                                                                                                                                                                                 
					MessageToast.show(that.getI18nText("PTAServiceCallError"));                                                                                                                                                                                               
				}                                                                                                                                                                                                                                                          
			});                                                                                                                                                                                                                                                         
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		//---------------------------------service call for Permanent Tax Adjustmentse FOOTER---------------------------------                                                                                                                                       
                                                                                                                                                                                                                                                               
		_serviceCallPTAFooter: function (sServiceURLPTAFooter, oFilters) {                                                                                                                                                                                           
			let oServiceCallModel = this.getModel(),                                                                                                                                                                                                                    
				oPTATableFooter = this.getView().byId("idPTAFooter"),                                                                                                                                                                                                      
				that = this;                                                                                                                                                                                                                                               
			oServiceCallModel.read(sServiceURLPTAFooter, {                                                                                                                                                                                                              
				method: "GET",                                                                                                                                                                                                                                             
				filters: [oFilters],                                                                                                                                                                                                                                       
				success: function (oData, oResponse) {                                                                                                                                                                                                                     
					oPTATableFooter.setBusy(false);                                                                                                                                                                                                                           
					oPTATableFooter.setModel(new JSONModel(oData), "PTAFooterTableModel");                                                                                                                                                                                    
					aModelTable.push(oPTATableFooter.getModel("PTAFooterTableModel"));                                                                                                                                                                                        
				},                                                                                                                                                                                                                                                         
				error: function (oError) {                                                                                                                                                                                                                                 
					oPTATableFooter.setBusy(false);                                                                                                                                                                                                                           
					MessageToast.show(that.getI18nText("PTAFooterServiceCallError"));                                                                                                                                                                                         
				}                                                                                                                                                                                                                                                          
			});                                                                                                                                                                                                                                                         
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		//---------------------------------service call for Change in tax rate effect - temporary differences---------------------------------                                                                                                                       
		_serviceCallCTRETD: function (sServiceURLCTRETD, oFilters) {                                                                                                                                                                                                 
			let oServiceCallModel = this.getModel(),                                                                                                                                                                                                                    
				oPTATable = this.getView().byId("idTableCTRETD"),                                                                                                                                                                                                          
				that = this;                                                                                                                                                                                                                                               
			oServiceCallModel.read(sServiceURLCTRETD, {                                                                                                                                                                                                                 
				method: "GET",                                                                                                                                                                                                                                             
				filters: [oFilters],                                                                                                                                                                                                                                       
				sorters: [                                                                                                                                                                                                                                                 
					new sap.ui.model.Sorter("GLAccount")                                                                                                                                                                                                                      
				],                                                                                                                                                                                                                                                         
				success: function (oData, oResponse) {                                                                                                                                                                                                                     
					oPTATable.setBusy(false);                                                                                                                                                                                                                                 
					oPTATable.setModel(new JSONModel(oData), "CTRETDTableModel");                                                                                                                                                                                             
					oPTATable.setVisibleRowCount(oData.results.length);                                                                                                                                                                                                       
					aModelTable.push(oPTATable.getModel("CTRETDTableModel"));                                                                                                                                                                                                 
				},                                                                                                                                                                                                                                                         
				error: function (oError) {                                                                                                                                                                                                                                 
					oPTATable.setBusy(false);                                                                                                                                                                                                                                 
					MessageToast.show(that.getI18nText("CTRETDServiceCallError"));                                                                                                                                                                                            
				}                                                                                                                                                                                                                                                          
			});                                                                                                                                                                                                                                                         
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		//---------------------------------service call for Change in tax rate effect - temporary differences FOOTER---------------------------------                                                                                                                
                                                                                                                                                                                                                                                               
		_serviceCallCTRETDFooter: function (sServiceURLCTRETDFooter, oFilters) {                                                                                                                                                                                     
			let oServiceCallModel = this.getModel(),                                                                                                                                                                                                                    
				oPTATableFooter = this.getView().byId("idCTRETDFooter"),                                                                                                                                                                                                   
				that = this;                                                                                                                                                                                                                                               
			oServiceCallModel.read(sServiceURLCTRETDFooter, {                                                                                                                                                                                                           
				method: "GET",                                                                                                                                                                                                                                             
				filters: [oFilters],                                                                                                                                                                                                                                       
				success: function (oData, oResponse) {                                                                                                                                                                                                                     
					oPTATableFooter.setBusy(false);                                                                                                                                                                                                                           
					oPTATableFooter.setModel(new JSONModel(oData), "CTRETDFooterTableModel");                                                                                                                                                                                 
					aModelTable.push(oPTATableFooter.getModel("CTRETDFooterTableModel"));                                                                                                                                                                                     
				},                                                                                                                                                                                                                                                         
				error: function (oError) {                                                                                                                                                                                                                                 
					oPTATableFooter.setBusy(false);                                                                                                                                                                                                                           
					MessageToast.show(that.getI18nText("CTRETDFooterServiceCallError"));                                                                                                                                                                                      
				}                                                                                                                                                                                                                                                          
			});                                                                                                                                                                                                                                                         
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		/* =========================================================== */                                                                                                                                                                                            
		/* event handlers                                              */                                                                                                                                                                                            
		/* =========================================================== */                                                                                                                                                                                            
                                                                                                                                                                                                                                                               
		onSearchButtonPressed: function (oEvent) {                                                                                                                                                                                                                   
			this._fetchAllTabsData();                                                                                                                                                                                                                                   
			this._fetchTiers();                                                                                                                                                                                                                                         
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		onChangeDatePickerFilter: function (oEvent) {                                                                                                                                                                                                                
			let oDP = oEvent.getSource(),                                                                                                                                                                                                                               
				oReconLedgerData = this.getModel("viewConfigDataModel").getData(),                                                                                                                                                                                         
				sBunit = oReconLedgerData.globalParameters.ConsolidationUnit;                                                                                                                                                                                              
			if (oEvent.getParameter("valid")) {                                                                                                                                                                                                                         
				oDP.setValueState("None");                                                                                                                                                                                                                                 
				let sYear = oDP.getDateValue().getFullYear(),                                                                                                                                                                                                              
					aParam = [sBunit, sYear];                                                                                                                                                                                                                                 
				this._fetchIntentionStatus(aParam);                                                                                                                                                                                                                        
			} else {                                                                                                                                                                                                                                                    
				oDP.setValueState("Error");                                                                                                                                                                                                                                
			}                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
			// Check if Tax Rate Maintained for selected intention.                                                                                                                                                                                                     
			this._fetchValidTaxRates();                                                                                                                                                                                                                                 
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		onConsUnitChange: function (oEvent) {                                                                                                                                                                                                                        
			this._fetchCurrencyData(false);                                                                                                                                                                                                                             
			this.fetchReconLedgerData();                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                               
			// Check if Tax Rate Maintained for selected intention.                                                                                                                                                                                                     
			this._fetchValidTaxRates();                                                                                                                                                                                                                                 
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		onChangeIntentionComboBox: function (oEvent) {                                                                                                                                                                                                               
			let oView = this.getView(),                                                                                                                                                                                                                                 
				oIntentionCtrl = oView.byId("idIntentionComboBox"),                                                                                                                                                                                                        
				oSelectedItem = oIntentionCtrl.getSelectedItem();                                                                                                                                                                                                          
                                                                                                                                                                                                                                                               
			// Validation for Invalid data	                                                                                                                                                                                                                             
			if (!oSelectedItem) {                                                                                                                                                                                                                                       
				oIntentionCtrl.setSelectedItem("");                                                                                                                                                                                                                        
				return;                                                                                                                                                                                                                                                    
			}                                                                                                                                                                                                                                                           
			this._managePeriodFieldsEditability(true);                                                                                                                                                                                                                  
                                                                                                                                                                                                                                                               
			// Check if Tax Rate Maintained for selected intention.                                                                                                                                                                                                     
			this._fetchValidTaxRates();                                                                                                                                                                                                                                 
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		onLiveChangePeriodTo: function () {                                                                                                                                                                                                                          
			let oPeriodTo = this.getView().byId("idPeriodToInput");                                                                                                                                                                                                     
			let p_fromyb = parseInt(this.getView().byId("idPeriodFromInput").getValue(), [10]);                                                                                                                                                                         
			let p_toyb = parseInt(oPeriodTo.getValue(), [10]);                                                                                                                                                                                                          
                                                                                                                                                                                                                                                               
			oPeriodTo.setValueState("None");                                                                                                                                                                                                                            
			//	If PeriodTo < PeriodFrom, then do not execute further service call&nbsp;                                                                                                                                                                                 
			if (p_toyb < p_fromyb) {                                                                                                                                                                                                                                    
				oPeriodTo.setValueState("Error");                                                                                                                                                                                                                          
				oPeriodTo.setValueStateText(this.getI18nText("periodToLessThanPeriodFromErrorMsg"));                                                                                                                                                                       
				return;                                                                                                                                                                                                                                                    
			} else if (p_toyb > '012') {                                                                                                                                                                                                                                
				oPeriodTo.setValueState("Error");                                                                                                                                                                                                                          
				oPeriodTo.setValueStateText(this.getI18nText("periodToGreaterThanLastPeriod"));                                                                                                                                                                            
				return;                                                                                                                                                                                                                                                    
			} else {                                                                                                                                                                                                                                                    
				this._managePerodicIntentionStatus(p_toyb);                                                                                                                                                                                                                
			}                                                                                                                                                                                                                                                           
		},                                                                                                                                                                                                                                                           
		onChangeButtonReportingType: function (oEvent) {                                                                                                                                                                                                             
			// Sync selected keys for Segmented Buttons (for content & snapped content)                                                                                                                                                                                 
			let oReportTypeContent = this.getView().byId("idFragContent--idETRReconSegmentedBtn"),                                                                                                                                                                      
				oReportTypeSnapContent = this.getView().byId("idFragSnapContent--idETRReconSegmentedBtn");                                                                                                                                                                 
                                                                                                                                                                                                                                                               
			oReportTypeContent.setSelectedKey(oEvent.getSource().getSelectedKey());                                                                                                                                                                                     
			oReportTypeSnapContent.setSelectedKey(oEvent.getSource().getSelectedKey());                                                                                                                                                                                 
                                                                                                                                                                                                                                                               
			// Trigger Filterbar search.                                                                                                                                                                                                                                
			let oFilterBar = this.getView().byId("idETRSmartFilterBar");                                                                                                                                                                                                
			if (oFilterBar.validateMandatoryFields()) {                                                                                                                                                                                                                 
				oFilterBar.fireSearch();                                                                                                                                                                                                                                   
			}                                                                                                                                                                                                                                                           
		}                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                               
	});                                                                                                                                                                                                                                                           
});                                                                                                                                                                                                                                                            