sap.ui.define(["./BaseController","sap/ui/core/mvc/Controller","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/m/MessageBox","sap/m/MessageToast","../model/formatter"],function(e,t,n,o,r,i,a){"use strict";return e.extend("ey.sap.fin.cs.deferredt+
axrollfwd.controller.JournalEntries",{formatter:a,onInit:function(){this._oSmartTable=this.getView().byId("idJournalEntriesTable");this.oRouter=this.getOwnerComponent().getRouter();this.oRouter.getRoute("JournalEntries").attachMatched(this._onRouteMatche+
d,this)},_onRouteMatched:function(){let e=this.getModel("JournalEntryData");this.bIsMessageBoxOpen=false;this.bTableRefresh=false;if(e&&e.getData()){this._oSmartTable.rebindTable()}else{let e=this.getRouter();this.getBusyDialog().open();e.navTo("mainrepo+
rt",{},true)}},_onAdjustJECol:function(){var e=this.getView().byId("idJournalEntriesTable").getTable();var t=e.getColumns();for(var n=t.length-1;n>=0;n--){e.autoResizeColumn(n)}this.getBusyDialog().close()},_findTableSumRow:function(){let e=this.getView(+
).byId("idJournalEntriesTable");let t=e.getTable();let n=t.getRows();let o=t.getVisibleRowCount();if(!n[o-1].getBindingContext()){for(let e=0;e<n.length+1;e++){if(!n[e].getBindingContext()){return e-1}}}return o-1},_findTableSumRowData:function(e){let t=+
this.getView().byId("idJournalEntriesTable").getTable();let n;if(t.getRows()[e]&&t.getRows()[e].getBindingContext()){let o=t.getRows()[e].getBindingContext().sPath;n=t.getModel().getProperty(o)}return n},_compareSyncedValues:function(e,t){let n=this.getM+
odel("JournalEntryData").getData();let o=this.getView().byId("idJEValueHeader");if(e&&e.LocalCurrency!==n.selectedCurrency&&!e.AmountInLocalCurrency||e&&e.GroupCurrency!==n.selectedCurrency&&!e.AmountInGroupCurrency){i.show(this.getResourceBundle().getTe+
xt("errorCurrencyColumnNotSelected"));return}if(e&&n.selectedCurrency===e.LocalCurrency&&parseInt(n.Value,[10])!==parseInt(e.AmountInLocalCurrency,[10])||e&&n.selectedCurrency===e.GroupCurrency&&parseInt(n.Value,[10])!==parseInt(e.AmountInGroupCurrency,[+
10])){o.setState("Warning");if(!this.bIsMessageBoxOpen){this._initializeWarningMessageBox(t)}}else{o.setState("Success")}},_initializeWarningMessageBox:function(e){this.bIsMessageBoxOpen=true;let t=this;r.warning(this.getResourceBundle().getText("errorMs+
gSumValueDiffTableSync"),{actions:[r.Action.OK],onClose:function(e){t.bIsMessageBoxOpen=false}})},onBeforeRebindJournalEntries:function(e){let t=this.getView().getModel("JournalEntryData"),r=e.getParameter("bindingParams").filters,i;let a=o.EQ;if(t.getPr+
operty("/bIsOpeningBalanceEntry")){a=o.LT}let s=[new n("ConsolidationGroup",o.EQ,t.getProperty("/ConsolidationGroup")),new n("GLAccount",o.EQ,t.getProperty("/GLAccount")),new n("PeriodMode",o.EQ,t.getProperty("/PeriodMode")),new n("ConsolidationVersion",+
o.EQ,t.getProperty("/ConsolidationVersion")),new n("FiscalPeriod",o.BT,t.getProperty("/PeriodFrom"),t.getProperty("/PeriodTo")),new n("FiscalYear",a,t.getProperty("/FiscalYear")),new n("RefConsolidationDocumentType",o.EQ,t.getProperty("/RefConsolidationD+
ocumentType"))];if(t.getProperty("/SelectedIntention")){s.push(new n("TaxIntention",o.LE,t.getProperty("/SelectedIntention")))}else{s.push(new n("TaxIntention",o.EQ,""))}if(r.length>0){s=[...s,...r]}let l=new n({filters:s,and:true});let u=t.getProperty("+
/ConsolidationLedger"),g=[];for(let e=0;e<u.length;e++){g.push(new n("ConsolidationLedger",o.EQ,u[e]))}let c=new n({filters:g});let d=t.getProperty("/FinancialTransactionType"),p=[];for(let e=0;e<d.length;e++){p.push(new n("FinancialTransactionType",o.EQ+
,d[e]))}let h=new n({filters:p});i=new n({filters:[l,c,h],and:true});var f=encodeURIComponent("datetime'2018-12-31T00:00:00'");var y="/xEY1xSAV_C_CnsldtnJrnlEntry(P_ConsolidationUnitHierarchy='$',P_ConsolidationPrftCtrHier='$',P_ConsolidationSegmentHier=+
'$',P_KeyDate="+f+")/Results";this.getView().byId("idJournalEntriesTable").setTableBindingPath(y);var C=e.getParameter("bindingParams");C.filters=[i]},onPressConsDoc:function(e){let t=e.getSource().getBindingContext(),n=t.getProperty("RefConsolidationDoc+
umentNumber"),o=t.getProperty("CompanyCode"),r=o;while(r.length<4){r="0"+r}var i=t.getProperty("PostingDate").getFullYear();var a={AccountingDocument:n,CompanyCode:r,FiscalYear:i};this.performCrossAppNavigation("AccountingDocument","manage",true,a)},onJE+
ntriesDataReceived:function(e){this.getBusyDialog().open();var t=window.setInterval(function(e){this._onAdjustJECol();this._compareSyncedValues(this._findTableSumRowData(this._findTableSumRow()),this.bTableRefresh);window.clearInterval(t)}.bind(this),1e3+
)},onPressJEDataSync:function(e){this.bTableRefresh=true;this._oSmartTable.rebindTable()}})});                                                                                                                                                                 