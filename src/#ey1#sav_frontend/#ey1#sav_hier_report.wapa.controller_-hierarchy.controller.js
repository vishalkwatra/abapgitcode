sap.ui.define(["./BaseController","sap/ui/model/json/JSONModel","../model/formatter","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/m/MessageToast","sap/m/MessageBox","sap/ui/core/ListItem","sap/ui/generic/app/navigation/service/NavigationHandl+
er"],function(e,t,a,n,r,o,i,l,s){"use strict";let T=[];return e.extend("ey.sap.fin.cs.hierarchyReport.controller.hierarchy",{onInit:function(){this.oRouter=this.getOwnerComponent().getRouter();this.oRouter.getRoute("Routehierarchy").attachMatched(this._o+
nRouteMatched,this);let e=new t;this.setModel(e,"viewConfigDataModel");let a=[{name:this.getI18nText("FSItemText"),key:"CS15"},{name:this.getI18nText("GLAccVHText"),key:"0109"}];var n=new t;this.setModel(n,"HierDatModel");let r=new t(a);this.setModel(r,"+
hierVHModel");let o={cols:[{label:this.getI18nText("labelHierId"),template:"HierarchyId",width:"6%",resizable:"false"},{label:this.getI18nText("labelHierIdDes"),template:"HierarchyText",width:"13%",resizable:"false"}]},i=new t(o);this.setModel(i,"VHColum+
nModel");this._fetchGlobalParameters();this._fetchAdjustmentReasons();this.getView().byId("idHierType").setSelectedKey("CS15");this._fetchValueHelpHierarchyTxt(this.getView().byId("idHierType").getSelectedKey())},onAfterRendering:function(){let e=sap.ush+
ell.services.AppConfiguration,t=this.getI18nText("textMenuItemCTAForPnL"),a=this;if(!this._oAppSettingDialogCTA){this._oAppSettingDialogCTA=sap.ui.xmlfragment("ey.sap.fin.cs.hierarchyReport.fragment.AppSettingCTA",this);this.getView().addDependent(this._+
oAppSettingDialogCTA)}let n=new sap.m.Button({text:t,press:function(e){if(!a._oAppSettingDialogCTA){a._oAppSettingDialogCTA=sap.ui.xmlfragment("ey.sap.fin.cs.recgaapstattax.fragment.AppSettingCTA",a);a.getView().addDependent(a._oAppSettingDialogCTA)}a._o+
AppSettingDialogCTA.open()}});e.addApplicationSettingsButtons([n])},_onRouteMatched:function(){this.getBusyDialog().close()},_fetchValueHelpHierarchyTxt:function(e){let a=this.getOwnerComponent().getModel("oManageHierModel"),o=this,l=new n({filters:[new +
n("HierarchyCategory",r.EQ,e),new n("VersionStatus",r.EQ,"A")],and:true}),s=l;a.read("/HierarchyVersionSet",{method:"GET",filters:[s],success:function(e){let a=new t(e.results);o.setModel(a,"hierarCatModel")},error:function(e){i.error(o.getI18nText("erro+
rFetchingHierCatTxtData"))}})},_fetchAdjustmentReasons:function(){let e=this.getOwnerComponent().getModel();let t="/xEY1xSAV_C_Recon_Adj_Reason";let a=this;e.read(t,{method:"GET",success:function(e,t){var n=a.getModel("viewConfigDataModel");n.getData().a+
djustmentReason=e.results;n.refresh()},error:function(e){if(parseInt(e.statusCode,[10])!==404){o.show(a.getI18nText("adjustmentReasonsServiceCallError"))}}})},_filterVHTable:function(e){let t=this;this._oHierIdVHDialog.getTableAsync().then(function(a){if+
(e.aFilters.length===0){a.getBinding("rows").filter(e);a.getModel().refresh(true)}else{a.getBinding("rows").filter(e)}t._oHierIdVHDialog.update()})},_fetchReconData:function(){let e=this.getOwnerComponent().getModel(),a=this,o=this.getView(),l=o.getModel+
("viewConfigDataModel").getData();if(!l.globalParameters||!l.globalParameters.ConsolidationChartofAccounts||!l.globalParameters.ConsolidationGroup){i.error(this.getI18nText("errorMaintainGlobalParameter"));return}let s=o.byId("idConsUnit"),T=s.getSelecte+
dKey(),c=o.byId("idCurrency"),d=c.getSelectedKey(),g=o.byId("idFiscalYearFilter"),u=g.getDateValue().getFullYear(),S=o.byId("idPeriodFromInput"),h=o.byId("idPeriodToInput"),p=parseInt(S.getValue(),[10]),C=parseInt(h.getValue(),[10]),f=this._oAppSettingDi+
alogCTA.getContent().find(e=>e.getId()==="idAppSettingsCTAIsCTAIncludedCheckBox"),x=f.getSelected()?"X":"",I=o.byId("idIntentionComboBox").getSelectedItem().getBindingContext("intentionVHModel"),P=parseInt(I.getObject().TaxIntention,[10]),y=P>100?P:"",m,+
A,B;m=new n({filters:[new n("ConsolidationUnit",r.EQ,T),new n("ChartOfAccounts",r.EQ,"CANA"),new n("ConsolidationChartofAccounts",r.EQ,l.globalParameters.ConsolidationChartofAccounts),new n("MainCurrency",r.EQ,d)],and:true});B=m;p=p?p<0?0:p>12?12:p:1;C=C+
?C<0?0:C>12?12:C:12;let G="/xEY1xSAV_C_Reconciliation(p_ryear='"+u+"',p_fromyb='"+p+"',p_toyb='"+C+"',p_switch='"+x+"',p_taxintention='"+y+"')/Results";e.read(G,{filters:[B],method:"GET",success:function(e){let n=new t(e.results);a.setModel(n,"oReconMode+
l")},error:function(e){i.error(a.getI18nText("errorFetchingRecon"))}})},_fetchTreeData:function(){let e=this.getOwnerComponent().getModel("oManageHierModel"),t=this,a=this.getView(),o=a.byId("idHierCatTextInpt").getSelectedKey(),l=a.byId("idHierType").ge+
tSelectedKey(),s=new n({filters:[new n("HierarchyCategory",r.EQ,l),new n("HierarchyId",r.EQ,o)],and:true});e.read("/HierarchyVersionSet",{filters:[s],method:"GET",success:function(e){t._fetchInitialHierarchy(e.results[0].VersionId)},error:function(e){i.e+
rror(t.getI18nText("errorFetchingHierData"))}})},_fetchInitialHierarchy:function(e){let t=this.getOwnerComponent().getModel("oManageHierModel"),a=new n("NodeLevel",r.LE,1),o=this;t.read("/HierarchyVersionSet('"+e+"')/Nodes",{filters:[a],method:"GET",succ+
ess:async function(a){for(let n=0;n<a.results.length;n++){a.results[n].Covered="";a.results[n].GaapOpeningBalance=0;a.results[n].GaapYearBalance=0;a.results[n].GaapCTA=0;a.results[n].GaapClosingBalance=0;a.results[n].GaapToStatPL=0;a.results[n].GaapToSta+
tPmnt=0;a.results[n].GaapToStatEQ=0;a.results[n].GaapToStatOtherPL=0;a.results[n].GaapToStatOtherPmnt=0;a.results[n].GaapToStatOtherEQ=0;a.results[n].G2SCTA=0;a.results[n].StatOpeningBalance=0;a.results[n].StatPYA=0;a.results[n].StatYearBalance=0;a.resul+
ts[n].StatCTA=0;a.results[n].StatClosingBalance=0;a.results[n].StatToTaxPL=0;a.results[n].StatToTaxPmnt=0;a.results[n].StatToTaxEQ=0;a.results[n].StatToTaxOtherPL=0;a.results[n].StatToTaxOtherPmnt=0;a.results[n].StatToTaxOtherEQ=0;a.results[n].S2TCTA=0;a+
.results[n].TaxOpeningBalance=0;a.results[n].TaxPYA=0;a.results[n].TaxYearBalance=0;a.results[n].TaxCTA=0;a.results[n].TaxClosingBalance=0;a.results[n].TaxPTA=0;a.results[n].MainCurrency="";T.push(a.results[n]);if(a.results[n].NodeParentId){await o.__rec+
CallHierarchy(a.results[n].NodeId,t,o,e)}}o._calculateAmount(T);o.getView().byId("idTreeHierFSItem").setBusy(false)},error:function(e){i.error(o.getI18nText("errorFetchingHierData"))}})},__recCallHierarchy:function(e,t,a,o){return new Promise(function(l,+
s){let c=new n("NodeParentId",r.EQ,e),d=a,g=o;t.read("/HierarchyVersionSet('"+g+"')/Nodes",{filters:[c],method:"GET",success:async function(e){e.results.sort(function(e,t){var a=e.DrillState.toUpperCase();var n=t.DrillState.toUpperCase();return a<n?-1:a>+
n?1:0});if(e.results.length===0){l(e)}for(let a=0;a<e.results.length;a++){e.results[a].Covered="";e.results[a].GaapOpeningBalance=0;e.results[a].GaapYearBalance=0;e.results[a].GaapCTA=0;e.results[a].GaapClosingBalance=0;e.results[a].GaapToStatPL=0;e.resu+
lts[a].GaapToStatPmnt=0;e.results[a].GaapToStatEQ=0;e.results[a].GaapToStatOtherPL=0;e.results[a].GaapToStatOtherPmnt=0;e.results[a].GaapToStatOtherEQ=0;e.results[a].G2SCTA=0;e.results[a].StatOpeningBalance=0;e.results[a].StatPYA=0;e.results[a].StatYearB+
alance=0;e.results[a].StatCTA=0;e.results[a].StatClosingBalance=0;e.results[a].StatToTaxPL=0;e.results[a].StatToTaxPmnt=0;e.results[a].StatToTaxEQ=0;e.results[a].StatToTaxOtherPL=0;e.results[a].StatToTaxOtherPmnt=0;e.results[a].StatToTaxOtherEQ=0;e.resul+
ts[a].S2TCTA=0;e.results[a].TaxOpeningBalance=0;e.results[a].TaxPYA=0;e.results[a].TaxYearBalance=0;e.results[a].TaxCTA=0;e.results[a].TaxClosingBalance=0;e.results[a].TaxPTA=0;e.results[a].MainCurrency="";T.push(e.results[a]);if(e.results[a].DrillState!+
=="leaf"){await d.__recCallHierarchy(e.results[a].NodeId,t,d,g);if(e.results.length===a+1){l(e)}}else{l(e)}}},error:function(e){i.error(d.getI18nText("errorFetchingHierData"));s(e)}})})},_calculateAmount:function(e){let t=this,a=this.getView().byId("idTr+
eeHierFSItem"),n=e.filter(e=>e.NodeEntity==="FINCS_FSITEM"),r=this.getView().getModel("oReconModel").getData();if(n.length===0){for(var o=0;o<e.length;o++){e[o].Covered="X"}i.warning(t.getI18nText("warningFetchingFSItem"))}for(let e=0;e<n.length;e++){for+
(let t=0;t<r.length;t++){if(n[e].NodeLowValue===r[t].FinancialStatementItem){n[e].GaapOpeningBalance=n[e].GaapOpeningBalance+parseFloat(r[t].GaapOpeningBalance,[10]);n[e].GaapYearBalance=n[e].GaapYearBalance+parseFloat(r[t].GaapYearBalance,[10]);n[e].Gaa+
pCTA=n[e].GaapClosingBalance+parseFloat(r[t].GaapCTA,[10]);n[e].GaapClosingBalance=n[e].GaapClosingBalance+parseFloat(r[t].GaapClosingBalance,[10]);n[e].GaapToStatPL=n[e].GaapToStatPL+parseFloat(r[t].GaapToStatPL,[10]);n[e].GaapToStatPmnt=n[e].GaapToStat+
Pmnt+parseFloat(r[t].GaapToStatPmnt,[10]);n[e].GaapToStatEQ=n[e].GaapToStatEQ+parseFloat(r[t].GaapToStatEQ,[10]);n[e].GaapToStatOtherPL=n[e].GaapToStatOtherPL+parseFloat(r[t].GaapToStatOtherPL,[10]);n[e].GaapToStatOtherPmnt=n[e].GaapToStatOtherPmnt+parse+
Float(r[t].GaapToStatOtherPmnt,[10]);n[e].GaapToStatOtherEQ=n[e].GaapToStatOtherEQ+parseFloat(r[t].GaapToStatOtherEQ,[10]);n[e].G2SCTA=n[e].G2SCTA+parseFloat(r[t].G2SCTA,[10]);n[e].StatOpeningBalance=n[e].StatOpeningBalance+parseFloat(r[t].StatOpeningBal+
ance,[10]);n[e].StatPYA=n[e].StatPYA+parseFloat(r[t].StatPYA,[10]);n[e].StatYearBalance=n[e].StatYearBalance+parseFloat(r[t].StatYearBalance,[10]);n[e].StatCTA=n[e].StatCTA+parseFloat(r[t].StatCTA,[10]);n[e].StatClosingBalance=n[e].StatClosingBalance+par+
seFloat(r[t].StatClosingBalance,[10]);n[e].StatToTaxPL=n[e].StatToTaxPL+parseFloat(r[t].StatToTaxPL,[10]);n[e].StatToTaxPmnt=n[e].StatToTaxPmnt+parseFloat(r[t].StatToTaxPmnt,[10]);n[e].StatToTaxEQ=n[e].StatToTaxEQ+parseFloat(r[t].StatToTaxEQ,[10]);n[e].S+
tatToTaxOtherPL=n[e].StatToTaxOtherPL+parseFloat(r[t].StatToTaxOtherPL,[10]);n[e].StatToTaxOtherPmnt=n[e].StatToTaxOtherPmnt+parseFloat(r[t].StatToTaxOtherPmnt,[10]);n[e].StatToTaxOtherEQ=n[e].StatToTaxOtherEQ+parseFloat(r[t].StatToTaxOtherEQ,[10]);n[e].+
S2TCTA=n[e].S2TCTA+parseFloat(r[t].S2TCTA,[10]);n[e].TaxOpeningBalance=n[e].TaxOpeningBalance+parseFloat(r[t].TaxOpeningBalance,[10]);n[e].TaxPYA=n[e].TaxPYA+parseFloat(r[t].TaxPYA,[10]);n[e].TaxYearBalance=n[e].TaxYearBalance+parseFloat(r[t].TaxYearBala+
nce,[10]);n[e].TaxCTA=n[e].TaxCTA+parseFloat(r[t].TaxCTA,[10]);n[e].TaxClosingBalance=n[e].TaxClosingBalance+parseFloat(r[t].TaxClosingBalance,[10]);n[e].TaxPTA=n[e].TaxPTA+parseFloat(r[t].TaxPTA,[10]);n[e].MainCurrency=r[t].MainCurrency}}}for(let t=0;t<+
n.length;t++){for(let a=0;a<e.length;a++){if(n[t].NodeParentId===e[a].NodeId){n[t].Covered="X";e[a].GaapOpeningBalance=n[t].GaapOpeningBalance+e[a].GaapOpeningBalance;e[a].GaapYearBalance=n[t].GaapYearBalance+e[a].GaapYearBalance;e[a].GaapCTA=n[t].GaapCT+
A+e[a].GaapCTA;e[a].GaapClosingBalance=n[t].GaapClosingBalance+e[a].GaapClosingBalance;e[a].GaapToStatPL=n[t].GaapToStatPL+e[a].GaapToStatPL;e[a].GaapToStatPmnt=n[t].GaapToStatPmnt+e[a].GaapToStatPmnt;e[a].GaapToStatEQ=n[t].GaapToStatEQ+e[a].GaapToStatEQ+
;e[a].GaapToStatOtherPL=n[t].GaapToStatOtherPL+e[a].GaapToStatOtherPL;e[a].GaapToStatOtherPmnt=n[t].GaapToStatOtherPmnt+e[a].GaapToStatOtherPmnt;e[a].GaapToStatOtherEQ=n[t].GaapToStatOtherEQ+e[a].GaapToStatOtherEQ;e[a].G2SCTA=n[t].G2SCTA+e[a].G2SCTA;e[a]+
.StatOpeningBalance=n[t].StatOpeningBalance+e[a].StatOpeningBalance;e[a].StatPYA=n[t].StatPYA+e[a].StatPYA;e[a].StatYearBalance=n[t].StatYearBalance+e[a].StatYearBalance;e[a].StatCTA=n[t].StatCTA+e[a].StatCTA;e[a].StatClosingBalance=n[t].StatClosingBalan+
ce+e[a].StatClosingBalance;e[a].StatToTaxPL=n[t].StatToTaxPL+e[a].StatToTaxPL;e[a].StatToTaxPmnt=n[t].StatToTaxPmnt+e[a].StatToTaxPmnt;e[a].StatToTaxEQ=n[t].StatToTaxEQ+e[a].StatToTaxEQ;e[a].StatToTaxOtherPL=n[t].StatToTaxOtherPL+e[a].StatToTaxOtherPL;e[+
a].StatToTaxOtherPmnt=n[t].StatToTaxOtherPmnt+e[a].StatToTaxOtherPmnt;e[a].StatToTaxOtherEQ=n[t].StatToTaxOtherEQ+e[a].StatToTaxOtherEQ;e[a].S2TCTA=n[t].S2TCTA+e[a].S2TCTA;e[a].TaxOpeningBalance=n[t].TaxOpeningBalance+e[a].TaxOpeningBalance;e[a].TaxPYA=n+
[t].TaxPYA+e[a].TaxPYA;e[a].TaxYearBalance=n[t].TaxYearBalance+e[a].TaxYearBalance;e[a].TaxCTA=n[t].TaxCTA+e[a].TaxCTA;e[a].TaxClosingBalance=n[t].TaxClosingBalance+e[a].TaxClosingBalance;e[a].TaxPTA=n[t].TaxPTA+e[a].TaxPTA;e[a].MainCurrency=n[t].MainCur+
rency;let r=e.filter(t=>t.NodeParentId===e[a].NodeId&&t.NodeEntity!=="FINCS_FSITEM");if(r.length===0){e[a].Covered="X"}}if(e[a].Covered===""&&e[a].NodeEntity!=="FINCS_FSITEM"){let t=e.filter(t=>t.NodeParentId===e[a].NodeId);if(t.length===0){e[a].Covered=+
"X"}}}}var l=[];var s=[];l=e.filter(e=>e.Covered==="X"&&e.NodeEntity!=="FINCS_FSITEM");s=e.filter(e=>e.Covered===""&&e.NodeEntity!=="FINCS_FSITEM");while(s.length>0){for(let e=0;e<l.length;e++){for(let t=0;t<s.length;t++){if(s[t].NodeId===l[e].NodeParent+
Id){let a=s[t];if(s.filter(e=>e.NodeParentId===a.NodeId).length===0){a.GaapOpeningBalance=a.GaapOpeningBalance+l[e].GaapOpeningBalance;a.GaapYearBalance=a.GaapYearBalance+l[e].GaapYearBalance;a.GaapCTA=a.GaapCTA+l[e].GaapCTA;a.GaapClosingBalance=a.GaapCl+
osingBalance+l[e].GaapClosingBalance;a.GaapToStatPL=a.GaapToStatPL+l[e].GaapToStatPL;a.GaapToStatPmnt=a.GaapToStatPmnt+l[e].GaapToStatPmnt;a.GaapToStatEQ=a.GaapToStatEQ+l[e].GaapToStatEQ;a.GaapToStatOtherPL=a.GaapToStatOtherPL+l[e].GaapToStatOtherPL;a.Ga+
apToStatOtherPmnt=a.GaapToStatOtherPmnt+l[e].GaapToStatOtherPmnt;a.GaapToStatOtherEQ=a.GaapToStatOtherEQ+l[e].GaapToStatOtherEQ;a.G2SCTA=l[e].G2SCTA+a.G2SCTA;a.StatOpeningBalance=l[e].StatOpeningBalance+a.StatOpeningBalance;a.StatPYA=l[e].StatPYA+a.StatP+
YA;a.StatYearBalance=l[e].StatYearBalance+a.StatYearBalance;a.StatCTA=l[e].StatCTA+a.StatCTA;a.StatClosingBalance=l[e].StatClosingBalance+a.StatClosingBalance;a.StatToTaxPL=l[e].StatToTaxPL+a.StatToTaxPL;a.StatToTaxPmnt=l[e].StatToTaxPmnt+a.StatToTaxPmnt+
;a.StatToTaxEQ=l[e].StatToTaxEQ+a.StatToTaxEQ;a.StatToTaxOtherPL=l[e].StatToTaxOtherPL+a.StatToTaxOtherPL;a.StatToTaxOtherPmnt=l[e].StatToTaxOtherPmnt+a.StatToTaxOtherPmnt;a.StatToTaxOtherEQ=l[e].StatToTaxOtherEQ+a.StatToTaxOtherEQ;a.S2TCTA=l[e].S2TCTA+a+
.S2TCTA;a.TaxOpeningBalance=l[e].TaxOpeningBalance+a.TaxOpeningBalance;a.TaxPYA=l[e].TaxPYA+a.TaxPYA;a.TaxYearBalance=l[e].TaxYearBalance+a.TaxYearBalance;a.TaxCTA=l[e].TaxCTA+a.TaxCTA;a.TaxClosingBalance=l[e].TaxClosingBalance+a.TaxClosingBalance;a.TaxP+
TA=l[e].TaxPTA+a.TaxPTA;a.Covered="X";a.MainCurrency=l[e].MainCurrency}}}}s=e.filter(e=>e.Covered===""&&e.NodeEntity!=="FINCS_FSITEM");l=e.filter(e=>e.Covered==="X"&&e.NodeEntity!=="FINCS_FSITEM")}for(var o=0;o<e.length;o++){e[o].childs=[]}let T=this._bu+
ildTree(e);var c={childs:T};this.getView().getModel("HierDatModel").setData([]);this.getView().getModel("HierDatModel").setData(c);this.getBusyDialog().open();var d=window.setInterval(function(){this.onAdjustTableCol();window.clearInterval(d)}.bind(this)+
,1e3)},_buildTree:function(e,t){if(t){for(var a=0;a<e.length;a++){if(String(e[a].NodeId)===String(t.NodeParentId)){e[a].childs.push(t);break}else this._buildTree(e[a].childs,t)}}else{var n=0;while(n<e.length)if(e[n].NodeParentId)this._buildTree(e,e.splic+
e(n,1)[0]);else n++}return e},_fetchGlobalParameters:function(){var e=this;var t=this.getOwnerComponent().getModel();t.callFunction("/GlobalParameter",{method:"GET",success:function(t){e.getView().getModel("viewConfigDataModel").setData({globalParameters+
:t});let a=e.getView().byId("idsmartFilterBar");if(!a.getCurrentVariantId()){e._setFilterBarParameters(t)}},error:function(t){i.error(e.getI18nText("errorReadingGlobalParameters"))}})},_setFilterBarParameters:function(e){let t=this.getView(),n=t.byId("id+
Currency");if(e.LocalCurrencyType&&e.LocalCurrency){n.setSelectedKey(e.LocalCurrency)}else{n.setSelectedKey(e.GroupCurrency)}if(e.ConsolidationUnit){t.byId("idConsUnit").setSelectedKey(e.ConsolidationUnit);n.setVisible(true);this._fetchCurrencyData(true)+
;this.fetchReconLedgerData()}if(e.FiscalYear){let a=new Date("06/06/".concat(e.FiscalYear.toString()));t.byId("idFiscalYearFilter").setDateValue(a)}if(e.Intention){t.byId("idIntentionComboBox").setSelectedKey(e.Intention)}this._fetchIntentionData();if(e.+
PeriodFrom){t.byId("idPeriodFromInput").setValue(a.convertStringToInt(e.PeriodFrom))}if(e.PeriodTo){t.byId("idPeriodToInput").setValue(a.convertStringToInt(e.PeriodTo))}},getI18nText:function(e){return this.getResourceBundle().getText(e)},_fetchCurrencyD+
ata:function(e){var a=this.getView(),i=a.byId("idConsUnit").getSelectedKey(),l=new n("ConsolidationUnit",r.EQ,i),s=this.getModel(),T=this,c=a.byId("idCurrType"),d=a.byId("idCurrency");c.setVisible(true);d.setBusy(true);s.read("/xEY1xSAV_C_CurrLocalGroupV+
H",{method:"GET",filters:[l],success:function(a,n){d.setBusy(false);T.setModel(new t(a),"currLocalGroupVHModel");if(!e&&a.results.length>0){d.setSelectedKey(a.results[0].Currency)}},error:function(e){d.setBusy(false);o.show(T.getI18nText("errorFetchingCu+
rrency"))}})},_fetchIntentionData:function(){let e=this.getModel(),a="/xEY1xSAV_C_ReadIntentVH",n=this;this.getBusyDialog().open();e.read(a,{method:"GET",sorters:[new sap.ui.model.Sorter("SerialNumber")],success:function(e,a){n.getBusyDialog().close();le+
t r=new t(e);n.getView().setModel(r,"intentionVHModel");n._managePeriodFieldsEditability(false)},error:function(e){n.getBusyDialog().close();o.show(n.getI18nText("errorFetchingIntentions"))}})},_managePeriodFieldsEditability:function(e){let t=this.getVie+
w(),n=t.byId("idIntentionComboBox");if(!e){n.setSelectedKey(n.getSelectedKey())}let r=n.getSelectedItem(),o=r.getBindingContext("intentionVHModel").getObject(),i=t.byId("idPeriodToInput"),l=a.convertStringToInt(o.TaxIntention);if(l!==a.convertStringToInt+
(0)){i.setEditable(false);i.setValue(a.convertStringToInt(o.PeriodTo))}else{i.setEditable(true)}},fetchReconLedgerData:function(){let e=this.getModel();let t=e.createKey("/xEY1xSAV_C_Recon_Ledger",{bunit:this.byId("idConsUnit").getSelectedKey()});let a=t+
his;e.read(t,{method:"GET",success:function(e,t){var n=a.getModel("viewConfigDataModel");n.getData().reconData=e;n.refresh()},error:function(e){if(parseInt(e.statusCode,[10])!==404){o.show(a.getI18nText("reconServiceCallError"))}}})},onSearchButtonPresse+
d:function(e){let t=this.getView();T=[];if(t.byId("idHierCatTextInpt").getSelectedKey()){if(t.byId("idHierType").getSelectedKey()==="CS15"){t.byId("idTreeHierFSItem").setBusy(true);this._fetchReconData();this._fetchTreeData()}}else{t.byId("idHierCatTextI+
npt").setValueState("Error")}},onChangeHierId:function(e){let t=e.getSource().getSelectedKey(),a=this.getView().getModel("hierarCatModel").getData(),n=a.some(e=>e.HierarchyId===t);if(n){e.getSource().setValueState("None")}else{e.getSource().setValueState+
("Error")}},onBeforeVariantSaveFilterBar:function(e){let t=this.getView(),a=t.byId("idsmartFilterBar"),n=t.byId("idConsUnit"),r=t.byId("idFiscalYearFilter"),o=t.byId("idIntentionComboBox"),i=t.byId("idCurrency"),l=t.byId("idPeriodToInput");a.setFilterDat+
a({_CUSTOM:{ConsolidationUnit:n.getSelectedKey(),FiscalYear:r.getValue(),Intention:o.getSelectedKey(),CurrType:i.getSelectedKey(),PeriodTo:l.getValue(),VariantID:a.getCurrentVariantId()}})},onAfterVariantLoadFilterBar:function(e){var t=this.getView();var+
 n=t.byId("idsmartFilterBar");var r=t.byId("idConsUnit");var o=t.byId("idFiscalYearFilter");let i=t.byId("idIntentionComboBox");var l=t.byId("idCurrency");let s=this.getView().byId("idPeriodToInput");var T=n.getFilterData()["_CUSTOM"];r.setSelectedKey(T.+
ConsolidationUnit);o.setValue(T.FiscalYear);i.setSelectedKey(T.Intention);l.setSelectedKey(T.CurrType);s.setValue(a.convertStringToInt(T.PeriodTo));if(T.ConsolidationUnit){this.fetchReconLedgerData()}if(T.CurrType){l.setVisible(true);this._fetchCurrencyD+
ata(true)}this._fetchIntentionData()},onChangeDatePickerFilter:function(e){let t=e.getSource();if(e.getParameter("valid")){t.setValueState("None")}else{t.setValueState("Error")}},onConsUnitChange:function(e){this._fetchCurrencyData(false);this.fetchRecon+
LedgerData()},onChangeIntentionComboBox:function(e){let t=this.getView(),a=t.byId("idIntentionComboBox"),n=a.getSelectedItem();if(!n){a.setSelectedItem("");return}this._managePeriodFieldsEditability(true)},onChangeHierTypeCB:function(e){let t=e.getSource+
().getSelectedKey();this._fetchValueHelpHierarchyTxt(t)},onLiveChangePeriodTo:function(){let e=this.getView().byId("idPeriodToInput");let t=parseInt(this.getView().byId("idPeriodFromInput").getValue(),[10]);let a=parseInt(e.getValue(),[10]);e.setValueSta+
te("None");if(a<t){e.setValueState("Error");e.setValueStateText(this.getI18nText("periodToLessThanPeriodFromErrorMsg"));return}else if(a>"012"){e.setValueState("Error");e.setValueStateText(this.getI18nText("periodToGreaterThanLastPeriod"));return}},onPre+
ssOkBtnAppSettingsCTA:function(e){let t=this.getView().byId("idsmartFilterBar").validateMandatoryFields();if(t){this._fetchReconData()}this._oAppSettingDialogCTA.close()},onValueHelpRequested:function(e){let t=this.getView(),a=t.getModel("VHColumnModel")+
.getData().cols,n=this,r=this.getView().byId("idHierCatTextInpt");if(!this._oHierIdVHDialog){this._oHierIdVHDialog=sap.ui.xmlfragment("ey.sap.fin.cs.hierarchyReport.fragment.hierarchyIdValueHelp",this);this.getView().addDependent(this._oHierIdVHDialog)}t+
his._oHierIdVHDialog.getTableAsync().then(function(e){e.setModel(t.getModel("hierarCatModel"));e.setModel(t.getModel("VHColumnModel"),"columns");e.bindAggregation("rows","/");e.attachRowSelectionChange(function(e){let t=e.getParameters(),a=t.rowContext.g+
etProperty().HierarchyId;r.setSelectedKey(a);n._oHierIdVHDialog.close()})});this._oHierIdVHDialog.open()},onValueHelpCancelPress:function(){this._oHierIdVHDialog.close()},onValueHelpAfterClose:function(){this._oHierIdVHDialog.destroy();this._oHierIdVHDia+
log=undefined},onFilterBarSearch:function(e){let t=e.getParameter("selectionSet"),a=t.reduce(function(e,t){if(t.getValue()){e.push(new n({path:t.getName(),operator:r.Contains,value1:t.getValue()}))}return e},[]);this._filterVHTable(new n({filters:a,and:t+
rue}))},onUpdateRows:function(){this.getBusyDialog().open();var e=window.setInterval(function(){this.onAdjustTableCol();window.clearInterval(e)}.bind(this),1e3)},onAdjustTableCol:function(){let e=this.getView().byId("idTreeHierFSItem"),t=e.getColumns();f+
or(var a=t.length-1;a>=0;a--){e.autoResizeColumn(a)}e.setFixedColumnCount(1);this.getBusyDialog().close()}})});                                                                                                                                                