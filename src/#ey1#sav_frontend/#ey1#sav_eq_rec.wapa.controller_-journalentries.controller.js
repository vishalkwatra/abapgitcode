sap.ui.define(["./BaseController","sap/ui/core/mvc/Controller","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/m/MessageBox","sap/m/MessageToast","../model/formatter"],function(e,t,n,o,i,r,a){"use strict";return e.extend("ey.sap.fin.cs.equityrec+
onciliation.controller.JournalEntries",{formatter:a,onInit:function(){this._oSmartTable=this.getView().byId("idJournalEntriesTable");this.oRouter=this.getOwnerComponent().getRouter();this.oRouter.getRoute("JournalEntries").attachMatched(this._onRouteMatc+
hed,this)},_onRouteMatched:function(){this.getView().byId("idJETaxIntentionDesc").setVisible(true);let e=this.getModel("JournalEntryData"),t=sap.ui.getCore().getModel("viewCnlVersionModel").getData().ConsolidationVersion.results;let n,o=e.getProperty("/C+
onsolidationLedger"),i=this,r=[];r=t.filter(e=>e.ConsolidationLedger===o);n=[r[0].ConsolidationVersion];i.getOwnerComponent().getModel("JournalEntryData").getData().ConsolidationVersion=n;i.bIsMessageBoxOpen=false;i.bTableRefresh=false;if(e&&e.getData())+
{i._oSmartTable.rebindTable()}else{let e=i.getRouter();i.getBusyDialog().open();e.navTo("mainreport",{},true)}},onBeforeRebindJournalEntries:function(e){let t=this.getView().getModel("JournalEntryData"),i=e.getParameter("bindingParams").filters;let r=o.E+
Q;if(t.getProperty("/bIsOpeningBalanceEntry")){r=o.LT}let a=[new n("ConsolidationGroup",o.EQ,t.getProperty("/ConsolidationGroup")),new n("ConsolidationLedger",o.EQ,t.getProperty("/ConsolidationLedger")),new n("GLAccount",o.EQ,t.getProperty("/GLAccount"))+
,new n("PeriodMode",o.EQ,t.getProperty("/PeriodMode")),new n("ConsolidationVersion",o.EQ,t.getProperty("/ConsolidationVersion")),new n("FiscalPeriod",o.BT,t.getProperty("/PeriodFrom"),t.getProperty("/PeriodTo")),new n("FiscalYear",r,t.getProperty("/Fisca+
lYear")),new n("RefConsolidationDocumentType",o.EQ,t.getProperty("/RefConsolidationDocumentType")),new n("CompanyCode",o.EQ,t.getProperty("/ConsolidatioUnit"))];if(t.getProperty("/SelectedIntention")){a.push(new n("TaxIntention",o.LE,t.getProperty("/Sele+
ctedIntention")))}else{a.push(new n("TaxIntention",o.EQ,""))}if(t.getProperty("/MapLedger")==="s2t"){a.push(new n("LedgerGroup",o.NE,"G2S"))}if(i.length>0){a=[...a,...i]}let s=new n({filters:a,and:true}),l=s,u=[],g=[];if(t.getProperty("/FinancialTransact+
ionType").length>0){for(var d=0;d<t.getProperty("/FinancialTransactionType").length;d++){u.push(new n("FinancialTransactionType",o.EQ,t.getProperty("/FinancialTransactionType")[d]))}g=new n({filters:u})}else{g=new n("FinancialTransactionType",o.EQ,t.getP+
roperty("/FinancialTransactionType"))}l=new n({filters:[s,g],and:true});var c=encodeURIComponent("datetime'2018-12-31T00:00:00'");var p="/xEY1xSAV_C_CnsldtnJrnlEntry(P_ConsolidationUnitHierarchy='$',P_ConsolidationPrftCtrHier='$',P_ConsolidationSegmentHi+
er='$',P_KeyDate="+c+")/Results";this.getView().byId("idJournalEntriesTable").setTableBindingPath(p);var y=e.getParameter("bindingParams");y.filters=[l]},onPressConsDoc:function(e){let t=this.getModel("JournalEntryData").getData();var n=e.getSource().get+
BindingContext().getProperty("RefConsolidationDocumentNumber");var o=e.getSource().getBindingContext().getProperty("CompanyCode");var i=o;while(i.length<4){i="0"+i}var r=t.FiscalYear;var a={AccountingDocument:n,CompanyCode:i,FiscalYear:r};this.performCro+
ssAppNavigation("AccountingDocument","manage",true,a)},onJEntriesDataReceived:function(e){this.getBusyDialog().open();let t=this.getView(),n=t.byId("idJETaxIntentionDesc"),o=t.byId("idJETaxIntention");var i=window.setInterval(function(e){this._onAdjustJE+
Col();this._compareSyncedValues(this._findTableSumRowData(this._findTableSumRow()),this.bTableRefresh);if(o.getGrouped()){n.setVisible(true)}else{n.setVisible(false)}window.clearInterval(i)}.bind(this),1e3)},onPressJEDataSync:function(e){this.bTableRefre+
sh=true;this._oSmartTable.rebindTable()},_onAdjustJECol:function(){var e=this.getView().byId("idJournalEntriesTable").getTable();var t=e.getColumns();for(var n=t.length-1;n>=0;n--){e.autoResizeColumn(n)}this.getBusyDialog().close()},_findTableSumRow:func+
tion(){let e=this.getView().byId("idJournalEntriesTable");let t=e.getTable();let n=t.getRows();let o=t.getVisibleRowCount();if(!n[o-1]||!n[o-1].getBindingContext()){for(let e=0;e<n.length+1;e++){if(!n[e].getBindingContext()){return e-1}}}return o-1},_fin+
dTableSumRowData:function(e){let t=this.getView().byId("idJournalEntriesTable").getTable();let n;if(t.getRows()[e]&&t.getRows()[e].getBindingContext()){let o=t.getRows()[e].getBindingContext().sPath;n=t.getModel().getProperty(o)}return n},_compareSyncedV+
alues:function(e,t){let n=this.getModel("JournalEntryData").getData();let o=this.getView().byId("idJEValueHeader");if(e&&e.LocalCurrency!==-n.selectedCurrency&&!e.AmountInLocalCurrency||e&&e.GroupCurrency!==-n.selectedCurrency&&!e.AmountInGroupCurrency){+
r.show(this.getResourceBundle().getText("errorCurrencyColumnNotSelected"));return}if(e&&-n.selectedCurrency===e.LocalCurrency&&parseInt(n.Value,[10])!==parseInt(e.AmountInLocalCurrency,[10])||e&&-n.selectedCurrency===e.GroupCurrency&&parseInt(n.Value,[10+
])!==parseInt(e.AmountInGroupCurrency,[10])){o.setState("Warning");if(!this.bIsMessageBoxOpen){this._initializeWarningMessageBox(t)}}else{o.setState("Success")}},_initializeWarningMessageBox:function(e){this.bIsMessageBoxOpen=true;let t=this;i.warning(th+
is.getResourceBundle().getText("errorMsgSumValueDiffTableSync"),{actions:[i.Action.OK],onClose:function(e){t.bIsMessageBoxOpen=false}})}})});                                                                                                                  