sap.ui.define(["./BaseController","sap/ui/model/json/JSONModel","sap/m/MessagePopover","sap/m/MessageItem","sap/ui/core/message/Message","sap/ui/core/library","sap/ui/core/Core","../model/formatter","sap/ui/model/Filter","sap/ui/model/FilterOperator","sa+
p/m/MessageToast","sap/m/MessageBox","sap/ui/core/ListItem","sap/ui/comp/navpopover/NavigationPopoverHandler","sap/ui/model/BindingMode","sap/viz/ui5/data/FlattenedDataset","sap/viz/ui5/format/ChartFormatter","sap/viz/ui5/api/env/Format"],function(e,t,o,+
n,i,r,s,a,l,d,g,c,u,h,p,f,C,m){"use strict";let y=false,I=false,P=false,b=false,T=0;let M=sap.ui.getCore();return e.extend("ey.sap.fin.cs.recgaapstattax.controller.Worklist",{formatter:a,onInit:function(){let e=this.getView();this.oRouter=this.getOwnerCo+
mponent().getRouter();this.oRouter.getRoute("Reconciliation").attachMatched(this._onRouteMatched,this);this.g2seditable=false;let o=new t;this.setModel(o,"VHCompCodeModel");let n=new t;this.setModel(n,"VHTTModel");let i=new t;this.setModel(i,"CompnyCodeV+
alModel");let r=new t;e.setModel(r,"PeriodValModel");let s=new t,a=new t,l=new t;this.setModel(s,"GLAccVHModel");this.setModel(a,"PrftCentrVHModel");this.setModel(l,"CostCntrVHModel");this._fetchGlobalParameters();this._fetchAdjustmentReasons();this._fet+
chValueHelp("/xEY1xSAV_C_CompCodeVH",o);this._fetchValueHelp("/xEY1xSAV_C_AdjReasn_VH",n);let d=new t({});this.getOwnerComponent().setModel(d,"postPTAEntriesConfigModel");let g=new t;this.setModel(g,"PostJrnMsgModel");let c=new t;e.setModel(c,"postJourna+
lModel");let u=new t;e.setModel(u,"LedgrModel");let h=new t;e.setModel(h,"ContrlAreaModel");let p=new t({editIntention:false});e.setModel(p,"editPostJrnlModel")},onAfterRendering:function(){let e=sap.ushell.services.AppConfiguration,t=this.getI18nText("t+
extMenuItemCTAForPnL"),o=this;if(!this._oAppSettingDialogCTA){this._oAppSettingDialogCTA=sap.ui.xmlfragment("ey.sap.fin.cs.recgaapstattax.fragment.AppSettingCTA",this);this.getView().addDependent(this._oAppSettingDialogCTA)}let n=new sap.m.Button({text:t+
,press:function(e){if(!o._oAppSettingDialogCTA){o._oAppSettingDialogCTA=sap.ui.xmlfragment("ey.sap.fin.cs.recgaapstattax.fragment.AppSettingCTA",o);o.getView().addDependent(o._oAppSettingDialogCTA)}o._oAppSettingDialogCTA.open()}});e.addApplicationSettin+
gsButtons([n])},onBeforeRebindTable:function(e){let t=this.getView(),o=t.getModel("viewConfigDataModel").getData();if(!o.globalParameters||!o.globalParameters.ConsolidationChartofAccounts||!o.globalParameters.ConsolidationGroup){c.error(this.getI18nText(+
"errorMaintainGlobalParameter"));return}let n=t.byId("idConsUnit"),i=n.getSelectedKey(),r=t.byId("idCurrency"),s=r.getSelectedKey(),a=t.byId("idFiscalYearFilter"),g=a.getDateValue().getFullYear(),u=t.byId("idPeriodFromInput"),h=t.byId("idPeriodToInput"),+
p=parseInt(u.getValue(),[10]),f=parseInt(h.getValue(),[10]),C=this._oAppSettingDialogCTA.getContent().find(e=>e.getId()==="idAppSettingsCTAIsCTAIncludedCheckBox"),m=C.getSelected()?"X":"";if(t.byId("idIntentionComboBox").getEnabled()===false){c.error(thi+
s.getI18nText("IntentionNotYetOpen")+g);this.oGlobalSmartTable.setTableBindingPath("");return}let y=t.byId("idIntentionComboBox").getSelectedItem().getBindingContext("intentionVHModel"),I=y.getObject(),P=parseInt(I.CurrOpenPeriod,[10]);if(I.status===this+
.getI18nText("YetToOpen")){this.getBusyDialog().close();c.error(this.getModel("i18n").getResourceBundle().getText("ThisIntentionNotYetOpen",[I.IntentDescription,I.Gjahr]));this.oGlobalSmartTable.setTableBindingPath("");return}if(f>P){this.getBusyDialog()+
.close();c.error(this.getModel("i18n").getResourceBundle().getText("errorPeriodnotopen",[f,P]));this.oGlobalSmartTable.setTableBindingPath("");return}let b=parseInt(I.TaxIntention,[10]),T=I.TaxIntention,M=b>12?b:"",S,D,V;S=new l({filters:[new l("Consolid+
ationUnit",d.EQ,i),new l("ConsolidationChartofAccounts",d.EQ,o.globalParameters.ConsolidationChartofAccounts),new l("MainCurrency",d.EQ,s)],and:true});V=S;if(e.getParameter("bindingParams").filters.length>0){D=new l({filters:e.getParameter("bindingParams+
").filters});V=new l({filters:[S,D],and:true})}p=p?p<0?0:p>12?12:p:1;f=f?f<0?0:f>12?12:f:12;let A="/xEY1xSAV_C_Reconciliation(p_ryear='"+g+"',p_fromyb='"+p+"',p_toyb='"+f+"',p_switch='"+m+"',p_taxintention='"+M+"',p_intention='"+T+"')/Results";this.oGlob+
alSmartTable.setTableBindingPath(A);let x=e.getParameter("bindingParams");x.filters=[V];let w=this.getOwnerComponent().getModel("postPTAEntriesConfigModel");w.getData().sServicePath=A;w.getData().oMainServiceFilters=V;w.setData(w.getData())},_onRouteMatc+
hed:function(){this.getBusyDialog().close();this.oGlobalSmartTable=this.getView().byId("idgaaptostat");this.oGlobalPostPTAEntriesConfigModel=this.getOwnerComponent().getModel("postPTAEntriesConfigModel");if(this.oGlobalPostPTAEntriesConfigModel.getProper+
ty("/DocumentNumber")){this.oGlobalPostPTAEntriesConfigModel.setProperty("/DocumentNumber",null);this.oGlobalSmartTable.rebindTable()}},_fetchDefaultParameters:function(){let e=this,o="/Defaultparameters('FIN')",n=this.getOwnerComponent().getModel("userD+
efaultParameters"),i=new t;this.setModel(i,"defParamModel");n.read(o,{method:"GET",success:function(t,o){i.setData(t);if(t.CompanyCode!=""){e._fetchCurrencyForPostGen(t.CompanyCode,false)}},error:function(t){g.show(e.getI18nText("defParamServiceCallError+
"))}})},_fetchValueHelp:function(e,t){let o=this,n;if(e==="/xEY1xSAV_C_ReadIntentVH"){n=this.getOwnerComponent().getModel()}else{n=this.getOwnerComponent().getModel("postAdjModel")}n.read(e,{method:"GET",success:function(e,o){t.setData(e.results)},error:+
function(e){g.show(o.getI18nText("VHServiceCallError"))}})},_fetchValueHelpwithFilter:function(e,t,o){let n=this,i=new l("CompanyCode",d.EQ,o),r=this.getOwnerComponent().getModel("postAdjModel");r.read(e,{method:"GET",filters:[i],success:function(e,o){t.+
setData([]);t.setData(e.results)},error:function(e){g.show(n.getI18nText("VHServiceCallError"))}})},_fetchPeriodVal:function(e){let t=this.getOwnerComponent().getModel("postAdjModel"),o=this.byId("smartForm"),n=t.getProperty(o.getBindingContext().getPath+
()),i="/PeriodSet",r=this,s={CompanyCode:e,PostingDate:n.PstngDate.toJSON()};t.read(i,{method:"GET",urlParameters:s,success:function(e,n){console.log(e.results[0].ReturnPeriod);r.getModel("PeriodValModel").setData([]);r.getModel("PeriodValModel").setData+
(e.results[0].ReturnPeriod);t.setProperty(o.getBindingContext().getPath()+"/FisPeriod",e.results[0].ReturnPeriod)},error:function(e){}})},_fetchPeriodForIntention:function(e){let t=this.getOwnerComponent().getModel("postAdjModel"),o=this.byId("smartForm"+
),n="/xEY1xC_PERIODTO_FROM_INTENTION",i=this,r=new l("Intention",d.EQ,e);t.read(n,{method:"GET",filters:[r],success:function(e,n){console.log(e.results[0].PeriodTo);i.getModel("PeriodValModel").setData([]);i.getModel("PeriodValModel").setData(e.results[0+
].PeriodTo);t.setProperty(o.getBindingContext().getPath()+"/FisPeriod",e.results[0].PeriodTo)},error:function(e){}})},_fetchCostElemCat:function(e,t,o){let n=this,i=this.getModel("defParamModel").getData(),r=i.CostCenter,s=i.ProfitCenter,a=i.ControllingA+
rea,c=new l({filters:[new l("GLAccount",d.EQ,e),new l("ControllingArea",d.EQ,t)],and:true}),u=this.getOwnerComponent().getModel("postAdjModel");u.read("/xEY1xSAV_C_CostElement",{method:"GET",filters:[c],success:function(e,t){if(e.results.length>0){if(par+
seInt(e.results[0].CostElementCat,[10])===1){u.setProperty(o+"/Costcenter",r);u.setProperty(o+"/ProfitCtr","")}else if(parseInt(e.results[0].CostElementCat,[10])===11){u.setProperty(o+"/Costcenter","");u.setProperty(o+"/ProfitCtr",s)}else{if(!b){u.setPro+
perty(o+"/ProfitCtr",s);u.setProperty(o+"/Costcenter","");b=true}}}else{if(!b){u.setProperty(o+"/ProfitCtr",s);u.setProperty(o+"/Costcenter","");b=true}}},error:function(e){g.show(n.getI18nText("VHServiceCallError"))}})},_fetchGlobalParameters:function()+
{var e=this;var o={Default:true};var n=this.getOwnerComponent().getModel();let i=new t;this.setModel(i,"viewConfigDataModel");n.callFunction("/GlobalParameter",{method:"GET",urlParameters:o,success:function(t){e.getView().getModel("viewConfigDataModel").+
setData({globalParameters:t});let o=e.getView().byId("idsmartFilterBar");if(!o.getCurrentVariantId()){e._setFilterBarParameters(t)}},error:function(t){c.error(e.getI18nText("errorReadingGlobalParameters"))}})},_setFilterBarParameters:function(e){let t=th+
is.getView(),o=t.byId("idCurrency");if(e.ConsolidationUnit){t.byId("idConsUnit").setSelectedKey(e.ConsolidationUnit);this.fetchReconLedgerData();o.setVisible(true);this._fetchCurrencyData(true);this._fetchCompCode()}if(e.FiscalYear){let o=new Date("06/06+
/".concat(e.FiscalYear.toString()));t.byId("idFiscalYearFilter").setDateValue(o)}if(e.Intention){t.byId("idIntentionComboBox").setSelectedKey(e.Intention)}var n=[e.ConsolidationUnit,e.FiscalYear];this._fetchIntentionStatus(n);if(e.PeriodFrom){t.byId("idP+
eriodFromInput").setValue(a.convertStringToInt(e.PeriodFrom))}if(e.PeriodTo){t.byId("idPeriodToInput").setValue(a.convertStringToInt(e.PeriodTo))}this._fetchPostingDate();if(e.LocalCurrencyType&&e.LocalCurrency){o.setSelectedKey(e.LocalCurrency)}else{o.s+
etSelectedKey(e.GroupCurrency)}this._formatG2SEnablity()},_fetchAdjustmentReasons:function(){let e=this.getOwnerComponent().getModel();let t="/xEY1xSAV_C_Recon_Adj_Reason";let o=this;e.read(t,{method:"GET",success:function(e,t){var n=o.getModel("viewConf+
igDataModel");n.getData().adjustmentReason=e.results;n.refresh()},error:function(e){if(parseInt(e.statusCode,[10])!==404){g.show(o.getI18nText("reconServiceCallError"))}}})},_fetchCnsldVersion:function(){let e=this.getModel(),o=this.getModel("viewConfigD+
ataModel").getData(),n=o.globalParameters.ConsolidationGroup,i="/xEY1xSAV_C_Get_Version(p_congr='"+n+"')/Set",r=this,s=new t;sap.ui.getCore().setModel(s,"viewCnlVersionModel");e.read(i,{method:"GET",sorters:[new sap.ui.model.Sorter("FiscalYear")],success+
:function(e,t){sap.ui.getCore().getModel("viewCnlVersionModel").setData({ConsolidationVersion:e})},error:function(e){if(parseInt(e.statusCode,[10])!==404){g.show(r.getI18nText("GetConsolidationVersionServiceCallError"))}}})},_createJournalEntriesFilterDa+
ta:function(e){let t=e.getSource().getBindingContext();if(!t.getProperty("GLAccount")){return}let o=this.getModel("viewConfigDataModel").getData(),n=this.getView().byId("idFiscalYearFilter"),i=n.getDateValue().getFullYear(),r=parseInt(this.getView().byId+
("idPeriodFromInput").getValue(),[10]),s=parseInt(this.getView().byId("idPeriodToInput").getValue(),[10]),l=this.getView().byId("idConsUnit"),d=this.getView().byId("idCurrency"),g=this.getView().byId("idIntentionComboBox").getSelectedItem().getBindingCon+
text("intentionVHModel").getObject(),c=a.convertStringToInt(g.PeriodTo)===0?"":a.convertStringToInt(g.TaxIntention),u=e.getSource().getCustomData(),h="",p=[],f="",C=o.globalParameters.ConsolidationGroup;for(let e of u){let t=e.getValue();let n=e.getKey()+
;if(n==="mappedLedger"&&t==="GAAPLedger"){h=o.reconData.gaap;continue}else if(n==="mappedLedger"&&t==="GAAPToSTATLedger"){h=o.reconData.g2s;continue}else if(n==="mappedLedger"&&t==="STATLedger"){h=o.reconData.stat;continue}else if(n==="mappedLedger"&&t==+
="STATToTAXLedger"){h=o.reconData.s2t;f=t;continue}else if(n==="mappedLedger"&&t==="TAXLedger"){h=o.reconData.tax;continue}else if(n==="mappedAdjReason"&&(t==="P&L"||t==="EQ"||t==="OP&L"||t==="OPERMANENT"||t==="OEQ"||t==="PERMANENT")){for(let e=0;e<o.adj+
ustmentReason.length;e++){if(o.adjustmentReason[e].AdjustmentReason===t){p.push(o.adjustmentReason[e].TransType)}}continue}}let m=t.getProperty("GLAccount").padStart(10,"0");let y=e.getSource().getBindingInfo("text").parts,I=y[y.map(e=>e.path.indexOf("Ma+
inCurrency")!==0).indexOf(true)].path;let P=this.serviceDataProperty.property;P=P[P.map(e=>e.name).indexOf(I)];let b=P.extensions;b=b[b.map(e=>e.name).indexOf("label")];return{ConsolidationChartOfAccounts:o.globalParameters.ConsolidationChartofAccounts,F+
iscalYear:i,PeriodFrom:r||"1",PeriodTo:s||"12",ConsolidatioUnit:l.getSelectedKey(),ConsolidationLedger:h,Value:t.getProperty(I),Currency:t.getProperty("MainCurrency"),GLAccount:m,GLAccountDesc:t.getProperty("GLAccountMdmText"),ConsolidationVersion:"",Sel+
ectedIntention:c,ConsolidationGroup:"",PeriodMode:"PER",RefConsolidationDocumentType:"W",selectedCurrency:d.getSelectedKey(),SectionName:b.value,FinancialTransactionType:p,NavLedger:f,Congr:C}},_createPTAEntriesFilterData:function(e){let t=e.getSource().+
getBindingContext(),o=this.getView().byId("idFiscalYearFilter"),n=o.getDateValue().getFullYear(),i=parseInt(this.getView().byId("idPeriodFromInput").getValue(),[10]),r=parseInt(this.getView().byId("idPeriodToInput").getValue(),[10]),s=this.getView().byId+
("idConsUnit"),a=t.getProperty("GLAccount"),l=parseInt(this.getView().byId("idIntentionComboBox").getSelectedItem().getBindingContext("intentionVHModel").getObject().TaxIntention,[10]),d=l>12?l:"";let g=e.getSource().getBindingInfo("text").parts,c=g[g.ma+
p(e=>e.path.indexOf("MainCurrency")!==0).indexOf(true)].path;let u=this.serviceDataProperty.property;u=u[u.map(e=>e.name).indexOf(c)];let h=u.extensions;h=h[h.map(e=>e.name).indexOf("label")];return{FiscalYear:n,PeriodFrom:i,PeriodTo:r,ConsolidationUnit:+
s.getSelectedKey(),Value:t.getProperty(c),Currency:t.getProperty("MainCurrency"),GLAccount:a,GLAccountDesc:t.getProperty("GLAccountMdmText"),SectionName:h.value,SelectedIntention:d}},_fetchCurrencyForPostGen:function(e,o){let n=new l("CompanyCode",d.EQ,e+
),i=this.getModel("postAdjModel"),r=this.byId("smartForm"),s=this;i.read("/xEY1xSAV_C_CompCodeCurr",{method:"GET",filters:[n],success:function(e,n){let i=e.results;if(i.length>0){s.setModel(new t(i[0]),"currLocalPstJrnModel")}if(o){if(i.length>0){r.getMo+
del().setProperty(r.getBindingContext().getPath()+"/Currency",i[0].Currency);s.byId("idCurrTab").setText(i[0].Currency)}else{r.getModel().setProperty(r.getBindingContext().getPath()+"/Currency","");s.byId("idCurrTab").setText("")}}},error:function(e){c.e+
rror(s.getI18nText("errorCurrencyServiceCall"))}})},_fetchCurrencyData:function(e){var o=this.getView(),n=o.byId("idConsUnit").getSelectedKey(),i=new l("ConsolidationUnit",d.EQ,n),r=this.getModel(),s=this,a=o.byId("idCurrType"),g=o.byId("idCurrency");a.s+
etVisible(true);g.setBusy(true);r.read("/xEY1xSAV_C_CurrLocalGroupVH",{method:"GET",filters:[i],success:function(o,n){g.setBusy(false);s.setModel(new t(o),"currLocalGroupVHModel");if(!e&&o.results.length>0){g.setSelectedKey(o.results[0].Currency)}},error+
:function(e){g.setBusy(false);c.error(s.getI18nText("errorIntentionServiceCall"))}})},_fetchCompCode:function(){var e=this.getView(),t=e.byId("idConsUnit").getSelectedKey(),o=new l("ConsolidationUnit",d.EQ,t),n=this.getModel("postAdjModel"),i=this;n.read+
("/xEY1xSAV_C_CompnyCodeCnsldUnit",{method:"GET",filters:[o],success:function(e,t){if(e.results.length>0){i.getModel("CompnyCodeValModel").setData(e.results)}else{i.getModel("CompnyCodeValModel").setData([])}},error:function(e){c.error(i.getI18nText("err+
orCompCodeServiceCall"))}})},fetchReconLedgerData:function(e){let t=this,o=this.getModel(),n=o.createKey("/xEY1xSAV_C_Recon_Ledger",{bunit:this.byId("idConsUnit").getSelectedKey()});this.getBusyDialog().open();o.read(n,{method:"GET",success:function(e,o)+
{t.getBusyDialog().close();var n=t.getModel("viewConfigDataModel");n.getData().reconData=e;n.refresh();t._fetchCnsldVersion()},error:function(e){t.getBusyDialog().close();if(parseInt(e.statusCode,[10])!==404){g.show(t.getI18nText("reconServiceCallError")+
)}}})},_fetchIntentionStatus:function(e){let o=this.getModel();let n=e[0],i=e[1],r="/xEY1xSAV_C_IntentionsStatus(p_bunit='"+n+"')/Set",s=new l("Gjahr",d.EQ,i),a=this,g=a.getView(),u=g.byId("idIntentionComboBox");this.getBusyDialog().open();o.read(r,{meth+
od:"GET",sorters:[new sap.ui.model.Sorter("SerialNumber")],filters:[s],success:function(e,o){a.getBusyDialog().close();if(e.results.length===0){u.setSelectedKey("");u.setEnabled(false);c.error(a.getI18nText("IntentionNotYetOpen")+i);a._disableButton(fals+
e);return}u.setEnabled(true);let n=a.getView().getModel("viewConfigDataModel").getData().globalParameters;u.setSelectedKey(n.Intention);u.setSelectedKey("");for(let t=0;t<e.results.length;t++){if(e.results[t].isSelected==="X"){u.setSelectedKey(e.results[+
t].Intention)}}if(u.getSelectedKey()===""){for(let t=0;t<e.results.length;t++){if(e.results[t].status==="Open"){u.setSelectedKey(e.results[t].Intention)}}}let r=new t(e);a.getView().setModel(r,"intentionVHModel");a._managePeriodFieldsEditability(false)},+
error:function(e){a.getBusyDialog().close();c.error(a.getI18nText("errorFetchingIntentionStatus"))}})},_managePeriodFieldsEditability:function(e){let t=this.getView(),o=t.byId("idIntentionComboBox");if(!e){o.setSelectedKey(o.getSelectedKey())}let n=o.get+
SelectedItem(),i=n.getBindingContext("intentionVHModel").getObject();let r=t.byId("idPeriodToInput"),s=a.convertStringToInt(i.TaxIntention);if(s!==a.convertStringToInt(0)){this._manageIntentionStatus(i);r.setEditable(false);r.setValue(a.convertStringToIn+
t(i.PeriodTo));this._fetchPostingDate()}else{r.setEditable(true);r.setValue(a.convertStringToInt(i.CurrOpenPeriod));let e=parseInt(r.getValue(),[10]);this._managePerodicIntentionStatus(e)}},_manageIntentionStatus:function(e){let t=this;if(e.status==="Clo+
sed"){this._disableButton(false);return}else if(e.status===this.getI18nText("YetToOpen")){t.getBusyDialog().close();c.error(this.getModel("i18n").getResourceBundle().getText("ThisIntentionNotYetOpen",[e.IntentDescription,e.Gjahr]));this._disableButton(fa+
lse);return}else if(e.status==="Open"){this._disableButton(true);if(e.Intention==="CIT"||e.Intention==="TXA"||e.Intention==="TXU"){this.byId("idStatAdjBtn").setEnabled(false)}}},_managePerodicIntentionStatus:function(e){let t=this.getView().byId("idInten+
tionComboBox").getSelectedItem().getBindingContext("intentionVHModel").getObject(),o=parseInt(t.CurrOpenPeriod,[10]);if(t.status==="Closed"){this._disableButton(false);return}if(e===o){this._disableButton(true)}else if(e<o){this._disableButton(false);ret+
urn}else if(e>o){this.getBusyDialog().close();c.error(this.getModel("i18n").getResourceBundle().getText("errorPeriodnotopen",[e,o]));this._disableButton(false);return}else{this._disableButton(false);return}},_disableButton:function(e){this.byId("idDataMo+
nitor").setEnabled(e);this.byId("idNavToPostGLEntriesLC").setEnabled(e);this.byId("idPostPTAEntriesBtn").setEnabled(e);this.byId("idStatAdjBtn").setEnabled(e);this.byId("idTaxAdjBtn").setEnabled(e)},_fetchPostingDate:function(){let e=this,t=this.getView(+
),o=this.getModel(),n=t.byId("idConsUnit"),i=t.byId("idFiscalYearFilter"),r=parseInt(t.byId("idPeriodToInput").getValue(),[10]),s="/PostingDate";o.callFunction(s,{method:"GET",urlParameters:{ConsolidationUnit:n.getSelectedKey(),FiscalYear:i.getDateValue(+
).getFullYear(),Poper:r},success:function(t){e.getView().getModel("postJournalModel").setData([]);e.getView().getModel("postJournalModel").setData(t)},error:function(t){if(parseInt(t.statusCode,[10])!==404){g.show(e.getI18nText("GetPostingDateServiceCall+
Error"))}}})},_setAmountBal:function(){let e=this.byId("idLineItemsTable"),t=0,o=this.byId("smartForm"),n=o.getModel(),i=n.getProperty(o.getBindingContext().getPath()),r=i.Currency,s=e.getItems();if(s.length>0){for(let e=0;e<s.length;e++){let o=s[e].getB+
indingContextPath(),i=n.getProperty(o);if(i.DbCrVal==="H"){i.AmtDoccur=-1*parseFloat(i.AmtDoccur,[10]).toFixed(2)}else{i.AmtDoccur=1*parseFloat(i.AmtDoccur,[10]).toFixed(2)}t=t+i.AmtDoccur}}else{t="0.00"}this.byId("idAmtBalTxt").setText(this.getResourceB+
undle().getText("TotalBalLabel",[t]));this.byId("idCurrTab").setVisible(true);this.byId("idCurrTab").setText(r)},_setOrignalMode:function(e){let t=this.byId("idLineItemsTable").getItems(),o=this.getModel("OrgnlDataModel").getData(),n=this.byId("smartForm+
").getBindingContext(),i=this.byId("smartForm").getModel();i.deleteCreatedEntry(n);for(let e=0;e<t.length;e++){let o=t[e].getBindingContext();i.deleteCreatedEntry(o);this.byId("idLineItemsTable").removeItem(t[e])}o.FisPeriod=this.getModel("PeriodValModel+
").getData();var r=i.createEntry("/AccountHeaderSet",{properties:o});this.byId("smartForm").setBindingContext(r);if(o.CompanyCode){this._fetchCurrencyForPostGen(o.CompanyCode,true)}},getI18nText:function(e){return this.getResourceBundle().getText(e)},onB+
eforeVariantSaveFilterBar:function(e){let t=this.getView();let o=t.byId("idsmartFilterBar");let n=t.byId("idConsUnit");let i=t.byId("idFiscalYearFilter");let r=t.byId("idIntentionComboBox");let s=t.byId("idCurrency");let a=t.byId("idPeriodToInput");o.set+
FilterData({_CUSTOM:{ConsolidationUnit:n.getSelectedKey(),FiscalYear:i.getValue(),Intention:r.getSelectedKey(),Currency:s.getSelectedKey(),PeriodTo:a.getValue(),VariantID:o.getCurrentVariantId()}})},onAfterVariantLoadFilterBar:function(e){var t=this.getV+
iew();var o=t.byId("idsmartFilterBar");var n=t.byId("idConsUnit");var i=t.byId("idFiscalYearFilter");let r=t.byId("idIntentionComboBox");var s=t.byId("idCurrency");let l=this.getView().byId("idPeriodToInput");var d=o.getFilterData()["_CUSTOM"];n.setSelec+
tedKey(d.ConsolidationUnit);i.setValue(d.FiscalYear);r.setSelectedKey(d.Intention);s.setSelectedKey(d.Currency);l.setValue(a.convertStringToInt(d.PeriodTo));if(d.ConsolidationUnit){this.fetchReconLedgerData()}if(d.Currency){s.setVisible(true);this._fetch+
CurrencyData(true)}var g=[n,i];this._fetchIntentionStatus(g)},onSearchButtonPressed:function(e){this.getView().byId("idFStxt").setVisible(true);let t=this.getModel().getServiceMetadata().dataServices.schema[0].entityType;this.serviceDataProperty=t.find(e+
=>e.name==="xEY1xSAV_C_ReconciliationResult");this.fetchReconLedgerData(e)},onChangeDbCr:function(){this._setAmountBal()},onChangeTransType:function(e){let t=this.getModel("VHTTModel").getData(),o=e.getSource(),n=o.getValue(),i=o.getModel(),r,s=t.some(e=+
>e.TransType===n);if(s){o.setValueState("None");I=true;r=t.find(e=>e.TransType===n).DocType;i.setProperty(o.getBindingContext().getPath()+"/DocType",r)}else{o.setValueState("Error");I=false}},onChangeGLAcc:function(e){let t=this.getModel("GLAccVHModel").+
getData(),o=e.getSource().getValue(),n=this.byId("smartForm"),i=n.getModel(),r=i.getProperty(n.getBindingContext().getPath()),s=this.getModel("ContrlAreaModel").getData(),a=this.getModel("defParamModel").getData(),l=t.some(e=>e.GLAccount===o),d;if(s[0].C+
ontrollingArea===a.ControllingArea){d=true}else{d=false}if(l){e.getSource().setValueState("None");if(r.CompanyCode&&d){this._fetchCostElemCat(o,a.ControllingArea,e.getSource().getBindingContext().getPath())}}else{e.getSource().setValueState("Error")}},on+
ChangeCostCentr:function(e){let t=this.getModel("CostCntrVHModel").getData(),o=e.getSource().getValue(),n=t.some(e=>e.CostCenter===o);if(n){e.getSource().setValueState("None")}else{e.getSource().setValueState("Error")}},onChangeProfitCentr:function(e){le+
t t=this.getModel("PrftCentrVHModel").getData(),o=e.getSource().getValue(),n=t.some(e=>e.ProfitCenter===o);if(n){e.getSource().setValueState("None")}else{e.getSource().setValueState("Error")}},onChangeDocType:function(e){let t=this.getModel("VHDTModel").+
getData(),o=e.getSource().getValue(),n=true;if(o){n=t.some(e=>e.CADocumentType===o)}if(n){e.getSource().setValueState("None")}else{e.getSource().setValueState("Error")}},onChangePeriod:function(e){},onChangeAmount:function(){this._setAmountBal()},onShare+
InJamPress:function(){var e=this.getModel("worklistView"),t=M.createComponent({name:"sap.collaboration.components.fiori.sharing.dialog",settings:{object:{id:location.href,share:e.getProperty("/shareOnJamTitle")}}});t.open()},onSearch:function(e){if(e.get+
Parameters().refreshButtonPressed){this.onRefresh()}else{var t=[];var o=e.getParameter("query");if(o&&o.length>0){t=[new l("GLAccount",d.Contains,o)]}this._applySearch(t)}},onLCDataRequested:function(e){this.getView().byId("idFStxt").setVisible(true)},on+
LCDataReceived:function(e){this.getBusyDialog().open();this.oGlobalSmartTable.getTable().setVisibleRowCount(10);let t=this.getView(),o=t.byId("idFStxt"),n=t.byId("idFSItem");this.oGlobalSmartTable.getCustomToolbar().getContent()[8].attachPress(this._onSe+
tPress,this);if(n.getGrouped()){o.setVisible(true)}else{o.setVisible(false)}var i=window.setInterval(function(){this.onAdjustLCCol();window.clearInterval(i)}.bind(this),1e3)},_onSetPress:function(){this.getView().byId("idFStxt").setVisible(true)},onAdjus+
tLCCol:function(){let e=this.oGlobalSmartTable;var t=e.getTable();var o=t.getColumns();for(var n=o.length-1;n>=0;n--){t.autoResizeColumn(n)}t.setFixedColumnCount(4);this.getBusyDialog().close()},onChangeDatePickerFilter:function(e){let t=e.getSource(),o=+
this.getView().byId("idConsUnit").getProperty("selectedKey");if(e.getParameter("valid")){t.setValueState("None");let e=t.getDateValue().getFullYear(),n=[o,e];this._fetchIntentionStatus(n);this._fetchPostingDate()}else{t.setValueState("Error")}},onConsUni+
tChange:function(e){this._fetchCurrencyData(false);this._fetchPostingDate();this._fetchCompCode();this.fetchReconLedgerData();let t=this.getView().byId("idConsUnit").getProperty("selectedKey");let o=[t,this.getView().byId("idFiscalYearFilter").getDateVal+
ue().getFullYear()];this._fetchIntentionStatus(o)},onChangeIntentionComboBox:function(e){let t=this.getView(),o=t.byId("idIntentionComboBox"),n=o.getSelectedItem();if(!n){o.setSelectedItem("");return}this._managePeriodFieldsEditability(true);this._format+
G2SEnablity()},onCurrTypeChange:function(){},onLiveChangePeriodTo:function(){let e=this.getView().byId("idPeriodToInput");let t=parseInt(this.getView().byId("idPeriodFromInput").getValue(),[10]);let o=parseInt(e.getValue(),[10]);e.setValueState("None");i+
f(o<t){e.setValueState("Error");e.setValueStateText(this.getI18nText("periodToLessThanPeriodFromErrorMsg"));return}else if(o>12){e.setValueState("Error");e.setValueStateText(this.getI18nText("periodToGreaterThanLastPeriod"));return}else if(isNaN(o)){retu+
rn}else{this._managePerodicIntentionStatus(o);this._fetchPostingDate()}},onPressGLAccountNavigation:function(e){this.performCrossAppNavigation("AccountingDocument","postGLDocument",true)},onPressStatTaxAdj:function(e){setTimeout(function(){this._fetchDef+
aultParameters()}.bind(this),100);let o=this.getView(),n=this.getModel("postAdjModel"),i=this.getModel("CompnyCodeValModel").getData(),r,s;if(i.length>1){s=i[0].CompanyName;let e=i.filter(e=>e.CompanyName===e.CompanyCode);r=e[0].CompanyCode}else if(i.len+
gth===1){r=i[0].CompanyCode;s=i[0].CompanyName}else{r="";s=""}let a=o.byId("idFiscalYearFilter").getDateValue().getFullYear(),l=new Date,d=o.getModel("postJournalModel").getData().POSTINGDATE,g=d.substring(0,4),c=d.substring(4,6),u=d.substring(6,8),h=new+
 Date(g+"-"+c+"-"+u),p=h.getTime(),f=l.getTime(),C=f>p?h:l,m=e.getSource().getCustomData(),y=o.byId("idIntentionComboBox").getSelectedItem().getBindingContext("intentionVHModel").getObject(),I=y.IntentDescription+" ("+y.TaxIntention+")",b=parseInt(y.TaxI+
ntention,[10]),T,M,S,D=this.getModel("GLAccVHModel"),V=this.getModel("CostCntrVHModel"),A=this.getModel("PrftCentrVHModel"),x=this.getModel("ContrlAreaModel"),w=false,_=this.getI18nText("g2stitle"),F=this.getI18nText("s2ttitle");console.log(C);this._fetc+
hValueHelpwithFilter("/C_GLAccountValueHelp",D,r);this._fetchValueHelpwithFilter("/C_CostCenterVH",V,r);this._fetchValueHelpwithFilter("/xEY1xC_ProfitCenterVH",A,r);this._fetchValueHelpwithFilter("/xEY1xSAV_C_ControllingArea",x,r);for(let e of m){M=e.get+
Key();S=e.getValue()}o.getModel("editPostJrnlModel").setProperty("/editIntention",false);if(M==="mappedLedger"&&S==="GAAPToSTATLedger"){T="G2S"}else if(M==="mappedLedger"&&S==="STATToTAXLedger"){T="ST"}n.setDefaultBindingMode("TwoWay");if(!this._oPostJou+
rnalDialog){this._oPostJournalDialog=sap.ui.xmlfragment(this.getView().getId(),"ey.sap.fin.cs.recgaapstattax.fragment.PostJournal",this);this.getView().addDependent(this._oPostJournalDialog)}if(r){P=true}var B=n.createEntry("/AccountHeaderSet",{propertie+
s:{Guid:"",CompanyCode:r,CompanyName:s,PstngDateDisply:C,DocDateDisply:C,PstngDate:C,DocDate:C,LedgerGroup:T,DocType:"",FisPeriod:"",Currency:"",TaxIntention:I,Transactiontype:""}});this.byId("smartForm").setModel(n);this.byId("smartForm").setBindingCont+
ext(B);this._oPostJournalDialog.open();if(M==="mappedLedger"&&S==="GAAPToSTATLedger"){this.byId("idPostJournlDialog").setTitle(_)}else if(M==="mappedLedger"&&S==="STATToTAXLedger"){this.byId("idPostJournlDialog").setTitle(F)}let E={Guid:"",CompanyCode:r,+
CompanyName:s,PstngDateDisply:C,DocDateDisply:C,PstngDate:C,DocDate:C,LedgerGroup:T,DocType:"",FisPeriod:"",Currency:"",TaxIntention:I,Transactiontype:""},v=new t(E);this.setModel(v,"OrgnlDataModel");this.byId("idLineItemsTable").setModel(n);if(r){this._+
fetchCurrencyForPostGen(r,true);if(b>=101&&b<=105){this._fetchPeriodForIntention(y.Intention)}else{this._fetchPeriodVal(r)}}},onPressAddNewAcc:function(){T=T+1;let e=this.byId("idLineItemsTable"),t=this.byId("smartForm"),o=t.getModel(),n=o.getProperty(t.+
getBindingContext().getPath()),i=e.getModel("postAdjModel").createEntry("/AccountItemsSet",{properties:{Guid:"",ItemnoAcc:T.toString(),GlAccount:"",ProfitCtr:"",CompCode:n.CompanyCode,Currency:"",DbCrVal:"",Costcenter:"",AmtDoccur:"0.00"}});let r=e.getBi+
ndingInfo("items").template,s=r.clone();s.setBindingContext(i);e.addItem(s);this._setAmountBal()},onRemoveItem:function(e){let t=e.getSource().getBindingContext(),o=e.getSource().getModel();o.deleteCreatedEntry(t);this.byId("idLineItemsTable").removeItem+
(e.getSource().getParent());this._setAmountBal()},onPressPostBtn:function(){let e=this.byId("smartForm"),t=e.getModel(),o=this.byId("idLineItemsTable"),n=o.getItems(),i=[],r={},s=this,a=0,l=this.byId("idTransTypSF"),d=this.byId("idCompCodeSF"),g=this.byI+
d("idPerSF");if(!l.getValue()){l.setValueState("Error")}if(!d.getValue()){d.setValueState("Error")}if(!g.getValue()){g.setValueState("Error")}if(!(I&&P)){c.error(this.getI18nText("manadtryFieldErrorMsg"));return}if(n.length===0){c.error(this.getI18nText(+
"noLineItemsErrorMsg"));return}for(let e=0;e<n.length;e++){let t=n[e].getCells()[0],o=n[e].getCells()[2],i=true;if(t.getValue()===""||t.getValueState()==="Error"){t.setValueState("Error");i=false}if(o.getValue()===""||o.getValueState()==="Error"){i=false+
;o.setValueState("Error")}if(!i){c.error(this.getI18nText("manadtryFieldErrorMsg"));return}}r=t.getProperty(e.getBindingContext().getPath());delete r.__metadata;delete r.TaxIntention;delete r.Currencyname;delete r.Transactiontypetext;delete r.PstngDateDi+
sply;delete r.DocDateDisply;delete r.CompanyName;for(let e=0;e<n.length;e++){let o=n[e].getBindingContextPath(),r=t.getProperty(o);if(r.DbCrVal==="H"){r.AmtDoccur=-1*r.AmtDoccur}else{r.AmtDoccur=1*r.AmtDoccur}a=a+r.AmtDoccur;i.push(r)}if(a!==0){c.error(t+
his.getI18nText("postAmntBalanceErrorMsg"));return}i.map(e=>{delete e.PartPrctr;delete e.DbCrVal;delete e.Acttype;delete e.Costobject;delete e.__metadata;e.Currency=r.Currency;e.AmtDoccur=e.AmtDoccur;e.CsTransT=r.Transactiontype});r.AccountItemsSet=i;r.R+
eturnSet=[];t.setUseBatch(true);t.create("/AccountHeaderSet",r,{success:function(e,t){let o=JSON.parse(t.body),n=o.d.ReturnSet.results,i=s._getFormattedData(n);s.getModel("PostJrnMsgModel").setData([]);s.getModel("PostJrnMsgModel").setData(i);s._generate+
PostjrnMsgPop();s._setOrignalMode()},error:function(e){let t=JSON.parse(e.responseText).error.innererror.errordetails,o=s._getFormattedData(t);s.getModel("PostJrnMsgModel").setData([]);s.getModel("PostJrnMsgModel").setData(o);s._generatePostjrnMsgPop()}}+
)},onhandleMessagePopoverPostJouurnal:function(e){this.oMPPostJrn.toggle(e.getSource())},onPressCancelPostBtn:function(){I=false;P=false;this._oPostJournalDialog.close();this._oPostJournalDialog.destroy();this._oPostJournalDialog=undefined},onChangeCompa+
nyCode:function(e){let t=this.getModel("VHCompCodeModel").getData(),o=this.getModel("CompnyCodeValModel").getData(),n=o.length>0?o:t,i=e.getSource().getValue(),r=this.getModel("GLAccVHModel"),s=this.getModel("CostCntrVHModel"),a=this.getModel("PrftCentrV+
HModel"),l=this.getModel("ContrlAreaModel"),d=n.some(e=>e.CompanyCode===i);b=false;if(i){this._fetchPeriodVal(i);this._fetchCurrencyForPostGen(e.getSource().getValue(),true);this._setMndValues();this._fetchValueHelpwithFilter("/C_GLAccountValueHelp",r,i)+
;this._fetchValueHelpwithFilter("/C_CostCenterVH",s,i);this._fetchValueHelpwithFilter("/xEY1xC_ProfitCenterVH",a,i);this._fetchValueHelpwithFilter("/xEY1xSAV_C_ControllingArea",l,i)}if(d){e.getSource().setValueState("None");P=true}else{e.getSource().setV+
alueState("Error");P=false}},_setMndValues:function(){let e=this.byId("idLineItemsTable"),t=this.byId("smartForm"),o=e.getItems(),n=e.getModel(),i=n.getProperty(t.getBindingContext().getPath());for(let e=0;e<o.length;e++){let t=o[e].getBindingContextPath+
();n.setProperty(t+"/GlAccount","");n.setProperty(t+"/Costcenter","");n.setProperty(t+"/ProfitCtr","");n.setProperty(t+"/CompCode",i.CompanyCode)}},_getFormattedData:function(e){for(let t=0;t<e.length;t++){if(e[t].hasOwnProperty("Type")){break}else{if(e[+
t].severity){switch(e[t].severity){case"error":e[t].Type="E";break;case"success":e[t].Type="S";break;default:e[t].Type="w";break}}}}return e},_generatePostjrnMsgPop:function(){let e=this,t=this.getModel("PostJrnMsgModel").getData();this.oMPPostJrn=new o(+
{items:{path:"PostJrnMsgModel>/",template:new n({title:"{PostJrnMsgModel>message}",subtitle:"",activeTitle:false,type:{parts:[{path:"PostJrnMsgModel>Type"}],formatter:this.formatMessageType},description:"{PostJrnMsgModel>message}"})},groupItems:true});th+
is.getView().addDependent(this.oMPPostJrn);this.byId("idMsgPopoverBtn").setVisible(true);this.byId("idMsgPopoverBtn").setText(t.length);this.byId("idMsgPopoverBtn").setType(this._buttonTypeFormatter(t));this._buttonIconFormatter(t,this.byId("idMsgPopover+
Btn"));setTimeout(function(){this.oMPPostJrn.openBy(this.byId("idMsgPopoverBtn"))}.bind(this),100)},_generateMessagePopover:function(){let e=this,t=this._oDataMonitor.getContent()[0].getModel().getData().results;this.oMP=new o({activeTitlePress:function(+
t){let o=t.getParameters().item.getProperty("title");let n=t.getSource().getModel().getData().results;for(let t=0;t<n.length;t++){if(o===n[t].MessageText){let o=n[t].LogNumber;o=e._removeChar(o,"-");o=o.trim();o=o.toUpperCase();let i=sap.ushell.Container+
.getService("CrossApplicationNavigation");i.isIntentSupported(["ConsolidationLog-log"]).done(function(e){}).fail(function(){new sap.m.MessageToast("Provide corresponding intent to navigate")});let r=i&&i.hrefForExternal({target:{semanticObject:"Consolida+
tionLog",action:"log"}})||"";let s=r+"&/LogHeaderSet/"+o;let a=window.location.href.split("#")[0]+s;sap.m.URLHelper.redirect(a,true)}}},items:{path:"/results",template:new n({title:"{MessageText}",subtitle:"",activeTitle:{parts:[{path:"URL"}],formatter:t+
his._isActive},type:{path:"Type",formatter:this.formatMessageType},description:"{MessageText}"})},groupItems:true});this.getView().addDependent(this.oMP);this.getView().byId("idMessagePopoverBtn").setVisible(true);this.getView().byId("idMessagePopoverBtn+
").setText(t.length);this.getView().byId("idMessagePopoverBtn").setType(this._buttonTypeFormatter(t));this._buttonIconFormatter(t,this.getView().byId("idMessagePopoverBtn"));setTimeout(function(){this.oMP.openBy(this.getView().byId("idMessagePopoverBtn")+
)}.bind(this),100)},onCloseToolbarPress:function(e){this.getView().byId("idReconAppFooterOverflowToolbar").setVisible(false)},_buttonTypeFormatter:function(e){var t;e.forEach(function(e){switch(e.Type){case"E":t="Reject";break;case"W":t=t!=="Reject"?"Cri+
tical":t;break;case"S":t=t!=="Reject"&&t!=="Critical"?"Accept":t;break;default:t=!t?"Neutral":t;break}});return t},_buttonIconFormatter:function(e,t){var o;e.forEach(function(e){switch(e.Type){case"E":o="sap-icon://message-error";break;case"W":o=o!=="sap+
-icon://message-error"?"sap-icon://message-warning":o;break;case"S":o="sap-icon://message-error"&&o!=="sap-icon://message-warning"?"sap-icon://message-success":o;break;default:o=!o?"sap-icon://message-information":o;break}});t.setIcon(o)},_isActive:funct+
ion(e){if(e===""){return false}else{return true}},formatMessageType:function(e){if(e==="E"){return r.MessageType.Error}else if(e==="S"){return r.MessageType.Success}else{return r.MessageType.Warning}},onhandleMessagePopoverPress:function(e){this.oMP.togg+
le(e.getSource())},onDataMonitorPress:function(e){let o=this,n=this.getOwnerComponent().getModel(),i=this.getView().byId("idConsUnit"),r=[],s="/LedgerSet",a=new l({path:"BUnit",operator:d.EQ,value1:i.getSelectedItem().getKey()});if(this.oMP){let e=new t;+
let o=[];e.setData(o);this.oMP.setModel(e);this.getView().byId("idMessagePopoverBtn").setVisible(false)}this.getView().byId("idReconAppFooterOverflowToolbar").setVisible(true);this.getBusyDialog().open();r.push(a);n.read(s,{filters:r,success:o._onLedgerS+
etSuccess.bind(this),error:o._onLedgerSetError.bind(this)})},_onLedgerSetSuccess:function(e){let t=this.getOwnerComponent().getModel(),o=this.getView().byId("idConsUnit"),n=this.getView().byId("idFiscalYearFilter"),i=this.getView().byId("idCurrency"),r=t+
his.getModel("currLocalGroupVHModel"),s="/DataMonitorParameters";if(!this._oDataMonitor){this._oDataMonitor=sap.ui.xmlfragment("ey.sap.fin.cs.recgaapstattax.fragment.DataMonitorLog",this);this.getView().addDependent(this._oDataMonitor)}let a=this._oDataM+
onitor.getContent()[0];if(a.getModel().getData()){let e=null;a.getModel().setData(e)}let l=0;let d={Action:"'"+1015+"'",ConsolidationUnit:"'"+o.getSelectedItem().getKey()+"'",FiscalYear:"'"+n.getDateValue().getFullYear()+"'",Ledger:"'"+e.results[l].RLDNR+
+"'",GroupCurrency:"'"+r.getData().results[1].Currency+"'",LocalCurrency:"'"+i.getSelectedItem().getKey()+"'",PeriodFrom:"'"+this.getView().byId("idPeriodFromInput").getValue()+"'",PeriodTo:"'"+this.getView().byId("idPeriodToInput").getValue()+"'",Intent+
ion:"'"+this.getView().byId("idIntentionComboBox").getSelectedItem().getBindingContext("intentionVHModel").getObject().Intention+"'"};this._callDataMonitorFunctionImportRecursion(t,s,l,d.Action,d.ConsolidationUnit,d.FiscalYear,e.results,d.GroupCurrency,d+
.LocalCurrency,d.PeriodFrom,d.PeriodTo,e.results.length)},_callDataMonitorFunctionImportRecursion:function(e,t,o,n,i,r,s,a,l,d,g,c){let u={Action:n,ConsolidationUnit:i,FiscalYear:r,Ledger:"'"+s[o].RLDNR+"'",GroupCurrency:a,LocalCurrency:l,PeriodFrom:d,Pe+
riodTo:g,Intention:"'"+this.getView().byId("idIntentionComboBox").getSelectedItem().getBindingContext("intentionVHModel").getObject().Intention+"'"};this._callDataMonitorFunctionImport(this,t,e,u,o,n,i,r,s,a,l,d,g,c)},_callDataMonitorFunctionImport:funct+
ion(e,o,n,i,r,s,a,l,d,g,u,h,p,f){n.read(o,{method:"GET",urlParameters:i,success:function(i){let c=e._oDataMonitor.getContent()[0];let C=c.getModel().getData();c.setBusy(true);let m=new t;if(!C){C=i}else{for(let e=0;e<i.results.length;e++){C.results.push(+
i.results[e])}}m.setData(C);c.setModel(m);r=r+1;if(r<f){e._callDataMonitorFunctionImportRecursion(n,o,r,s,a,l,d,g,u,h,p,f)}else{c.setBusy(false);e.getBusyDialog().close();e._generateMessagePopover();if(e._oDataMonitor){let t=e._oDataMonitor.getContent()[+
0];if(t.getModel().getData()){e.oMP.setModel(t.getModel())}}}},error:function(t){e.getBusyDialog().close();c.error(e.getI18nText("errorDataMonitor"))}});n.submitChanges()},_onLedgerSetError:function(e){this.getBusyDialog().close();c.error(this.getI18nTex+
t("errorLedgerSet"))},onPressOkBtnDataMonitor:function(e){this.getBusyDialog().close();this._oDataMonitor.close()},onDataMonitorListItemPress:function(e){let t=this._oDataMonitor.getContent()[0].getModel().getData().results,o=e.getSource().getText(),n;fo+
r(let e=0;e<t.length;e++){if(t[e].MessageText===o){n=t[e].LogNumber}}n=this._removeChar(n,"-");n=n.trim();n=n.toUpperCase();var i=sap.ushell.Container.getService("CrossApplicationNavigation");i.isIntentSupported(["ConsolidationLog-log"]).done(function(e)+
{}).fail(function(){new sap.m.MessageToast("Provide corresponding intent to navigate")});var r=i&&i.hrefForExternal({target:{semanticObject:"ConsolidationLog",action:"log"}})||"";var s=r+"&/LogHeaderSet/"+n;var a=window.location.href.split("#")[0]+s;sap.+
m.URLHelper.redirect(a,true)},_removeChar:function(e,t){let o,n=0,i=e.length;let r=e.split("");for(let e=o=0;e<i;e++){if(r[e]!==t)r[o++]=r[e];else n++}while(n>0){r[o++]=" ";n--}return r.join("")},onPressJournalEntriesDetail:function(e){var o=this._create+
JournalEntriesFilterData(e);if(!o){return}var n=new t(o);this.getOwnerComponent().setModel(n,"JournalEntryData");this.oRouter.navTo("JournalEntries")},onPressPTAEntriesDetail:function(e){var o=this._createPTAEntriesFilterData(e);if(o.GLAccount===this.get+
I18nText("BalanceCheckSumLabel")){return}var n=new t(o);this.getOwnerComponent().setModel(n,"PTAEntryConfigData");this.oRouter.navTo("PTAEntries")},onPressPostPTAEntriesBtn:function(e){let t=this.oGlobalSmartTable.getTable(),o=t.getBinding(),n=t.getSelec+
tedIndices(),i=[];if(!n.length>0){c.error(this.getI18nText("errorNoGlAccountSelected"));return}if(y){let e=o.getLength()-1;for(let t=0;t<e;t++){let e=o.getContextByIndex(t).getObject();i.push(e.GLAccount)}}else{for(let e of n){let t=o.getContextByIndex(e+
).getObject();i.push(t.GLAccount)}}this.validatePAndLAccounts(i)},validatePAndLAccounts:function(e){let o=this.getModel(),n=this,i="P&L",r=[],s,a=this.getOwnerComponent().getModel("postPTAEntriesConfigModel"),u=a.getData(),h=this.getView().byId("idConsUn+
it"),p=this.getView().byId("idFiscalYearFilter"),f=parseInt(this.getView().byId("idPeriodToInput").getValue(),[10]),C=this.getView().byId("idIntentionComboBox").getSelectedItem().getBindingContext("intentionVHModel").getObject(),m=this.getView().byId("id+
Currency"),y=this.getView().getModel("viewConfigDataModel").getData(),I=this.getModel("currLocalGroupVHModel"),P=this.oGlobalSmartTable.getTableBindingPath()+"/$count",b="/PostingDate",T=new t;sap.ui.getCore().setModel(T,"viewPostingDataModel");o.callFun+
ction(b,{method:"GET",urlParameters:{ConsolidationUnit:h.getSelectedItem().getKey(),FiscalYear:p.getDateValue().getFullYear(),Poper:f},success:function(e){sap.ui.getCore().getModel("viewPostingDataModel").setData({PostingDate:e})},error:function(e){if(pa+
rseInt(e.statusCode,[10])!==404){g.show(n.getI18nText("GetPostingDateServiceCallError"))}}});for(let t of e){r.push(new l("GLAccount",d.EQ,t))}s=new l({filters:[new l({filters:r}),new l("BsEqPl",d.EQ,i),u.oMainServiceFilters],and:true});this.getBusyDialo+
g().open();o.read(P,{method:"GET",filters:[s],success:function(t){n.getBusyDialog().close();if(parseInt(t,[10])>0&&parseInt(t,[10])===e.length){u.postPTAEntriesList=e;u.ConsolidationUnit=h.getSelectedItem().getKey();u.FiscalYear=p.getDateValue().getFullY+
ear();u.CurrencyType=m.getSelectedItem().getAdditionalText();u.globalParameterData=y;u.currLocalGroupVHData=I.getData();if(C.TaxIntention<=105&&C.TaxIntention>=101){u.TaxIntention=C.TaxIntention;u.TaxIntentionDesc=C.IntentDescription}else{u.TaxIntention=+
""}u.postingDate=sap.ui.getCore().getModel("viewPostingDataModel").getData().PostingDate;a.setData(u);n.getBusyDialog().open();n.oRouter.navTo("PostPTAEntries")}else{c.error(n.getI18nText("errorSelectOnlyPnLAccounts"))}},error:function(e){n.getBusyDialog+
().close();c.error(n.getI18nText("errorValidatingPnLAccount"))}})},onPressRowSelectionChangeAnalyticalTable:function(e){y=false;if(e.getParameters().selectAll){y=e.getParameters().selectAll;return}},onPressOkBtnAppSettingsCTA:function(e){let t=this.getVi+
ew().byId("idsmartFilterBar").validateMandatoryFields();if(t){this.oGlobalSmartTable.rebindTable()}this._oAppSettingDialogCTA.close()},onPressReconciliationAnalyticsBtn:function(e){let t=this.getView(),o=t.getModel("viewConfigDataModel").getData(),n=t.by+
Id("idConsUnit").getSelectedKey(),i=t.byId("idFiscalYearFilter").getDateValue().getFullYear(),r=parseInt(i,[10])-1,s=parseInt(t.byId("idPeriodFromInput").getValue(),[10]),a=parseInt(t.byId("idPeriodToInput").getValue(),[10]),g=t.byId("idCurrency").getSel+
ectedKey(),c=this._oAppSettingDialogCTA.getContent().find(e=>e.getId()==="idAppSettingsCTAIsCTAIncludedCheckBox"),u=c.getSelected()?"X":"",h=t.byId("idIntentionComboBox").getSelectedItem().getBindingContext("intentionVHModel"),p=parseInt(h.getObject().Ta+
xIntention,[10]),f=h.getObject().TaxIntention,C=p>12?p:"",m=new l({filters:[new l("ConsolidationUnit",d.EQ,n),new l("ConsolidationChartofAccounts",d.EQ,o.globalParameters.ConsolidationChartofAccounts),new l("MainCurrency",d.EQ,g)],and:true});let y=this.g+
etView().byId("idgaaptostat").getTable().getBinding(),I=[];if(y.getSelectedContexts()&&y.getSelectedContexts().length>0){let e=y.getSelectedContexts(),t;for(t=0;t<e.length;t++){I.push(new l("GLAccount",d.EQ,e[t].getObject().GLAccount))}m=new l({filters:[+
m,new l({filters:I})],and:true})}let P=this,b="/xEY1xSAV_C_Reconciliation(p_ryear='"+i+"',p_fromyb='"+s+"',p_toyb='"+a+"',p_switch='"+u+"',p_taxintention='"+C+"',p_intention='"+f+"')/Results",T="/xEY1xSAV_C_Reconciliation(p_ryear='"+r+"',p_fromyb='"+s+"'+
,p_toyb='"+a+"',p_switch='"+u+"',p_taxintention='"+C+"',p_intention='"+f+"')/Results",M=this.fetchAnalyticsReconData(b,m),S=this.fetchAnalyticsReconData(T,m);this.getBusyDialog().open();Promise.all([M,S]).then(e=>{P.getBusyDialog().close();P.initializeAn+
alytics(e)})},fetchAnalyticsReconData:function(e,t){let o=this.getOwnerComponent().getModel(),n=new Promise(function(n,i){o.read(e,{method:"GET",filters:[t],sorters:[new sap.ui.model.Sorter("GLAccount")],success:function(e,t){n(e)},error:function(e){i(e)+
}})});return n},initializeAnalytics:function(e){if(!this._oAnalyticsDialog){this._oAnalyticsDialog=sap.ui.xmlfragment("ey.sap.fin.cs.recgaapstattax.fragment.ReconAnalytics",this);this.getView().addDependent(this._oAnalyticsDialog)}this._oAnalyticsDialog.+
open();this._oAnalyticsDialog.setModel(new t({results:[{propertyName:"GaapOpeningBalance",text:"GAAP OB"},{propertyName:"GaapYearBalance",text:"GAAP Mvmnt"},{propertyName:"GaapClosingBalance",text:"GAAP CB"},{propertyName:"GaapToStatPL",text:"G2S P&L"},{+
propertyName:"GaapToStatPmnt",text:"G2S PERM"},{propertyName:"GaapToStatEQ",text:"G2S EQ"},{propertyName:"StatOpeningBalance",text:"STAT OB"},{propertyName:"StatYearBalance",text:"STAT Mvmnt"},{propertyName:"StatClosingBalance",text:"STAT CB"}]}),"modelM+
easureList");M.byId("idMeasuresList").setSelectedKey("GaapOpeningBalance");this.addFeedsToChart();m.numericFormatter(C.getInstance());let o=C.DefaultPattern,n=M.byId("idVizFrame"),i=[],r,s=M.byId("idPopOver"),a=sap.ui.getVersionInfo().libraries||[],l=a.s+
ome(function(e){return e.name.indexOf("sap.suite.ui.commons")>-1});e.map(e=>e.results.map(e=>i.push(e)));r=new t({results:i});n.setVizProperties({plotArea:{dataLabel:{formatString:o.SHORTFLOAT_MFD2,visible:true}},valueAxis:{label:{formatString:o.SHORTFLO+
AT},title:{visible:false}},categoryAxis:{title:{visible:false}},title:{visible:false,text:"OB GAAP to STAT to TAX"}});n.setModel(r,"chartModelAnalytics");s.connect(n.getVizUid());s.setFormatString(o.STANDARDFLOAT);if(l){jQuery.sap.require("sap/suite/ui/c+
ommons/ChartContainer");let e=M.byId("idVizFrame"),t=new sap.suite.ui.commons.ChartContainerContent({icon:"sap-icon://vertical-bar-chart",title:"OB GAAP to STAT to TAX",content:[e]}),o=new sap.suite.ui.commons.ChartContainer({content:[t]});o.setShowFullS+
creen(true);o.setAutoAdjustHeight(true);M.byId("chartFixFlex").setFlexContent(o)}},handleMeasureListChange:function(e){this.addFeedsToChart()},addFeedsToChart:function(){let e=M.byId("idVizFrame");e.removeAllFeeds(true);e.destroyFeeds();e.addFeed(new sap+
.viz.ui5.controls.common.feeds.FeedItem({type:"Dimension",uid:"categoryAxis",values:["ddGLAccount"]}));e.addFeed(new sap.viz.ui5.controls.common.feeds.FeedItem({type:"Dimension",uid:"categoryAxis",values:["ddFiscalYear"]}));e.addFeed(new sap.viz.ui5.cont+
rols.common.feeds.FeedItem({type:"Measure",uid:"valueAxis",values:[M.byId("idMeasuresList").getSelectedItem().getText()]}))},onPressOkBtnReconAnalytics:function(e){this._oAnalyticsDialog.close()},onPressReconciliationSmartChartBtn:function(){this.getView+
().byId("idSmartChartRecon").rebindChart()},_formatG2SEnablity:function(){let e=null;if(this.getView().byId("idIntentionComboBox").getSelectedItem()){e=this.getView().byId("idIntentionComboBox").getSelectedItem().getBindingContext("intentionVHModel").get+
Object().Intention;if(!this.getView().byId("idStatAdjBtn").getEnabled()){return}}else{e=this.getView().getModel("viewConfigDataModel").getData("globalParameters").globalParameters.Intention}if(e==="CIT"||e==="TXA"||e==="TXU"){this.getView().byId("idStatA+
djBtn").setEnabled(false)}else{this.getView().byId("idStatAdjBtn").setEnabled(true)}}})});                                                                                                                                                                     