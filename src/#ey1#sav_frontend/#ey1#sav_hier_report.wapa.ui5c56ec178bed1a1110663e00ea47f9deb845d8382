sap.ui.define([                                                                                                                                                                                                                                                
	"./BaseController",                                                                                                                                                                                                                                           
	"sap/ui/model/json/JSONModel",                                                                                                                                                                                                                                
	"../model/formatter",                                                                                                                                                                                                                                         
	"sap/ui/model/Filter",                                                                                                                                                                                                                                        
	"sap/ui/model/FilterOperator",                                                                                                                                                                                                                                
	"sap/m/MessageToast",                                                                                                                                                                                                                                         
	"sap/m/MessageBox",                                                                                                                                                                                                                                           
	"sap/ui/core/ListItem",                                                                                                                                                                                                                                       
	"sap/ui/generic/app/navigation/service/NavigationHandler"                                                                                                                                                                                                     
], function (BaseController, JSONModel, formatter, Filter, FilterOperator, MessageToast, MessageBox, ListItem, NavigationHandler) {                                                                                                                            
	"use strict";                                                                                                                                                                                                                                                 
	let aGlblArr = [];                                                                                                                                                                                                                                            
	return BaseController.extend("ey.sap.fin.cs.hierarchyReport.controller.hierarchy", {                                                                                                                                                                          
		formatter: formatter,                                                                                                                                                                                                                                        
		onInit: function () {                                                                                                                                                                                                                                        
			this.oRouter = this.getOwnerComponent().getRouter();                                                                                                                                                                                                        
			this.oRouter.getRoute("Routehierarchy").attachMatched(this._onRouteMatched, this);                                                                                                                                                                          
                                                                                                                                                                                                                                                               
			//local model which will contain recon amount data                                                                                                                                                                                                          
			let oReconDataModel = new JSONModel();                                                                                                                                                                                                                      
			this.setModel(oReconDataModel, "viewConfigDataModel");                                                                                                                                                                                                      
                                                                                                                                                                                                                                                               
			//local model for hier types - gl Acc and  Fs item                                                                                                                                                                                                          
			let oHierVHData = [{                                                                                                                                                                                                                                        
				name: this.getI18nText("FSItemText"),                                                                                                                                                                                                                      
				key: "CS15"                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                               
			}, {                                                                                                                                                                                                                                                        
				name: this.getI18nText("GLAccVHText"),                                                                                                                                                                                                                     
				key: "0109"                                                                                                                                                                                                                                                
			}]                                                                                                                                                                                                                                                          
                                                                                                                                                                                                                                                               
			var oModel = new JSONModel();                                                                                                                                                                                                                               
			this.setModel(oModel, "HierDatModel");                                                                                                                                                                                                                      
                                                                                                                                                                                                                                                               
			var oModelGL = new JSONModel();                                                                                                                                                                                                                             
			this.setModel(oModelGL, "HierDatModelGL");                                                                                                                                                                                                                  
                                                                                                                                                                                                                                                               
			let oHierVHModel = new JSONModel(oHierVHData);                                                                                                                                                                                                              
			this.setModel(oHierVHModel, "hierVHModel");                                                                                                                                                                                                                 
                                                                                                                                                                                                                                                               
			//column model for hierarchyID value ( for value help dialog)                                                                                                                                                                                               
			let oColumnVHHierIdData = {                                                                                                                                                                                                                                 
					"cols": [{                                                                                                                                                                                                                                                
						"label": this.getI18nText("labelHierId"),                                                                                                                                                                                                                
						"template": "HierarchyId",                                                                                                                                                                                                                               
						"width": "6%",                                                                                                                                                                                                                                           
						"resizable": "false"                                                                                                                                                                                                                                     
					}, {                                                                                                                                                                                                                                                      
						"label": this.getI18nText("labelHierIdDes"),                                                                                                                                                                                                             
						"template": "HierarchyText",                                                                                                                                                                                                                             
						"width": "13%",                                                                                                                                                                                                                                          
						"resizable": "false"                                                                                                                                                                                                                                     
					}]                                                                                                                                                                                                                                                        
				},                                                                                                                                                                                                                                                         
				oColVHModel = new JSONModel(oColumnVHHierIdData);                                                                                                                                                                                                          
			this.setModel(oColVHModel, "VHColumnModel");                                                                                                                                                                                                                
			this._fetchGlobalParameters();                                                                                                                                                                                                                              
			this._fetchAdjustmentReasons();                                                                                                                                                                                                                             
			//initially setting up hier type as FS Item                                                                                                                                                                                                                 
			this.getView().byId("idHierType").setSelectedKey('CS15');                                                                                                                                                                                                   
			//based on the above selected hier typ initially calling th value help for hier ids                                                                                                                                                                         
			this._fetchValueHelpHierarchyTxt(this.getView().byId("idHierType").getSelectedKey());                                                                                                                                                                       
                                                                                                                                                                                                                                                               
		},                                                                                                                                                                                                                                                           
		onAfterRendering: function () {                                                                                                                                                                                                                              
			let oAppConfig = sap.ushell.services.AppConfiguration,                                                                                                                                                                                                      
				sMenuItemText = this.getI18nText("textMenuItemCTAForPnL"),                                                                                                                                                                                                 
				that = this;                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                               
			// Initializing the Fragment, as the data is not available untill the App setting button is clicked.                                                                                                                                                        
			if (!this._oAppSettingDialogCTA) {                                                                                                                                                                                                                          
				this._oAppSettingDialogCTA = sap.ui.xmlfragment("ey.sap.fin.cs.hierarchyReport.fragment.AppSettingCTA", this);                                                                                                                                             
				this.getView().addDependent(this._oAppSettingDialogCTA);                                                                                                                                                                                                   
			}                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
			let oAppSettingsBtnCTA = new sap.m.Button({                                                                                                                                                                                                                 
				text: sMenuItemText,                                                                                                                                                                                                                                       
				press: function (oEvent) {                                                                                                                                                                                                                                 
					if (!that._oAppSettingDialogCTA) {                                                                                                                                                                                                                        
						that._oAppSettingDialogCTA = sap.ui.xmlfragment("ey.sap.fin.cs.recgaapstattax.fragment.AppSettingCTA", that);                                                                                                                                            
						that.getView().addDependent(that._oAppSettingDialogCTA);                                                                                                                                                                                                 
					}                                                                                                                                                                                                                                                         
					that._oAppSettingDialogCTA.open();                                                                                                                                                                                                                        
				}                                                                                                                                                                                                                                                          
			});                                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                               
			oAppConfig.addApplicationSettingsButtons([oAppSettingsBtnCTA]);                                                                                                                                                                                             
		},                                                                                                                                                                                                                                                           
		/* =========================================================== */                                                                                                                                                                                            
		/* internal methods  -PRIVATE                                  */                                                                                                                                                                                            
		/* =========================================================== */                                                                                                                                                                                            
                                                                                                                                                                                                                                                               
		_onRouteMatched: function () {                                                                                                                                                                                                                               
			this.getBusyDialog().close();                                                                                                                                                                                                                               
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		//value help for hier ID based on hier type selected FS item or GL acc                                                                                                                                                                                       
		_fetchValueHelpHierarchyTxt: function (sKey) {                                                                                                                                                                                                               
			let oServiceModel = this.getOwnerComponent().getModel("oManageHierModel"),                                                                                                                                                                                  
				that = this,                                                                                                                                                                                                                                               
				oFilter = new Filter({                                                                                                                                                                                                                                     
					filters: [new Filter("HierarchyCategory", FilterOperator.EQ, sKey),                                                                                                                                                                                       
						new Filter("VersionStatus", FilterOperator.EQ, 'A')                                                                                                                                                                                                      
					],                                                                                                                                                                                                                                                        
					and: true                                                                                                                                                                                                                                                 
				}),                                                                                                                                                                                                                                                        
				aFilter = oFilter;                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                               
			oServiceModel.read("/HierarchyVersionSet", {                                                                                                                                                                                                                
				method: "GET",                                                                                                                                                                                                                                             
				filters: [aFilter],                                                                                                                                                                                                                                        
				success: function (oData) {                                                                                                                                                                                                                                
					let oHierCatTextModel = new JSONModel(oData.results);                                                                                                                                                                                                     
					that.setModel(oHierCatTextModel, "hierarCatModel");                                                                                                                                                                                                       
                                                                                                                                                                                                                                                               
				},                                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                               
				error: function (oError) {                                                                                                                                                                                                                                 
					MessageBox.error(that.getI18nText("errorFetchingHierCatTxtData"));                                                                                                                                                                                        
                                                                                                                                                                                                                                                               
				}                                                                                                                                                                                                                                                          
			});                                                                                                                                                                                                                                                         
		},                                                                                                                                                                                                                                                           
		_fetchAdjustmentReasons: function () {                                                                                                                                                                                                                       
			let oModel = this.getOwnerComponent().getModel();                                                                                                                                                                                                           
			let sServiceURL = "/xEY1xSAV_C_Recon_Adj_Reason";                                                                                                                                                                                                           
			let that = this;                                                                                                                                                                                                                                            
			oModel.read(sServiceURL, {                                                                                                                                                                                                                                  
				method: "GET",                                                                                                                                                                                                                                             
				success: function (oData, oResponse) {                                                                                                                                                                                                                     
					var oReconModel = that.getModel("viewConfigDataModel");                                                                                                                                                                                                   
					oReconModel.getData().adjustmentReason = oData.results;                                                                                                                                                                                                   
					oReconModel.refresh();                                                                                                                                                                                                                                    
				},                                                                                                                                                                                                                                                         
				error: function (oError) {                                                                                                                                                                                                                                 
					if (parseInt(oError.statusCode, [10]) !== 404) {                                                                                                                                                                                                          
						MessageToast.show(that.getI18nText("adjustmentReasonsServiceCallError"));                                                                                                                                                                                
					}                                                                                                                                                                                                                                                         
				}                                                                                                                                                                                                                                                          
			});                                                                                                                                                                                                                                                         
		},                                                                                                                                                                                                                                                           
		//filtering the table inside hier id value help based on filters provided by the user                                                                                                                                                                        
		_filterVHTable: function (oFilter) {                                                                                                                                                                                                                         
			let that = this;                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                               
			this._oHierIdVHDialog.getTableAsync().then(function (oTable) {                                                                                                                                                                                              
				if (oFilter.aFilters.length === 0) {                                                                                                                                                                                                                       
					oTable.getBinding("rows").filter(oFilter);                                                                                                                                                                                                                
					oTable.getModel().refresh(true);                                                                                                                                                                                                                          
                                                                                                                                                                                                                                                               
				} else {                                                                                                                                                                                                                                                   
					oTable.getBinding("rows").filter(oFilter);                                                                                                                                                                                                                
                                                                                                                                                                                                                                                               
				}                                                                                                                                                                                                                                                          
				that._oHierIdVHDialog.update();                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                               
			});                                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                               
		},                                                                                                                                                                                                                                                           
		//fetch recon amount values to integrate with corresponding FS item in hierarchy                                                                                                                                                                             
		_fetchReconData: function () {                                                                                                                                                                                                                               
			let oReconServiceModel = this.getOwnerComponent().getModel(),                                                                                                                                                                                               
				that = this,                                                                                                                                                                                                                                               
				oView = this.getView(),                                                                                                                                                                                                                                    
				globalParameterData = oView.getModel("viewConfigDataModel").getData();                                                                                                                                                                                     
			if (!globalParameterData.globalParameters || !globalParameterData.globalParameters.ConsolidationChartofAccounts || !                                                                                                                                        
				globalParameterData.globalParameters.ConsolidationGroup) {                                                                                                                                                                                                 
				MessageBox.error(this.getI18nText("errorMaintainGlobalParameter"));                                                                                                                                                                                        
				return;                                                                                                                                                                                                                                                    
			}                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
			let idConsUnit = oView.byId("idConsUnit"),                                                                                                                                                                                                                  
				oConsUnit = idConsUnit.getSelectedKey(),                                                                                                                                                                                                                   
                                                                                                                                                                                                                                                               
				// Currency Filter Data                                                                                                                                                                                                                                    
				idCurrType = oView.byId("idCurrency"),                                                                                                                                                                                                                     
				sCurrencyUnit = idCurrType.getSelectedKey(),                                                                                                                                                                                                               
                                                                                                                                                                                                                                                               
				// Fiscal Year Filter Data                                                                                                                                                                                                                                 
				oFiscalYear = oView.byId("idFiscalYearFilter"),                                                                                                                                                                                                            
				sFiscalYearVal = oFiscalYear.getDateValue().getFullYear(),                                                                                                                                                                                                 
                                                                                                                                                                                                                                                               
				// PeriodFrom & PeriodTo Filter Data                                                                                                                                                                                                                       
				oPeriodFrom = oView.byId("idPeriodFromInput"),                                                                                                                                                                                                             
				oPeriodTo = oView.byId("idPeriodToInput"),                                                                                                                                                                                                                 
				paramFromYb = parseInt(oPeriodFrom.getValue(), [10]),                                                                                                                                                                                                      
				paramToYb = parseInt(oPeriodTo.getValue(), [10]),                                                                                                                                                                                                          
                                                                                                                                                                                                                                                               
				// CTA Switch Data                                                                                                                                                                                                                                         
				oIsCTAIncluded = this._oAppSettingDialogCTA.getContent().find(item => item.getId() === "idAppSettingsCTAIsCTAIncludedCheckBox"),                                                                                                                           
				sIsCTAIncluded = oIsCTAIncluded.getSelected() ? 'X' : '',                                                                                                                                                                                                  
                                                                                                                                                                                                                                                               
				// Intention Filter Data                                                                                                                                                                                                                                   
				oIntentionBinding = oView.byId("idIntentionComboBox").getSelectedItem().getBindingContext("intentionVHModel"),                                                                                                                                             
				iTaxIntentionVal = parseInt(oIntentionBinding.getObject().TaxIntention, [10]),                                                                                                                                                                             
				iIntentn = oIntentionBinding.getObject().TaxIntention,                                                                                                                                                                                                     
				intentionValue = iTaxIntentionVal > 100 ? iTaxIntentionVal : "",                                                                                                                                                                                           
				// oIntentionBinding = oView.byId("idIntentionComboBox").getSelectedItem().getBindingContext("intentionVHModel"),                                                                                                                                          
				// iSpecialPeriodVal = parseInt(oIntentionBinding.getObject().SpecialPeriod, [10]),                                                                                                                                                                        
				// intentionValue = iSpecialPeriodVal > 12 ? iSpecialPeriodVal : "",                                                                                                                                                                                       
                                                                                                                                                                                                                                                               
				// Other Variable declaration                                                                                                                                                                                                                              
				oMandFilters, oUserFilters, oFilters;                                                                                                                                                                                                                      
                                                                                                                                                                                                                                                               
			oMandFilters = new Filter({                                                                                                                                                                                                                                 
				filters: [new Filter("ConsolidationUnit", FilterOperator.EQ, oConsUnit),                                                                                                                                                                                   
					//	new Filter("ChartOfAccounts", FilterOperator.EQ, "CANA"),                                                                                                                                                                                              
					new Filter("ConsolidationChartofAccounts", FilterOperator.EQ, globalParameterData.globalParameters.ConsolidationChartofAccounts),                                                                                                                         
					new Filter("MainCurrency", FilterOperator.EQ, sCurrencyUnit)                                                                                                                                                                                              
				],                                                                                                                                                                                                                                                         
				and: true                                                                                                                                                                                                                                                  
			});                                                                                                                                                                                                                                                         
			oFilters = oMandFilters;                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                               
			// If value < 0, then take 0	-----	If value > 12 then take 12&nbsp;                                                                                                                                                                                         
			paramFromYb = paramFromYb ? (paramFromYb < 0 ? 0 : (paramFromYb > 12 ? 12 : paramFromYb)) : 1;                                                                                                                                                              
			paramToYb = paramToYb ? (paramToYb < 0 ? 0 : (paramToYb > 12 ? 12 : paramToYb)) : 12;                                                                                                                                                                       
                                                                                                                                                                                                                                                               
			let sBindingPath = "/xEY1xSAV_C_Reconciliation(p_ryear='" + sFiscalYearVal + "',p_fromyb='" + paramFromYb + "',p_toyb='" +                                                                                                                                  
				paramToYb + "',p_switch='" + sIsCTAIncluded + "',p_taxintention='" + intentionValue + "',p_intention='" + iIntentn + "')/Results";                                                                                                                         
			oReconServiceModel.read(sBindingPath, {                                                                                                                                                                                                                     
				filters: [oFilters],                                                                                                                                                                                                                                       
				method: "GET",                                                                                                                                                                                                                                             
				success: function (oData) {                                                                                                                                                                                                                                
					let oReconModel = new JSONModel(oData.results);                                                                                                                                                                                                           
					that.setModel(oReconModel, "oReconModel");                                                                                                                                                                                                                
                                                                                                                                                                                                                                                               
				},                                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                               
				error: function (oError) {                                                                                                                                                                                                                                 
					MessageBox.error(that.getI18nText("errorFetchingRecon"));                                                                                                                                                                                                 
                                                                                                                                                                                                                                                               
				}                                                                                                                                                                                                                                                          
			});                                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                               
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		//fetch hier data- function call 1                                                                                                                                                                                                                           
		_fetchTreeData: function () {                                                                                                                                                                                                                                
			let oServiceModel = this.getOwnerComponent().getModel("oManageHierModel"),                                                                                                                                                                                  
				that = this,                                                                                                                                                                                                                                               
				oView = this.getView(),                                                                                                                                                                                                                                    
				sHierId = oView.byId("idHierCatTextInpt").getSelectedKey(),                                                                                                                                                                                                
				sHierType = oView.byId("idHierType").getSelectedKey(),                                                                                                                                                                                                     
                                                                                                                                                                                                                                                               
				oFilters = new Filter({                                                                                                                                                                                                                                    
					filters: [new Filter("HierarchyCategory", FilterOperator.EQ, sHierType),                                                                                                                                                                                  
						new Filter("HierarchyId", FilterOperator.EQ, sHierId)                                                                                                                                                                                                    
					],                                                                                                                                                                                                                                                        
					and: true                                                                                                                                                                                                                                                 
				});                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                               
			//call to get only the  version ID for a particular hier id falling under a hier type                                                                                                                                                                       
			oServiceModel.read("/HierarchyVersionSet", {                                                                                                                                                                                                                
				filters: [oFilters],                                                                                                                                                                                                                                       
				method: "GET",                                                                                                                                                                                                                                             
				success: function (oData) {                                                                                                                                                                                                                                
					that._fetchInitialHierarchy(oData.results[0].VersionId);                                                                                                                                                                                                  
				},                                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                               
				error: function (oError) {                                                                                                                                                                                                                                 
					MessageBox.error(that.getI18nText("errorFetchingHierData"));                                                                                                                                                                                              
                                                                                                                                                                                                                                                               
				}                                                                                                                                                                                                                                                          
			});                                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                               
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		//fetch root node and its main childs that is till level 1 using version id and initialize amount fields&nbsp;                                                                                                                                               
		_fetchInitialHierarchy: function (sVersionId) {                                                                                                                                                                                                              
			let oServiceModel = this.getOwnerComponent().getModel("oManageHierModel"),                                                                                                                                                                                  
				oFilter = new Filter("NodeLevel", FilterOperator.LE, 1),                                                                                                                                                                                                   
				sKey = this.getView().byId("idHierType").getSelectedKey(),                                                                                                                                                                                                 
				that = this;                                                                                                                                                                                                                                               
			oServiceModel.read("/HierarchyVersionSet('" + sVersionId + "')/Nodes", {                                                                                                                                                                                    
				filters: [oFilter],                                                                                                                                                                                                                                        
				method: "GET",                                                                                                                                                                                                                                             
				success: async function (oData) {                                                                                                                                                                                                                          
					for (let i = 0; i < oData.results.length; i++) {                                                                                                                                                                                                          
						oData.results[i].Covered = '';                                                                                                                                                                                                                           
						oData.results[i].GaapOpeningBalance = 0;                                                                                                                                                                                                                 
						oData.results[i].GaapYearBalance = 0;                                                                                                                                                                                                                    
						oData.results[i].GaapCTA = 0;                                                                                                                                                                                                                            
						oData.results[i].GaapClosingBalance = 0;                                                                                                                                                                                                                 
						oData.results[i].GaapToStatPL = 0;                                                                                                                                                                                                                       
						oData.results[i].GaapToStatPmnt = 0;                                                                                                                                                                                                                     
						oData.results[i].GaapToStatEQ = 0;                                                                                                                                                                                                                       
						oData.results[i].GaapToStatOtherPL = 0;                                                                                                                                                                                                                  
						oData.results[i].GaapToStatOtherPmnt = 0;                                                                                                                                                                                                                
						oData.results[i].GaapToStatOtherEQ = 0;                                                                                                                                                                                                                  
						oData.results[i].G2SCTA = 0;                                                                                                                                                                                                                             
						oData.results[i].StatOpeningBalance = 0;                                                                                                                                                                                                                 
						oData.results[i].StatPYA = 0;                                                                                                                                                                                                                            
						oData.results[i].StatYearBalance = 0;                                                                                                                                                                                                                    
						oData.results[i].StatCTA = 0;                                                                                                                                                                                                                            
						oData.results[i].StatClosingBalance = 0;                                                                                                                                                                                                                 
						oData.results[i].StatToTaxPL = 0;                                                                                                                                                                                                                        
						oData.results[i].StatToTaxPmnt = 0;                                                                                                                                                                                                                      
						oData.results[i].StatToTaxEQ = 0;                                                                                                                                                                                                                        
						oData.results[i].StatToTaxOtherPL = 0;                                                                                                                                                                                                                   
						oData.results[i].StatToTaxOtherPmnt = 0;                                                                                                                                                                                                                 
						oData.results[i].StatToTaxOtherEQ = 0;                                                                                                                                                                                                                   
						oData.results[i].S2TCTA = 0;                                                                                                                                                                                                                             
						oData.results[i].TaxOpeningBalance = 0;                                                                                                                                                                                                                  
						oData.results[i].TaxPYA = 0;                                                                                                                                                                                                                             
						oData.results[i].TaxYearBalance = 0;                                                                                                                                                                                                                     
						oData.results[i].TaxCTA = 0;                                                                                                                                                                                                                             
						oData.results[i].TaxClosingBalance = 0;                                                                                                                                                                                                                  
						oData.results[i].TaxPTA = 0;                                                                                                                                                                                                                             
						oData.results[i].MainCurrency = '';                                                                                                                                                                                                                      
						aGlblArr.push(oData.results[i]);                                                                                                                                                                                                                         
						if (oData.results[i].NodeParentId) {                                                                                                                                                                                                                     
							//pause the execution at this line of code till 1st element of the loop is fully resolved and so on....                                                                                                                                                 
							await that.__recCallHierarchy(oData.results[i].NodeId, oServiceModel, that, sVersionId);                                                                                                                                                                
						}                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                               
					}                                                                                                                                                                                                                                                         
					if (sKey === 'CS15') {                                                                                                                                                                                                                                    
						that._calculateAmountFSItem(aGlblArr);                                                                                                                                                                                                                   
					} else {                                                                                                                                                                                                                                                  
						that._calculateAmountGLAcc(aGlblArr);                                                                                                                                                                                                                    
					}                                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                               
					that.getView().byId("idTreeHierFSItem").setBusy(false);                                                                                                                                                                                                   
					that.getView().byId("idTreeHierGLAcc").setBusy(false);                                                                                                                                                                                                    
                                                                                                                                                                                                                                                               
				},                                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                               
				error: function (oError) {                                                                                                                                                                                                                                 
					MessageBox.error(that.getI18nText("errorFetchingHierData"));                                                                                                                                                                                              
                                                                                                                                                                                                                                                               
				}                                                                                                                                                                                                                                                          
			});                                                                                                                                                                                                                                                         
		},                                                                                                                                                                                                                                                           
		//recursive function being called to get data for hierarchy until prev data is fully expanded and resolved                                                                                                                                                   
		__recCallHierarchy: function (sNodeId, oServiceModel, oController, sVersionId) {                                                                                                                                                                             
                                                                                                                                                                                                                                                               
			return new Promise(function (resolve, reject) {                                                                                                                                                                                                             
				//debugger;                                                                                                                                                                                                                                                
				let oFilter = new Filter("NodeParentId", FilterOperator.EQ, sNodeId),                                                                                                                                                                                      
					that = oController,                                                                                                                                                                                                                                       
					sVer = sVersionId;                                                                                                                                                                                                                                        
				oServiceModel.read("/HierarchyVersionSet('" + sVer + "')/Nodes", {                                                                                                                                                                                         
					filters: [oFilter],                                                                                                                                                                                                                                       
					method: "GET",                                                                                                                                                                                                                                            
					success: async function (oData) {                                                                                                                                                                                                                         
						//sort the data so that collapsed nodes are always processed first..if leaf processed first then it will be resolved early                                                                                                                               
						oData.results.sort(function (a, b) {                                                                                                                                                                                                                     
							var textA = a.DrillState.toUpperCase();                                                                                                                                                                                                                 
							var textB = b.DrillState.toUpperCase();                                                                                                                                                                                                                 
							return (textA < textB) ? -1 : (textA > textB) ? 1 : 0;                                                                                                                                                                                                  
						});                                                                                                                                                                                                                                                      
                                                                                                                                                                                                                                                               
						if (oData.results.length === 0) {                                                                                                                                                                                                                        
							resolve(oData);                                                                                                                                                                                                                                         
						}                                                                                                                                                                                                                                                        
						for (let i = 0; i < oData.results.length; i++) {                                                                                                                                                                                                         
							oData.results[i].Covered = '';                                                                                                                                                                                                                          
							oData.results[i].GaapOpeningBalance = 0;                                                                                                                                                                                                                
							oData.results[i].GaapYearBalance = 0;                                                                                                                                                                                                                   
							oData.results[i].GaapCTA = 0;                                                                                                                                                                                                                           
							oData.results[i].GaapClosingBalance = 0;                                                                                                                                                                                                                
							oData.results[i].GaapToStatPL = 0;                                                                                                                                                                                                                      
							oData.results[i].GaapToStatPmnt = 0;                                                                                                                                                                                                                    
							oData.results[i].GaapToStatEQ = 0;                                                                                                                                                                                                                      
							oData.results[i].GaapToStatOtherPL = 0;                                                                                                                                                                                                                 
							oData.results[i].GaapToStatOtherPmnt = 0;                                                                                                                                                                                                               
							oData.results[i].GaapToStatOtherEQ = 0;                                                                                                                                                                                                                 
							oData.results[i].G2SCTA = 0;                                                                                                                                                                                                                            
							oData.results[i].StatOpeningBalance = 0;                                                                                                                                                                                                                
							oData.results[i].StatPYA = 0;                                                                                                                                                                                                                           
							oData.results[i].StatYearBalance = 0;                                                                                                                                                                                                                   
							oData.results[i].StatCTA = 0;                                                                                                                                                                                                                           
							oData.results[i].StatClosingBalance = 0;                                                                                                                                                                                                                
							oData.results[i].StatToTaxPL = 0;                                                                                                                                                                                                                       
							oData.results[i].StatToTaxPmnt = 0;                                                                                                                                                                                                                     
							oData.results[i].StatToTaxEQ = 0;                                                                                                                                                                                                                       
							oData.results[i].StatToTaxOtherPL = 0;                                                                                                                                                                                                                  
							oData.results[i].StatToTaxOtherPmnt = 0;                                                                                                                                                                                                                
							oData.results[i].StatToTaxOtherEQ = 0;                                                                                                                                                                                                                  
							oData.results[i].S2TCTA = 0;                                                                                                                                                                                                                            
							oData.results[i].TaxOpeningBalance = 0;                                                                                                                                                                                                                 
							oData.results[i].TaxPYA = 0;                                                                                                                                                                                                                            
							oData.results[i].TaxYearBalance = 0;                                                                                                                                                                                                                    
							oData.results[i].TaxCTA = 0;                                                                                                                                                                                                                            
							oData.results[i].TaxClosingBalance = 0;                                                                                                                                                                                                                 
							oData.results[i].TaxPTA = 0;                                                                                                                                                                                                                            
							oData.results[i].MainCurrency = '';                                                                                                                                                                                                                     
							aGlblArr.push(oData.results[i]);                                                                                                                                                                                                                        
							if (oData.results[i].DrillState !== "leaf") {                                                                                                                                                                                                           
								await that.__recCallHierarchy(oData.results[i].NodeId, oServiceModel, that, sVer);                                                                                                                                                                     
								//for TESTN type scenario as promise resolves early without covering all siblings                                                                                                                                                                      
								//if both are collapsed then check if both of them are covered.                                                                                                                                                                                        
								if (oData.results.length === (i + 1)) {                                                                                                                                                                                                                
									resolve(oData);                                                                                                                                                                                                                                       
								}                                                                                                                                                                                                                                                      
							} else {                                                                                                                                                                                                                                                
								resolve(oData);                                                                                                                                                                                                                                        
							}                                                                                                                                                                                                                                                       
                                                                                                                                                                                                                                                               
						}                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                               
					},                                                                                                                                                                                                                                                        
					error: function (oError) {                                                                                                                                                                                                                                
						MessageBox.error(that.getI18nText("errorFetchingHierData"));                                                                                                                                                                                             
						reject(oError)                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
					}                                                                                                                                                                                                                                                         
				});                                                                                                                                                                                                                                                        
			});                                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                               
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		//adding and calculating amount field for all the data for which hierarchy needs to be shown for fs item.                                                                                                                                                    
		_calculateAmountFSItem: function (data) {                                                                                                                                                                                                                    
			let that = this,                                                                                                                                                                                                                                            
				oTable = this.getView().byId("idTreeHierFSItem"),                                                                                                                                                                                                          
				fsitemData = data.filter(node => node.NodeEntity === 'FINCS_FSITEM'),                                                                                                                                                                                      
				reconData = this.getView().getModel("oReconModel").getData();                                                                                                                                                                                              
                                                                                                                                                                                                                                                               
			//oTable.setVisibleRowCount(data.length);                                                                                                                                                                                                                   
                                                                                                                                                                                                                                                               
			if (fsitemData.length === 0) {                                                                                                                                                                                                                              
				for (var i = 0; i < data.length; i++) { // covers all the nodes in case there is no FS Item                                                                                                                                                                
					data[i].Covered = 'X';                                                                                                                                                                                                                                    
				}                                                                                                                                                                                                                                                          
				MessageBox.warning(that.getI18nText("warningFetchingFSItem"));                                                                                                                                                                                             
			}                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
			//adding and calculating amount for each FS item                                                                                                                                                                                                            
			for (let i = 0; i < fsitemData.length; i++) {                                                                                                                                                                                                               
				//above fs item can be present more than once in the below recon data                                                                                                                                                                                      
				for (let j = 0; j < reconData.length; j++) {                                                                                                                                                                                                               
					if (fsitemData[i].NodeLowValue === reconData[j].FinancialStatementItem) {                                                                                                                                                                                 
						fsitemData[i].GaapOpeningBalance = fsitemData[i].GaapOpeningBalance + parseFloat(reconData[j].GaapOpeningBalance, [10]);                                                                                                                                 
						fsitemData[i].GaapYearBalance = fsitemData[i].GaapYearBalance + parseFloat(reconData[j].GaapYearBalance, [10]);                                                                                                                                          
						fsitemData[i].GaapCTA = fsitemData[i].GaapClosingBalance + parseFloat(reconData[j].GaapCTA, [10]);                                                                                                                                                       
						fsitemData[i].GaapClosingBalance = fsitemData[i].GaapClosingBalance + parseFloat(reconData[j].GaapClosingBalance, [10]);                                                                                                                                 
						fsitemData[i].GaapToStatPL = fsitemData[i].GaapToStatPL + parseFloat(reconData[j].GaapToStatPL, [10]);                                                                                                                                                   
						fsitemData[i].GaapToStatPmnt = fsitemData[i].GaapToStatPmnt + parseFloat(reconData[j].GaapToStatPmnt, [10]);                                                                                                                                             
						fsitemData[i].GaapToStatEQ = fsitemData[i].GaapToStatEQ + parseFloat(reconData[j].GaapToStatEQ, [10]);                                                                                                                                                   
						fsitemData[i].GaapToStatOtherPL = fsitemData[i].GaapToStatOtherPL + parseFloat(reconData[j].GaapToStatOtherPL, [10]);                                                                                                                                    
						fsitemData[i].GaapToStatOtherPmnt = fsitemData[i].GaapToStatOtherPmnt + parseFloat(reconData[j].GaapToStatOtherPmnt, [10]);                                                                                                                              
						fsitemData[i].GaapToStatOtherEQ = fsitemData[i].GaapToStatOtherEQ + parseFloat(reconData[j].GaapToStatOtherEQ, [10]);                                                                                                                                    
						fsitemData[i].G2SCTA = fsitemData[i].G2SCTA + parseFloat(reconData[j].G2SCTA, [10]);                                                                                                                                                                     
						fsitemData[i].StatOpeningBalance = fsitemData[i].StatOpeningBalance + parseFloat(reconData[j].StatOpeningBalance, [10]);                                                                                                                                 
						fsitemData[i].StatPYA = fsitemData[i].StatPYA + parseFloat(reconData[j].StatPYA, [10]);                                                                                                                                                                  
						fsitemData[i].StatYearBalance = fsitemData[i].StatYearBalance + parseFloat(reconData[j].StatYearBalance, [10]);                                                                                                                                          
						fsitemData[i].StatCTA = fsitemData[i].StatCTA + parseFloat(reconData[j].StatCTA, [10]);                                                                                                                                                                  
						fsitemData[i].StatClosingBalance = fsitemData[i].StatClosingBalance + parseFloat(reconData[j].StatClosingBalance, [10]);                                                                                                                                 
						fsitemData[i].StatToTaxPL = fsitemData[i].StatToTaxPL + parseFloat(reconData[j].StatToTaxPL, [10]);                                                                                                                                                      
						fsitemData[i].StatToTaxPmnt = fsitemData[i].StatToTaxPmnt + parseFloat(reconData[j].StatToTaxPmnt, [10]);                                                                                                                                                
						fsitemData[i].StatToTaxEQ = fsitemData[i].StatToTaxEQ + parseFloat(reconData[j].StatToTaxEQ, [10]);                                                                                                                                                      
						fsitemData[i].StatToTaxOtherPL = fsitemData[i].StatToTaxOtherPL + parseFloat(reconData[j].StatToTaxOtherPL, [10]);                                                                                                                                       
						fsitemData[i].StatToTaxOtherPmnt = fsitemData[i].StatToTaxOtherPmnt + parseFloat(reconData[j].StatToTaxOtherPmnt, [10]);                                                                                                                                 
						fsitemData[i].StatToTaxOtherEQ = fsitemData[i].StatToTaxOtherEQ + parseFloat(reconData[j].StatToTaxOtherEQ, [10]);                                                                                                                                       
						fsitemData[i].S2TCTA = fsitemData[i].S2TCTA + parseFloat(reconData[j].S2TCTA, [10]);                                                                                                                                                                     
						fsitemData[i].TaxOpeningBalance = fsitemData[i].TaxOpeningBalance + parseFloat(reconData[j].TaxOpeningBalance, [10]);                                                                                                                                    
						fsitemData[i].TaxPYA = fsitemData[i].TaxPYA + parseFloat(reconData[j].TaxPYA, [10]);                                                                                                                                                                     
						fsitemData[i].TaxYearBalance = fsitemData[i].TaxYearBalance + parseFloat(reconData[j].TaxYearBalance, [10]);                                                                                                                                             
						fsitemData[i].TaxCTA = fsitemData[i].TaxCTA + parseFloat(reconData[j].TaxCTA, [10]);                                                                                                                                                                     
						fsitemData[i].TaxClosingBalance = fsitemData[i].TaxClosingBalance + parseFloat(reconData[j].TaxClosingBalance, [10]);                                                                                                                                    
						fsitemData[i].TaxPTA = fsitemData[i].TaxPTA + parseFloat(reconData[j].TaxPTA, [10]);                                                                                                                                                                     
						fsitemData[i].MainCurrency = reconData[j].MainCurrency;                                                                                                                                                                                                  
                                                                                                                                                                                                                                                               
					}                                                                                                                                                                                                                                                         
				}                                                                                                                                                                                                                                                          
			}                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
			//covering all the FS items                                                                                                                                                                                                                                 
			for (let i = 0; i < fsitemData.length; i++) {                                                                                                                                                                                                               
				for (let j = 0; j < data.length; j++) {                                                                                                                                                                                                                    
					if (fsitemData[i].NodeParentId === data[j].NodeId) {                                                                                                                                                                                                      
						fsitemData[i].Covered = 'X';                                                                                                                                                                                                                             
						data[j].GaapOpeningBalance = fsitemData[i].GaapOpeningBalance + data[j].GaapOpeningBalance;                                                                                                                                                              
						data[j].GaapYearBalance = fsitemData[i].GaapYearBalance + data[j].GaapYearBalance;                                                                                                                                                                       
						data[j].GaapCTA = fsitemData[i].GaapCTA + data[j].GaapCTA;                                                                                                                                                                                               
						data[j].GaapClosingBalance = fsitemData[i].GaapClosingBalance + data[j].GaapClosingBalance;                                                                                                                                                              
						data[j].GaapToStatPL = fsitemData[i].GaapToStatPL + data[j].GaapToStatPL;                                                                                                                                                                                
						data[j].GaapToStatPmnt = fsitemData[i].GaapToStatPmnt + data[j].GaapToStatPmnt;                                                                                                                                                                          
						data[j].GaapToStatEQ = fsitemData[i].GaapToStatEQ + data[j].GaapToStatEQ;                                                                                                                                                                                
						data[j].GaapToStatOtherPL = fsitemData[i].GaapToStatOtherPL + data[j].GaapToStatOtherPL;                                                                                                                                                                 
						data[j].GaapToStatOtherPmnt = fsitemData[i].GaapToStatOtherPmnt + data[j].GaapToStatOtherPmnt;                                                                                                                                                           
						data[j].GaapToStatOtherEQ = fsitemData[i].GaapToStatOtherEQ + data[j].GaapToStatOtherEQ;                                                                                                                                                                 
						data[j].G2SCTA = fsitemData[i].G2SCTA + data[j].G2SCTA;                                                                                                                                                                                                  
						data[j].StatOpeningBalance = fsitemData[i].StatOpeningBalance + data[j].StatOpeningBalance;                                                                                                                                                              
						data[j].StatPYA = fsitemData[i].StatPYA + data[j].StatPYA;                                                                                                                                                                                               
						data[j].StatYearBalance = fsitemData[i].StatYearBalance + data[j].StatYearBalance;                                                                                                                                                                       
						data[j].StatCTA = fsitemData[i].StatCTA + data[j].StatCTA;                                                                                                                                                                                               
						data[j].StatClosingBalance = fsitemData[i].StatClosingBalance + data[j].StatClosingBalance;                                                                                                                                                              
						data[j].StatToTaxPL = fsitemData[i].StatToTaxPL + data[j].StatToTaxPL;                                                                                                                                                                                   
						data[j].StatToTaxPmnt = fsitemData[i].StatToTaxPmnt + data[j].StatToTaxPmnt;                                                                                                                                                                             
						data[j].StatToTaxEQ = fsitemData[i].StatToTaxEQ + data[j].StatToTaxEQ;                                                                                                                                                                                   
						data[j].StatToTaxOtherPL = fsitemData[i].StatToTaxOtherPL + data[j].StatToTaxOtherPL;                                                                                                                                                                    
						data[j].StatToTaxOtherPmnt = fsitemData[i].StatToTaxOtherPmnt + data[j].StatToTaxOtherPmnt;                                                                                                                                                              
						data[j].StatToTaxOtherEQ = fsitemData[i].StatToTaxOtherEQ + data[j].StatToTaxOtherEQ;                                                                                                                                                                    
						data[j].S2TCTA = fsitemData[i].S2TCTA + data[j].S2TCTA;                                                                                                                                                                                                  
						data[j].TaxOpeningBalance = fsitemData[i].TaxOpeningBalance + data[j].TaxOpeningBalance;                                                                                                                                                                 
						data[j].TaxPYA = fsitemData[i].TaxPYA + data[j].TaxPYA;                                                                                                                                                                                                  
						data[j].TaxYearBalance = fsitemData[i].TaxYearBalance + data[j].TaxYearBalance;                                                                                                                                                                          
						data[j].TaxCTA = fsitemData[i].TaxCTA + data[j].TaxCTA;                                                                                                                                                                                                  
						data[j].TaxClosingBalance = fsitemData[i].TaxClosingBalance + data[j].TaxClosingBalance;                                                                                                                                                                 
						data[j].TaxPTA = fsitemData[i].TaxPTA + data[j].TaxPTA;                                                                                                                                                                                                  
						data[j].MainCurrency = fsitemData[i].MainCurrency;                                                                                                                                                                                                       
                                                                                                                                                                                                                                                               
						//if a parent has direct child as fsitem and also a normal child which is not an fs item then that  parent cannot be covered unless and until non fsitem child is covered                                                                                
						let nonFSChildData = data.filter(item => item.NodeParentId === data[j].NodeId && item.NodeEntity !== 'FINCS_FSITEM');                                                                                                                                    
                                                                                                                                                                                                                                                               
						if (nonFSChildData.length === 0) {                                                                                                                                                                                                                       
							data[j].Covered = 'X';                                                                                                                                                                                                                                  
						}                                                                                                                                                                                                                                                        
					}                                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                               
					//if a node is not an FS item and also it does not have any children then cover it as it will not get covered anytime as it does nt have any child                                                                                                        
                                                                                                                                                                                                                                                               
					if (data[j].Covered === '' && data[j].NodeEntity !== 'FINCS_FSITEM') {                                                                                                                                                                                    
						let noFSItemData = data.filter(item => item.NodeParentId === data[j].NodeId);                                                                                                                                                                            
						if (noFSItemData.length === 0) {                                                                                                                                                                                                                         
							data[j].Covered = 'X';                                                                                                                                                                                                                                  
						}                                                                                                                                                                                                                                                        
					}                                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                               
				}                                                                                                                                                                                                                                                          
			}                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
			var nodeCoveredData = [];                                                                                                                                                                                                                                   
			var nodeNotCoveredData = [];                                                                                                                                                                                                                                
			nodeCoveredData = data.filter(node => node.Covered === 'X' && node.NodeEntity !== 'FINCS_FSITEM');                                                                                                                                                          
			nodeNotCoveredData = data.filter(node => node.Covered === '' && node.NodeEntity !== 'FINCS_FSITEM');                                                                                                                                                        
			//covering the remaining uncovered data until all get covered&nbsp;                                                                                                                                                                                         
			while (nodeNotCoveredData.length > 0) {                                                                                                                                                                                                                     
				for (let i = 0; i < nodeCoveredData.length; i++) {                                                                                                                                                                                                         
					for (let j = 0; j < nodeNotCoveredData.length; j++) {                                                                                                                                                                                                     
						if (nodeNotCoveredData[j].NodeId === nodeCoveredData[i].NodeParentId) {                                                                                                                                                                                  
							let parent = nodeNotCoveredData[j];                                                                                                                                                                                                                     
                                                                                                                                                                                                                                                               
							if (nodeNotCoveredData.filter(item => item.NodeParentId === parent.NodeId).length === 0)                                                                                                                                                                
                                                                                                                                                                                                                                                               
							{                                                                                                                                                                                                                                                       
								parent.GaapOpeningBalance = parent.GaapOpeningBalance + nodeCoveredData[i].GaapOpeningBalance;                                                                                                                                                         
								parent.GaapYearBalance = parent.GaapYearBalance + nodeCoveredData[i].GaapYearBalance;                                                                                                                                                                  
								parent.GaapCTA = parent.GaapCTA + nodeCoveredData[i].GaapCTA;                                                                                                                                                                                          
								parent.GaapClosingBalance = parent.GaapClosingBalance + nodeCoveredData[i].GaapClosingBalance;                                                                                                                                                         
								parent.GaapToStatPL = parent.GaapToStatPL + nodeCoveredData[i].GaapToStatPL;                                                                                                                                                                           
								parent.GaapToStatPmnt = parent.GaapToStatPmnt + nodeCoveredData[i].GaapToStatPmnt;                                                                                                                                                                     
								parent.GaapToStatEQ = parent.GaapToStatEQ + nodeCoveredData[i].GaapToStatEQ;                                                                                                                                                                           
								parent.GaapToStatOtherPL = parent.GaapToStatOtherPL + nodeCoveredData[i].GaapToStatOtherPL;                                                                                                                                                            
								parent.GaapToStatOtherPmnt = parent.GaapToStatOtherPmnt + nodeCoveredData[i].GaapToStatOtherPmnt;                                                                                                                                                      
								parent.GaapToStatOtherEQ = parent.GaapToStatOtherEQ + nodeCoveredData[i].GaapToStatOtherEQ;                                                                                                                                                            
								parent.G2SCTA = nodeCoveredData[i].G2SCTA + parent.G2SCTA;                                                                                                                                                                                             
								parent.StatOpeningBalance = nodeCoveredData[i].StatOpeningBalance + parent.StatOpeningBalance;                                                                                                                                                         
								parent.StatPYA = nodeCoveredData[i].StatPYA + parent.StatPYA;                                                                                                                                                                                          
								parent.StatYearBalance = nodeCoveredData[i].StatYearBalance + parent.StatYearBalance;                                                                                                                                                                  
								parent.StatCTA = nodeCoveredData[i].StatCTA + parent.StatCTA;                                                                                                                                                                                          
								parent.StatClosingBalance = nodeCoveredData[i].StatClosingBalance + parent.StatClosingBalance;                                                                                                                                                         
								parent.StatToTaxPL = nodeCoveredData[i].StatToTaxPL + parent.StatToTaxPL;                                                                                                                                                                              
								parent.StatToTaxPmnt = nodeCoveredData[i].StatToTaxPmnt + parent.StatToTaxPmnt;                                                                                                                                                                        
								parent.StatToTaxEQ = nodeCoveredData[i].StatToTaxEQ + parent.StatToTaxEQ;                                                                                                                                                                              
								parent.StatToTaxOtherPL = nodeCoveredData[i].StatToTaxOtherPL + parent.StatToTaxOtherPL;                                                                                                                                                               
								parent.StatToTaxOtherPmnt = nodeCoveredData[i].StatToTaxOtherPmnt + parent.StatToTaxOtherPmnt;                                                                                                                                                         
								parent.StatToTaxOtherEQ = nodeCoveredData[i].StatToTaxOtherEQ + parent.StatToTaxOtherEQ;                                                                                                                                                               
								parent.S2TCTA = nodeCoveredData[i].S2TCTA + parent.S2TCTA;                                                                                                                                                                                             
								parent.TaxOpeningBalance = nodeCoveredData[i].TaxOpeningBalance + parent.TaxOpeningBalance;                                                                                                                                                            
								parent.TaxPYA = nodeCoveredData[i].TaxPYA + parent.TaxPYA;                                                                                                                                                                                             
								parent.TaxYearBalance = nodeCoveredData[i].TaxYearBalance + parent.TaxYearBalance;                                                                                                                                                                     
								parent.TaxCTA = nodeCoveredData[i].TaxCTA + parent.TaxCTA;                                                                                                                                                                                             
								parent.TaxClosingBalance = nodeCoveredData[i].TaxClosingBalance + parent.TaxClosingBalance;                                                                                                                                                            
								parent.TaxPTA = nodeCoveredData[i].TaxPTA + parent.TaxPTA;                                                                                                                                                                                             
								parent.Covered = 'X';                                                                                                                                                                                                                                  
								parent.MainCurrency = nodeCoveredData[i].MainCurrency;                                                                                                                                                                                                 
							}                                                                                                                                                                                                                                                       
						}                                                                                                                                                                                                                                                        
					}                                                                                                                                                                                                                                                         
				}                                                                                                                                                                                                                                                          
				nodeNotCoveredData = data.filter(node => node.Covered === '' && node.NodeEntity !== 'FINCS_FSITEM');                                                                                                                                                       
				nodeCoveredData = data.filter(node => node.Covered === 'X' && node.NodeEntity !== 'FINCS_FSITEM')                                                                                                                                                          
                                                                                                                                                                                                                                                               
			}                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
			for (var i = 0; i < data.length; i++) { // add childs to every item                                                                                                                                                                                         
				data[i].childs = [];                                                                                                                                                                                                                                       
			}                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
			let tree = this._buildTree(data);                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
			var dHierData = {                                                                                                                                                                                                                                           
				"childs": tree                                                                                                                                                                                                                                             
			}                                                                                                                                                                                                                                                           
			this.getView().getModel("HierDatModel").setData([]);                                                                                                                                                                                                        
			this.getView().getModel("HierDatModel").setData(dHierData);                                                                                                                                                                                                 
			this.getBusyDialog().open();                                                                                                                                                                                                                                
			//adjust table column width                                                                                                                                                                                                                                 
			var oIntervalCall = window.setInterval(function () {                                                                                                                                                                                                        
				this.onAdjustTableCol(oTable);                                                                                                                                                                                                                             
				window.clearInterval(oIntervalCall);                                                                                                                                                                                                                       
			}.bind(this), 1000);                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                               
		},                                                                                                                                                                                                                                                           
		//adding and calculating amount field for all the data for which hierarchy needs to be shown for gl account.                                                                                                                                                 
		_calculateAmountGLAcc: function (data) {                                                                                                                                                                                                                     
			let that = this,                                                                                                                                                                                                                                            
				oTable = this.getView().byId("idTreeHierGLAcc"),                                                                                                                                                                                                           
				glAccData = data.filter(node => node.NodeEntity === 'GLACCOUNT'),                                                                                                                                                                                          
				reconData = this.getView().getModel("oReconModel").getData();                                                                                                                                                                                              
                                                                                                                                                                                                                                                               
			if (glAccData.length === 0) {                                                                                                                                                                                                                               
				for (var i = 0; i < data.length; i++) { // covers all the nodes in case there is no Gl Account                                                                                                                                                             
					data[i].Covered = 'X';                                                                                                                                                                                                                                    
				}                                                                                                                                                                                                                                                          
				MessageBox.warning(that.getI18nText("warningFetchingGLAcc"));                                                                                                                                                                                              
			}                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
			//adding and calculating amount for each GL Account                                                                                                                                                                                                         
			for (let i = 0; i < glAccData.length; i++) {                                                                                                                                                                                                                
				//above fs item can be present more than once in the below recon data                                                                                                                                                                                      
				for (let j = 0; j < reconData.length; j++) {                                                                                                                                                                                                               
					if (glAccData[i].NodeLowValue === reconData[j].GLAccount) {                                                                                                                                                                                               
						glAccData[i].GaapOpeningBalance = glAccData[i].GaapOpeningBalance + parseFloat(reconData[j].GaapOpeningBalance, [10]);                                                                                                                                   
						glAccData[i].GaapYearBalance = glAccData[i].GaapYearBalance + parseFloat(reconData[j].GaapYearBalance, [10]);                                                                                                                                            
						glAccData[i].GaapCTA = glAccData[i].GaapClosingBalance + parseFloat(reconData[j].GaapCTA, [10]);                                                                                                                                                         
						glAccData[i].GaapClosingBalance = glAccData[i].GaapClosingBalance + parseFloat(reconData[j].GaapClosingBalance, [10]);                                                                                                                                   
						glAccData[i].GaapToStatPL = glAccData[i].GaapToStatPL + parseFloat(reconData[j].GaapToStatPL, [10]);                                                                                                                                                     
						glAccData[i].GaapToStatPmnt = glAccData[i].GaapToStatPmnt + parseFloat(reconData[j].GaapToStatPmnt, [10]);                                                                                                                                               
						glAccData[i].GaapToStatEQ = glAccData[i].GaapToStatEQ + parseFloat(reconData[j].GaapToStatEQ, [10]);                                                                                                                                                     
						glAccData[i].GaapToStatOtherPL = glAccData[i].GaapToStatOtherPL + parseFloat(reconData[j].GaapToStatOtherPL, [10]);                                                                                                                                      
						glAccData[i].GaapToStatOtherPmnt = glAccData[i].GaapToStatOtherPmnt + parseFloat(reconData[j].GaapToStatOtherPmnt, [10]);                                                                                                                                
						glAccData[i].GaapToStatOtherEQ = glAccData[i].GaapToStatOtherEQ + parseFloat(reconData[j].GaapToStatOtherEQ, [10]);                                                                                                                                      
						glAccData[i].G2SCTA = glAccData[i].G2SCTA + parseFloat(reconData[j].G2SCTA, [10]);                                                                                                                                                                       
						glAccData[i].StatOpeningBalance = glAccData[i].StatOpeningBalance + parseFloat(reconData[j].StatOpeningBalance, [10]);                                                                                                                                   
						glAccData[i].StatPYA = glAccData[i].StatPYA + parseFloat(reconData[j].StatPYA, [10]);                                                                                                                                                                    
						glAccData[i].StatYearBalance = glAccData[i].StatYearBalance + parseFloat(reconData[j].StatYearBalance, [10]);                                                                                                                                            
						glAccData[i].StatCTA = glAccData[i].StatCTA + parseFloat(reconData[j].StatCTA, [10]);                                                                                                                                                                    
						glAccData[i].StatClosingBalance = glAccData[i].StatClosingBalance + parseFloat(reconData[j].StatClosingBalance, [10]);                                                                                                                                   
						glAccData[i].StatToTaxPL = glAccData[i].StatToTaxPL + parseFloat(reconData[j].StatToTaxPL, [10]);                                                                                                                                                        
						glAccData[i].StatToTaxPmnt = glAccData[i].StatToTaxPmnt + parseFloat(reconData[j].StatToTaxPmnt, [10]);                                                                                                                                                  
						glAccData[i].StatToTaxEQ = glAccData[i].StatToTaxEQ + parseFloat(reconData[j].StatToTaxEQ, [10]);                                                                                                                                                        
						glAccData[i].StatToTaxOtherPL = glAccData[i].StatToTaxOtherPL + parseFloat(reconData[j].StatToTaxOtherPL, [10]);                                                                                                                                         
						glAccData[i].StatToTaxOtherPmnt = glAccData[i].StatToTaxOtherPmnt + parseFloat(reconData[j].StatToTaxOtherPmnt, [10]);                                                                                                                                   
						glAccData[i].StatToTaxOtherEQ = glAccData[i].StatToTaxOtherEQ + parseFloat(reconData[j].StatToTaxOtherEQ, [10]);                                                                                                                                         
						glAccData[i].S2TCTA = glAccData[i].S2TCTA + parseFloat(reconData[j].S2TCTA, [10]);                                                                                                                                                                       
						glAccData[i].TaxOpeningBalance = glAccData[i].TaxOpeningBalance + parseFloat(reconData[j].TaxOpeningBalance, [10]);                                                                                                                                      
						glAccData[i].TaxPYA = glAccData[i].TaxPYA + parseFloat(reconData[j].TaxPYA, [10]);                                                                                                                                                                       
						glAccData[i].TaxYearBalance = glAccData[i].TaxYearBalance + parseFloat(reconData[j].TaxYearBalance, [10]);                                                                                                                                               
						glAccData[i].TaxCTA = glAccData[i].TaxCTA + parseFloat(reconData[j].TaxCTA, [10]);                                                                                                                                                                       
						glAccData[i].TaxClosingBalance = glAccData[i].TaxClosingBalance + parseFloat(reconData[j].TaxClosingBalance, [10]);                                                                                                                                      
						glAccData[i].TaxPTA = glAccData[i].TaxPTA + parseFloat(reconData[j].TaxPTA, [10]);                                                                                                                                                                       
						glAccData[i].MainCurrency = reconData[j].MainCurrency;                                                                                                                                                                                                   
                                                                                                                                                                                                                                                               
					}                                                                                                                                                                                                                                                         
				}                                                                                                                                                                                                                                                          
			}                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
			//covering all the GL Accounts                                                                                                                                                                                                                              
			for (let i = 0; i < glAccData.length; i++) {                                                                                                                                                                                                                
				for (let j = 0; j < data.length; j++) {                                                                                                                                                                                                                    
					if (glAccData[i].NodeParentId === data[j].NodeId) {                                                                                                                                                                                                       
						glAccData[i].Covered = 'X';                                                                                                                                                                                                                              
						data[j].GaapOpeningBalance = glAccData[i].GaapOpeningBalance + data[j].GaapOpeningBalance;                                                                                                                                                               
						data[j].GaapYearBalance = glAccData[i].GaapYearBalance + data[j].GaapYearBalance;                                                                                                                                                                        
						data[j].GaapCTA = glAccData[i].GaapCTA + data[j].GaapCTA;                                                                                                                                                                                                
						data[j].GaapClosingBalance = glAccData[i].GaapClosingBalance + data[j].GaapClosingBalance;                                                                                                                                                               
						data[j].GaapToStatPL = glAccData[i].GaapToStatPL + data[j].GaapToStatPL;                                                                                                                                                                                 
						data[j].GaapToStatPmnt = glAccData[i].GaapToStatPmnt + data[j].GaapToStatPmnt;                                                                                                                                                                           
						data[j].GaapToStatEQ = glAccData[i].GaapToStatEQ + data[j].GaapToStatEQ;                                                                                                                                                                                 
						data[j].GaapToStatOtherPL = glAccData[i].GaapToStatOtherPL + data[j].GaapToStatOtherPL;                                                                                                                                                                  
						data[j].GaapToStatOtherPmnt = glAccData[i].GaapToStatOtherPmnt + data[j].GaapToStatOtherPmnt;                                                                                                                                                            
						data[j].GaapToStatOtherEQ = glAccData[i].GaapToStatOtherEQ + data[j].GaapToStatOtherEQ;                                                                                                                                                                  
						data[j].G2SCTA = glAccData[i].G2SCTA + data[j].G2SCTA;                                                                                                                                                                                                   
						data[j].StatOpeningBalance = glAccData[i].StatOpeningBalance + data[j].StatOpeningBalance;                                                                                                                                                               
						data[j].StatPYA = glAccData[i].StatPYA + data[j].StatPYA;                                                                                                                                                                                                
						data[j].StatYearBalance = glAccData[i].StatYearBalance + data[j].StatYearBalance;                                                                                                                                                                        
						data[j].StatCTA = glAccData[i].StatCTA + data[j].StatCTA;                                                                                                                                                                                                
						data[j].StatClosingBalance = glAccData[i].StatClosingBalance + data[j].StatClosingBalance;                                                                                                                                                               
						data[j].StatToTaxPL = glAccData[i].StatToTaxPL + data[j].StatToTaxPL;                                                                                                                                                                                    
						data[j].StatToTaxPmnt = glAccData[i].StatToTaxPmnt + data[j].StatToTaxPmnt;                                                                                                                                                                              
						data[j].StatToTaxEQ = glAccData[i].StatToTaxEQ + data[j].StatToTaxEQ;                                                                                                                                                                                    
						data[j].StatToTaxOtherPL = glAccData[i].StatToTaxOtherPL + data[j].StatToTaxOtherPL;                                                                                                                                                                     
						data[j].StatToTaxOtherPmnt = glAccData[i].StatToTaxOtherPmnt + data[j].StatToTaxOtherPmnt;                                                                                                                                                               
						data[j].StatToTaxOtherEQ = glAccData[i].StatToTaxOtherEQ + data[j].StatToTaxOtherEQ;                                                                                                                                                                     
						data[j].S2TCTA = glAccData[i].S2TCTA + data[j].S2TCTA;                                                                                                                                                                                                   
						data[j].TaxOpeningBalance = glAccData[i].TaxOpeningBalance + data[j].TaxOpeningBalance;                                                                                                                                                                  
						data[j].TaxPYA = glAccData[i].TaxPYA + data[j].TaxPYA;                                                                                                                                                                                                   
						data[j].TaxYearBalance = glAccData[i].TaxYearBalance + data[j].TaxYearBalance;                                                                                                                                                                           
						data[j].TaxCTA = glAccData[i].TaxCTA + data[j].TaxCTA;                                                                                                                                                                                                   
						data[j].TaxClosingBalance = glAccData[i].TaxClosingBalance + data[j].TaxClosingBalance;                                                                                                                                                                  
						data[j].TaxPTA = glAccData[i].TaxPTA + data[j].TaxPTA;                                                                                                                                                                                                   
						data[j].MainCurrency = glAccData[i].MainCurrency;                                                                                                                                                                                                        
                                                                                                                                                                                                                                                               
						//if a parent has direct child as fsitem and also a normal child which is not an fs item then that  parent cannot be covered unless and until non fsitem child is covered                                                                                
						let nonFSChildData = data.filter(item => item.NodeParentId === data[j].NodeId && item.NodeEntity !== 'GLACCOUNT');                                                                                                                                       
                                                                                                                                                                                                                                                               
						if (nonFSChildData.length === 0) {                                                                                                                                                                                                                       
							data[j].Covered = 'X';                                                                                                                                                                                                                                  
						}                                                                                                                                                                                                                                                        
					}                                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                               
					//if a node is not an FS item and also it does not have any children then cover it as it will not get covered anytime as it does nt have any child                                                                                                        
                                                                                                                                                                                                                                                               
					if (data[j].Covered === '' && data[j].NodeEntity !== 'GLACCOUNT') {                                                                                                                                                                                       
						let noglAccData = data.filter(item => item.NodeParentId === data[j].NodeId);                                                                                                                                                                             
						if (noglAccData.length === 0) {                                                                                                                                                                                                                          
							data[j].Covered = 'X';                                                                                                                                                                                                                                  
						}                                                                                                                                                                                                                                                        
					}                                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                               
				}                                                                                                                                                                                                                                                          
			}                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
			var nodeCoveredData = [];                                                                                                                                                                                                                                   
			var nodeNotCoveredData = [];                                                                                                                                                                                                                                
			nodeCoveredData = data.filter(node => node.Covered === 'X' && node.NodeEntity !== 'GLACCOUNT');                                                                                                                                                             
			nodeNotCoveredData = data.filter(node => node.Covered === '' && node.NodeEntity !== 'GLACCOUNT');                                                                                                                                                           
                                                                                                                                                                                                                                                               
			//covering the remaining uncovered data until all get covered&nbsp;                                                                                                                                                                                         
			while (nodeNotCoveredData.length > 0) {                                                                                                                                                                                                                     
				for (let i = 0; i < nodeCoveredData.length; i++) {                                                                                                                                                                                                         
					for (let j = 0; j < nodeNotCoveredData.length; j++) {                                                                                                                                                                                                     
						if (nodeNotCoveredData[j].NodeId === nodeCoveredData[i].NodeParentId) {                                                                                                                                                                                  
							let parent = nodeNotCoveredData[j];                                                                                                                                                                                                                     
                                                                                                                                                                                                                                                               
							if (nodeNotCoveredData.filter(item => item.NodeParentId === parent.NodeId).length === 0)                                                                                                                                                                
                                                                                                                                                                                                                                                               
							{                                                                                                                                                                                                                                                       
								parent.GaapOpeningBalance = parent.GaapOpeningBalance + nodeCoveredData[i].GaapOpeningBalance;                                                                                                                                                         
								parent.GaapYearBalance = parent.GaapYearBalance + nodeCoveredData[i].GaapYearBalance;                                                                                                                                                                  
								parent.GaapCTA = parent.GaapCTA + nodeCoveredData[i].GaapCTA;                                                                                                                                                                                          
								parent.GaapClosingBalance = parent.GaapClosingBalance + nodeCoveredData[i].GaapClosingBalance;                                                                                                                                                         
								parent.GaapToStatPL = parent.GaapToStatPL + nodeCoveredData[i].GaapToStatPL;                                                                                                                                                                           
								parent.GaapToStatPmnt = parent.GaapToStatPmnt + nodeCoveredData[i].GaapToStatPmnt;                                                                                                                                                                     
								parent.GaapToStatEQ = parent.GaapToStatEQ + nodeCoveredData[i].GaapToStatEQ;                                                                                                                                                                           
								parent.GaapToStatOtherPL = parent.GaapToStatOtherPL + nodeCoveredData[i].GaapToStatOtherPL;                                                                                                                                                            
								parent.GaapToStatOtherPmnt = parent.GaapToStatOtherPmnt + nodeCoveredData[i].GaapToStatOtherPmnt;                                                                                                                                                      
								parent.GaapToStatOtherEQ = parent.GaapToStatOtherEQ + nodeCoveredData[i].GaapToStatOtherEQ;                                                                                                                                                            
								parent.G2SCTA = nodeCoveredData[i].G2SCTA + parent.G2SCTA;                                                                                                                                                                                             
								parent.StatOpeningBalance = nodeCoveredData[i].StatOpeningBalance + parent.StatOpeningBalance;                                                                                                                                                         
								parent.StatPYA = nodeCoveredData[i].StatPYA + parent.StatPYA;                                                                                                                                                                                          
								parent.StatYearBalance = nodeCoveredData[i].StatYearBalance + parent.StatYearBalance;                                                                                                                                                                  
								parent.StatCTA = nodeCoveredData[i].StatCTA + parent.StatCTA;                                                                                                                                                                                          
								parent.StatClosingBalance = nodeCoveredData[i].StatClosingBalance + parent.StatClosingBalance;                                                                                                                                                         
								parent.StatToTaxPL = nodeCoveredData[i].StatToTaxPL + parent.StatToTaxPL;                                                                                                                                                                              
								parent.StatToTaxPmnt = nodeCoveredData[i].StatToTaxPmnt + parent.StatToTaxPmnt;                                                                                                                                                                        
								parent.StatToTaxEQ = nodeCoveredData[i].StatToTaxEQ + parent.StatToTaxEQ;                                                                                                                                                                              
								parent.StatToTaxOtherPL = nodeCoveredData[i].StatToTaxOtherPL + parent.StatToTaxOtherPL;                                                                                                                                                               
								parent.StatToTaxOtherPmnt = nodeCoveredData[i].StatToTaxOtherPmnt + parent.StatToTaxOtherPmnt;                                                                                                                                                         
								parent.StatToTaxOtherEQ = nodeCoveredData[i].StatToTaxOtherEQ + parent.StatToTaxOtherEQ;                                                                                                                                                               
								parent.S2TCTA = nodeCoveredData[i].S2TCTA + parent.S2TCTA;                                                                                                                                                                                             
								parent.TaxOpeningBalance = nodeCoveredData[i].TaxOpeningBalance + parent.TaxOpeningBalance;                                                                                                                                                            
								parent.TaxPYA = nodeCoveredData[i].TaxPYA + parent.TaxPYA;                                                                                                                                                                                             
								parent.TaxYearBalance = nodeCoveredData[i].TaxYearBalance + parent.TaxYearBalance;                                                                                                                                                                     
								parent.TaxCTA = nodeCoveredData[i].TaxCTA + parent.TaxCTA;                                                                                                                                                                                             
								parent.TaxClosingBalance = nodeCoveredData[i].TaxClosingBalance + parent.TaxClosingBalance;                                                                                                                                                            
								parent.TaxPTA = nodeCoveredData[i].TaxPTA + parent.TaxPTA;                                                                                                                                                                                             
								parent.Covered = 'X';                                                                                                                                                                                                                                  
								parent.MainCurrency = nodeCoveredData[i].MainCurrency;                                                                                                                                                                                                 
							}                                                                                                                                                                                                                                                       
						}                                                                                                                                                                                                                                                        
					}                                                                                                                                                                                                                                                         
				}                                                                                                                                                                                                                                                          
				nodeNotCoveredData = data.filter(node => node.Covered === '' && node.NodeEntity !== 'GLACCOUNT');                                                                                                                                                          
				nodeCoveredData = data.filter(node => node.Covered === 'X' && node.NodeEntity !== 'GLACCOUNT')                                                                                                                                                             
                                                                                                                                                                                                                                                               
			}                                                                                                                                                                                                                                                           
			for (var i = 0; i < data.length; i++) { // add childs to every item                                                                                                                                                                                         
				data[i].childs = [];                                                                                                                                                                                                                                       
			}                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
			let tree = this._buildTree(data);                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
			var dHierData = {                                                                                                                                                                                                                                           
				"childs": tree                                                                                                                                                                                                                                             
			}                                                                                                                                                                                                                                                           
			this.getView().getModel("HierDatModelGL").setData([]);                                                                                                                                                                                                      
			this.getView().getModel("HierDatModelGL").setData(dHierData);                                                                                                                                                                                               
			this.getBusyDialog().open();                                                                                                                                                                                                                                
			//adjust table column width                                                                                                                                                                                                                                 
			var oIntervalCall = window.setInterval(function () {                                                                                                                                                                                                        
				this.onAdjustTableCol(oTable);                                                                                                                                                                                                                             
				window.clearInterval(oIntervalCall);                                                                                                                                                                                                                       
			}.bind(this), 1000);                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                               
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		//recursive function to build the hierarchy tree data                                                                                                                                                                                                        
		_buildTree: function (tree, item) {                                                                                                                                                                                                                          
			if (item) { // if item then have parent                                                                                                                                                                                                                     
				for (var i = 0; i < tree.length; i++) { // parses the entire tree in order to find the parent                                                                                                                                                              
					if (String(tree[i].NodeId) === String(item.NodeParentId)) { // bingo!                                                                                                                                                                                     
                                                                                                                                                                                                                                                               
						tree[i].childs.push(item); // add the child to his parent                                                                                                                                                                                                
						break;                                                                                                                                                                                                                                                   
					} else this._buildTree(tree[i].childs, item); // if item doesn't match but tree have childs then parses childs again to find item parent                                                                                                                  
				}                                                                                                                                                                                                                                                          
			} else { // if no item then is a root item, multiple root items are supported                                                                                                                                                                               
				var idx = 0;                                                                                                                                                                                                                                               
				while (idx < tree.length)                                                                                                                                                                                                                                  
					if (tree[idx].NodeParentId) this._buildTree(tree, tree.splice(idx, 1)[0]) // if have parent then remove it from the array to relocate it to the right place                                                                                               
					else idx++; // if doesn't have parent then is root and move it to the next object                                                                                                                                                                         
			}                                                                                                                                                                                                                                                           
			return tree;                                                                                                                                                                                                                                                
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		_fetchGlobalParameters: function () {                                                                                                                                                                                                                        
			var that = this;                                                                                                                                                                                                                                            
			var oGlobalParameterData = {                                                                                                                                                                                                                                
				"Default": true                                                                                                                                                                                                                                            
			};                                                                                                                                                                                                                                                          
			var oModel = this.getOwnerComponent().getModel();                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
			oModel.callFunction("/GlobalParameter", {                                                                                                                                                                                                                   
				method: "GET",                                                                                                                                                                                                                                             
				urlParameters: oGlobalParameterData,                                                                                                                                                                                                                       
				success: function (oData) {                                                                                                                                                                                                                                
					// Saving global parameters in Model                                                                                                                                                                                                                      
					that.getView().getModel("viewConfigDataModel").setData({                                                                                                                                                                                                  
						"globalParameters": oData                                                                                                                                                                                                                                
					});                                                                                                                                                                                                                                                       
                                                                                                                                                                                                                                                               
					// If 'VARIANT' is being used, Do Not over write global parameters                                                                                                                                                                                        
					let oFilterBar = that.getView().byId("idsmartFilterBar");                                                                                                                                                                                                 
					if (!oFilterBar.getCurrentVariantId()) {                                                                                                                                                                                                                  
						that._setFilterBarParameters(oData);                                                                                                                                                                                                                     
					}                                                                                                                                                                                                                                                         
				},                                                                                                                                                                                                                                                         
				error: function (oError) {                                                                                                                                                                                                                                 
					MessageBox.error(that.getI18nText("errorReadingGlobalParameters"));                                                                                                                                                                                       
				}                                                                                                                                                                                                                                                          
			});                                                                                                                                                                                                                                                         
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		_setFilterBarParameters: function (oGlobalParameters) {                                                                                                                                                                                                      
			let oView = this.getView(),                                                                                                                                                                                                                                 
				oCurrency = oView.byId("idCurrency");                                                                                                                                                                                                                      
                                                                                                                                                                                                                                                               
			if (oGlobalParameters.LocalCurrencyType && oGlobalParameters.LocalCurrency) {                                                                                                                                                                               
				oCurrency.setSelectedKey(oGlobalParameters.LocalCurrency);                                                                                                                                                                                                 
			} else {                                                                                                                                                                                                                                                    
				oCurrency.setSelectedKey(oGlobalParameters.GroupCurrency);                                                                                                                                                                                                 
			}                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
			if (oGlobalParameters.ConsolidationUnit) {                                                                                                                                                                                                                  
				oView.byId("idConsUnit").setSelectedKey(oGlobalParameters.ConsolidationUnit);                                                                                                                                                                              
				oCurrency.setVisible(true);                                                                                                                                                                                                                                
				this._fetchCurrencyData(true);                                                                                                                                                                                                                             
				this.fetchReconLedgerData();                                                                                                                                                                                                                               
			}                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
			if (oGlobalParameters.FiscalYear) {                                                                                                                                                                                                                         
				// Generating a Date mid-year 6th of June - with provided fiscal year.                                                                                                                                                                                     
				let oFiscalYearDate = new Date("06/06/".concat(oGlobalParameters.FiscalYear.toString()));                                                                                                                                                                  
				oView.byId("idFiscalYearFilter").setDateValue(oFiscalYearDate);                                                                                                                                                                                            
			}                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
			if (oGlobalParameters.Intention) {                                                                                                                                                                                                                          
				oView.byId("idIntentionComboBox").setSelectedKey(oGlobalParameters.Intention);                                                                                                                                                                             
			}                                                                                                                                                                                                                                                           
			// Fetch data for Intention. This is independent of Intention data stored in Global Parameter App.                                                                                                                                                          
			var aParam = [oGlobalParameters.ConsolidationUnit, oGlobalParameters.FiscalYear];                                                                                                                                                                           
			this._fetchIntentionStatus(aParam);                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                               
			if (oGlobalParameters.PeriodFrom) {                                                                                                                                                                                                                         
				oView.byId("idPeriodFromInput").setValue(formatter.convertStringToInt(oGlobalParameters.PeriodFrom));                                                                                                                                                      
			}                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
			if (oGlobalParameters.PeriodTo) {                                                                                                                                                                                                                           
				oView.byId("idPeriodToInput").setValue(formatter.convertStringToInt(oGlobalParameters.PeriodTo));                                                                                                                                                          
			}                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		getI18nText: function (sTextKey) {                                                                                                                                                                                                                           
			return this.getResourceBundle().getText(sTextKey);                                                                                                                                                                                                          
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		_fetchCurrencyData: function (bIsVariantCall) {                                                                                                                                                                                                              
			var oView = this.getView(),                                                                                                                                                                                                                                 
				consKey = oView.byId("idConsUnit").getSelectedKey(),                                                                                                                                                                                                       
				oFilter = new Filter("ConsolidationUnit", FilterOperator.EQ, consKey),                                                                                                                                                                                     
				oServiceCallModel = this.getModel(),                                                                                                                                                                                                                       
				that = this,                                                                                                                                                                                                                                               
				oCurrencyCtrl = oView.byId("idCurrType"),                                                                                                                                                                                                                  
				oCurrControl = oView.byId("idCurrency");                                                                                                                                                                                                                   
                                                                                                                                                                                                                                                               
			oCurrencyCtrl.setVisible(true);                                                                                                                                                                                                                             
			oCurrControl.setBusy(true);                                                                                                                                                                                                                                 
			oServiceCallModel.read("/xEY1xSAV_C_CurrLocalGroupVH", {                                                                                                                                                                                                    
				method: "GET",                                                                                                                                                                                                                                             
				filters: [oFilter],                                                                                                                                                                                                                                        
				success: function (oData, oResponse) {                                                                                                                                                                                                                     
					oCurrControl.setBusy(false);                                                                                                                                                                                                                              
					that.setModel(new JSONModel(oData), "currLocalGroupVHModel");                                                                                                                                                                                             
					if (!bIsVariantCall && oData.results.length > 0) {                                                                                                                                                                                                        
						oCurrControl.setSelectedKey(oData.results[0].Currency);                                                                                                                                                                                                  
					}                                                                                                                                                                                                                                                         
				},                                                                                                                                                                                                                                                         
				error: function (oError) {                                                                                                                                                                                                                                 
					oCurrControl.setBusy(false);                                                                                                                                                                                                                              
					MessageToast.show(that.getI18nText("errorFetchingCurrency"));                                                                                                                                                                                             
				}                                                                                                                                                                                                                                                          
			});                                                                                                                                                                                                                                                         
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		_fetchIntentionStatus: function (aParam) {                                                                                                                                                                                                                   
                                                                                                                                                                                                                                                               
			let oServiceCallModel = this.getModel();                                                                                                                                                                                                                    
			let sBunit = aParam[0],                                                                                                                                                                                                                                     
				sYear = aParam[1],                                                                                                                                                                                                                                         
				sServiceURL = "/xEY1xSAV_C_IntentionsStatus(p_bunit='" + sBunit + "')/Set",                                                                                                                                                                                
				oFilter = new Filter("Gjahr", FilterOperator.EQ, sYear),                                                                                                                                                                                                   
				that = this,                                                                                                                                                                                                                                               
				oView = that.getView(),                                                                                                                                                                                                                                    
				oIntentionCtrl = oView.byId("idIntentionComboBox");                                                                                                                                                                                                        
                                                                                                                                                                                                                                                               
			this.getBusyDialog().open();                                                                                                                                                                                                                                
			oServiceCallModel.read(sServiceURL, {                                                                                                                                                                                                                       
				method: "GET",                                                                                                                                                                                                                                             
				sorters: [                                                                                                                                                                                                                                                 
					new sap.ui.model.Sorter("SerialNumber")                                                                                                                                                                                                                   
				],                                                                                                                                                                                                                                                         
				filters: [oFilter],                                                                                                                                                                                                                                        
				success: function (oData, oResponse) {                                                                                                                                                                                                                     
					that.getBusyDialog().close();                                                                                                                                                                                                                             
                                                                                                                                                                                                                                                               
					if (oData.results.length === 0) {                                                                                                                                                                                                                         
						oIntentionCtrl.setSelectedKey('');                                                                                                                                                                                                                       
						oIntentionCtrl.setEnabled(false);                                                                                                                                                                                                                        
						MessageBox.error(that.getI18nText("IntentionNotYetOpen") + sYear);                                                                                                                                                                                       
                                                                                                                                                                                                                                                               
						return;                                                                                                                                                                                                                                                  
					}                                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                               
					oIntentionCtrl.setEnabled(true);                                                                                                                                                                                                                          
                                                                                                                                                                                                                                                               
					let oGlobalParamter = that.getView().getModel("viewConfigDataModel").getData().globalParameters;                                                                                                                                                          
					oIntentionCtrl.setSelectedKey(oGlobalParamter.Intention);                                                                                                                                                                                                 
                                                                                                                                                                                                                                                               
					//Added Lines                                                                                                                                                                                                                                             
					oIntentionCtrl.setSelectedKey("");                                                                                                                                                                                                                        
					for (let m = 0; m < oData.results.length; m++) {                                                                                                                                                                                                          
						if (oData.results[m].isSelected === "X") {                                                                                                                                                                                                               
							oIntentionCtrl.setSelectedKey(oData.results[m].Intention);                                                                                                                                                                                              
						}                                                                                                                                                                                                                                                        
					}                                                                                                                                                                                                                                                         
					if (oIntentionCtrl.getSelectedKey() === "") {                                                                                                                                                                                                             
						for (let n = 0; n < oData.results.length; n++) {                                                                                                                                                                                                         
							if (oData.results[n].status === "Open") {                                                                                                                                                                                                               
								oIntentionCtrl.setSelectedKey(oData.results[n].Intention);                                                                                                                                                                                             
							}                                                                                                                                                                                                                                                       
						}                                                                                                                                                                                                                                                        
					}                                                                                                                                                                                                                                                         
					//End added Lines                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                               
					let oModel = new JSONModel(oData);                                                                                                                                                                                                                        
					that.getView().setModel(oModel, "intentionVHModel");                                                                                                                                                                                                      
                                                                                                                                                                                                                                                               
					that._managePeriodFieldsEditability(false);                                                                                                                                                                                                               
				},                                                                                                                                                                                                                                                         
				error: function (oError) {                                                                                                                                                                                                                                 
					that.getBusyDialog().close();                                                                                                                                                                                                                             
					MessageBox.error(that.getI18nText("errorFetchingIntentionStatus"));                                                                                                                                                                                       
				}                                                                                                                                                                                                                                                          
			});                                                                                                                                                                                                                                                         
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		// _fetchIntentionData: function () {                                                                                                                                                                                                                        
		// 	let oServiceCallModel = this.getModel(),                                                                                                                                                                                                                 
		// 		sServiceURL = "/xEY1xSAV_C_ReadIntentVH",                                                                                                                                                                                                               
		// 		that = this;                                                                                                                                                                                                                                            
		// 	this.getBusyDialog().open();                                                                                                                                                                                                                             
		// 	oServiceCallModel.read(sServiceURL, {                                                                                                                                                                                                                    
		// 		method: "GET",                                                                                                                                                                                                                                          
		// 		sorters: [                                                                                                                                                                                                                                              
		// 			new sap.ui.model.Sorter("SerialNumber")                                                                                                                                                                                                                
		// 		],                                                                                                                                                                                                                                                      
		// 		success: function (oData, oResponse) {                                                                                                                                                                                                                  
		// 			that.getBusyDialog().close();                                                                                                                                                                                                                          
		// 			let oModel = new JSONModel(oData);                                                                                                                                                                                                                     
		// 			that.getView().setModel(oModel, "intentionVHModel");                                                                                                                                                                                                   
		// 			that._managePeriodFieldsEditability(false);                                                                                                                                                                                                            
		// 		},                                                                                                                                                                                                                                                      
		// 		error: function (oError) {                                                                                                                                                                                                                              
		// 			that.getBusyDialog().close();                                                                                                                                                                                                                          
		// 			MessageToast.show(that.getI18nText("errorFetchingIntentions"));                                                                                                                                                                                        
		// 		}                                                                                                                                                                                                                                                       
		// 	});                                                                                                                                                                                                                                                      
		// },                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                               
		_managePeriodFieldsEditability: function (bIsChangeEventCalled) {                                                                                                                                                                                            
			let oView = this.getView(),                                                                                                                                                                                                                                 
				oIntentionCtrl = oView.byId("idIntentionComboBox");                                                                                                                                                                                                        
                                                                                                                                                                                                                                                               
			if (!bIsChangeEventCalled) {                                                                                                                                                                                                                                
				oIntentionCtrl.setSelectedKey(oIntentionCtrl.getSelectedKey());                                                                                                                                                                                            
			}                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
			let oSelectedItem = oIntentionCtrl.getSelectedItem(),                                                                                                                                                                                                       
				oSelectedData = oSelectedItem.getBindingContext("intentionVHModel").getObject(),                                                                                                                                                                           
				oPeriodTo = oView.byId("idPeriodToInput"),                                                                                                                                                                                                                 
				iTaxIntentionVal = formatter.convertStringToInt(oSelectedData.TaxIntention);                                                                                                                                                                               
                                                                                                                                                                                                                                                               
			if (iTaxIntentionVal !== formatter.convertStringToInt(0)) {                                                                                                                                                                                                 
				oPeriodTo.setEditable(false);                                                                                                                                                                                                                              
				oPeriodTo.setValue(formatter.convertStringToInt(oSelectedData.PeriodTo));                                                                                                                                                                                  
			} else {                                                                                                                                                                                                                                                    
				// IF 'PERIODIC' selected, then set Editable                                                                                                                                                                                                               
				oPeriodTo.setEditable(true);                                                                                                                                                                                                                               
				// oPeriodTo.setValue(0);                                                                                                                                                                                                                                  
			}                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		fetchReconLedgerData: function () {                                                                                                                                                                                                                          
			let oServiceCallModel = this.getModel();                                                                                                                                                                                                                    
			let sServiceURL = oServiceCallModel.createKey("/xEY1xSAV_C_Recon_Ledger", {                                                                                                                                                                                 
				"bunit": this.byId("idConsUnit").getSelectedKey()                                                                                                                                                                                                          
			});                                                                                                                                                                                                                                                         
			let that = this;                                                                                                                                                                                                                                            
			oServiceCallModel.read(sServiceURL, {                                                                                                                                                                                                                       
				method: "GET",                                                                                                                                                                                                                                             
				success: function (oData, oResponse) {                                                                                                                                                                                                                     
					var oModel = that.getModel("viewConfigDataModel");                                                                                                                                                                                                        
					oModel.getData().reconData = oData;                                                                                                                                                                                                                       
					oModel.refresh();                                                                                                                                                                                                                                         
				},                                                                                                                                                                                                                                                         
				error: function (oError) {                                                                                                                                                                                                                                 
					if (parseInt(oError.statusCode, [10]) !== 404) {                                                                                                                                                                                                          
						MessageToast.show(that.getI18nText("reconServiceCallError"));                                                                                                                                                                                            
					}                                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                               
				}                                                                                                                                                                                                                                                          
			});                                                                                                                                                                                                                                                         
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		/* =========================================================== */                                                                                                                                                                                            
		/* event handlers                                              */                                                                                                                                                                                            
		/* =========================================================== */                                                                                                                                                                                            
                                                                                                                                                                                                                                                               
		onSearchButtonPressed: function (oEvent) {                                                                                                                                                                                                                   
			let oView = this.getView();                                                                                                                                                                                                                                 
			//	oView.byId("idTreeHierFSItem").collapseAll();                                                                                                                                                                                                            
			aGlblArr = [];                                                                                                                                                                                                                                              
			if (oView.byId("idHierCatTextInpt").getSelectedKey()) {                                                                                                                                                                                                     
				//till the time GLaccount logic is implemented - it should work for only FS item                                                                                                                                                                           
				if (oView.byId("idHierType").getSelectedKey() === "CS15") {                                                                                                                                                                                                
					oView.byId("idTreeHierFSItem").setBusy(true);                                                                                                                                                                                                             
				} else {                                                                                                                                                                                                                                                   
					oView.byId("idTreeHierGLAcc").setBusy(true);                                                                                                                                                                                                              
				}                                                                                                                                                                                                                                                          
                                                                                                                                                                                                                                                               
				//fetch recon data to populate the amount fields                                                                                                                                                                                                           
				this._fetchReconData();                                                                                                                                                                                                                                    
				//fetch tree data and form tree                                                                                                                                                                                                                            
				this._fetchTreeData();                                                                                                                                                                                                                                     
				//	}                                                                                                                                                                                                                                                       
                                                                                                                                                                                                                                                               
			} else {                                                                                                                                                                                                                                                    
				//if no hier id is selected then we cannot proceed                                                                                                                                                                                                         
				oView.byId("idHierCatTextInpt").setValueState("Error");                                                                                                                                                                                                    
			}                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		//to validate in case user types in the hier id input control---validate with the service call data                                                                                                                                                          
		onChangeHierId: function (oEvent) {                                                                                                                                                                                                                          
			let sHierId = oEvent.getSource().getSelectedKey(),                                                                                                                                                                                                          
				dHierIdData = this.getView().getModel("hierarCatModel").getData(),                                                                                                                                                                                         
				bExist = dHierIdData.some(item => item.HierarchyId === sHierId),                                                                                                                                                                                           
				oSmartFB = this.getView().byId("idsmartFilterBar");                                                                                                                                                                                                        
			if (bExist) {                                                                                                                                                                                                                                               
				oEvent.getSource().setValueState("None");                                                                                                                                                                                                                  
				oSmartFB.fireSearch();                                                                                                                                                                                                                                     
			} else {                                                                                                                                                                                                                                                    
				oEvent.getSource().setValueState("Error");                                                                                                                                                                                                                 
			}                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		onBeforeVariantSaveFilterBar: function (oEvent) {                                                                                                                                                                                                            
			let oView = this.getView(),                                                                                                                                                                                                                                 
				oFilterBar = oView.byId("idsmartFilterBar"),                                                                                                                                                                                                               
				oCnsdUnit = oView.byId("idConsUnit"),                                                                                                                                                                                                                      
				oFiscalYear = oView.byId("idFiscalYearFilter"),                                                                                                                                                                                                            
				oIntention = oView.byId("idIntentionComboBox"),                                                                                                                                                                                                            
				oCurrency = oView.byId("idCurrency"),                                                                                                                                                                                                                      
				oPeriodTo = oView.byId("idPeriodToInput");                                                                                                                                                                                                                 
                                                                                                                                                                                                                                                               
			oFilterBar.setFilterData({                                                                                                                                                                                                                                  
				"_CUSTOM": {                                                                                                                                                                                                                                               
					"ConsolidationUnit": oCnsdUnit.getSelectedKey(),                                                                                                                                                                                                          
					"FiscalYear": oFiscalYear.getValue(),                                                                                                                                                                                                                     
					"Intention": oIntention.getSelectedKey(),                                                                                                                                                                                                                 
					"CurrType": oCurrency.getSelectedKey(),                                                                                                                                                                                                                   
					"PeriodTo": oPeriodTo.getValue(),                                                                                                                                                                                                                         
					"VariantID": oFilterBar.getCurrentVariantId()                                                                                                                                                                                                             
				}                                                                                                                                                                                                                                                          
			});                                                                                                                                                                                                                                                         
		},                                                                                                                                                                                                                                                           
		onAfterVariantLoadFilterBar: function (oEvent) {                                                                                                                                                                                                             
			var oView = this.getView();                                                                                                                                                                                                                                 
			var oFilterBar = oView.byId("idsmartFilterBar");                                                                                                                                                                                                            
			var oCnsdUnit = oView.byId("idConsUnit");                                                                                                                                                                                                                   
			var oFiscalYear = oView.byId("idFiscalYearFilter");                                                                                                                                                                                                         
			let oIntention = oView.byId("idIntentionComboBox");                                                                                                                                                                                                         
			var oCurrency = oView.byId("idCurrency");                                                                                                                                                                                                                   
			let oPeriodTo = this.getView().byId("idPeriodToInput");                                                                                                                                                                                                     
			var oFilterData = oFilterBar.getFilterData()["_CUSTOM"];                                                                                                                                                                                                    
                                                                                                                                                                                                                                                               
			//	Setting Data to filter fields                                                                                                                                                                                                                            
			oCnsdUnit.setSelectedKey(oFilterData.ConsolidationUnit);                                                                                                                                                                                                    
			oFiscalYear.setValue(oFilterData.FiscalYear);                                                                                                                                                                                                               
			oIntention.setSelectedKey(oFilterData.Intention);                                                                                                                                                                                                           
			oCurrency.setSelectedKey(oFilterData.CurrType);                                                                                                                                                                                                             
			oPeriodTo.setValue(formatter.convertStringToInt(oFilterData.PeriodTo));                                                                                                                                                                                     
                                                                                                                                                                                                                                                               
			// If Consolidation Unit is loaded, then call Ledger Data                                                                                                                                                                                                   
			if (oFilterData.ConsolidationUnit) {                                                                                                                                                                                                                        
				this.fetchReconLedgerData();                                                                                                                                                                                                                               
			}                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
			// Fetch Currency Data for Dropdown                                                                                                                                                                                                                         
			if (oFilterData.CurrType) {                                                                                                                                                                                                                                 
				oCurrency.setVisible(true);                                                                                                                                                                                                                                
				this._fetchCurrencyData(true);                                                                                                                                                                                                                             
			}                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
			// if (oFilterData.ConsolidationUnit && oFilterData.FiscalYear && oFilterData.Intention) {                                                                                                                                                                  
			// this._fetchValidTaxRates({                                                                                                                                                                                                                               
			// 	ConsolidationUnit: oFilterData.ConsolidationUnit,                                                                                                                                                                                                       
			// 	PeriodTo: oFilterData.PeriodTo,                                                                                                                                                                                                                         
			// 	FiscalYear: oFilterData.FiscalYear.getFullYear()                                                                                                                                                                                                        
			// });                                                                                                                                                                                                                                                      
			// }                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                               
			// Intention Data to be loaded.                                                                                                                                                                                                                             
			// If Intention is 'Empty' in Saved Variant, still we need data in DropDown list.                                                                                                                                                                           
			var aParam = [oCnsdUnit, oFiscalYear];                                                                                                                                                                                                                      
			this._fetchIntentionStatus(aParam);                                                                                                                                                                                                                         
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		onChangeDatePickerFilter: function (oEvent) {                                                                                                                                                                                                                
			let oDP = oEvent.getSource(),                                                                                                                                                                                                                               
				sBunit = this.getView().byId("idConsUnit").getProperty("selectedKey");                                                                                                                                                                                     
			//oReconLedgerData.globalParameters.ConsolidationUnit;                                                                                                                                                                                                      
			if (oEvent.getParameter("valid")) {                                                                                                                                                                                                                         
				oDP.setValueState("None");                                                                                                                                                                                                                                 
				let sYear = oDP.getDateValue().getFullYear(),                                                                                                                                                                                                              
					aParam = [sBunit, sYear];                                                                                                                                                                                                                                 
				this._fetchIntentionStatus(aParam);                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                               
			} else {                                                                                                                                                                                                                                                    
				oDP.setValueState("Error");                                                                                                                                                                                                                                
			}                                                                                                                                                                                                                                                           
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		onConsUnitChange: function (oEvent) {                                                                                                                                                                                                                        
			this._fetchCurrencyData(false);                                                                                                                                                                                                                             
			this.fetchReconLedgerData();                                                                                                                                                                                                                                
			//Added Method Call                                                                                                                                                                                                                                         
			let oBunit = this.getView().byId("idConsUnit").getProperty("selectedKey");                                                                                                                                                                                  
			let aParam = [oBunit, this.getView().byId("idFiscalYearFilter").getDateValue().getFullYear()];                                                                                                                                                              
			this._fetchIntentionStatus(aParam);                                                                                                                                                                                                                         
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		onChangeIntentionComboBox: function (oEvent) {                                                                                                                                                                                                               
			let oView = this.getView(),                                                                                                                                                                                                                                 
				oIntentionCtrl = oView.byId("idIntentionComboBox"),                                                                                                                                                                                                        
				oSelectedItem = oIntentionCtrl.getSelectedItem();                                                                                                                                                                                                          
                                                                                                                                                                                                                                                               
			// Validation for Invalid data	                                                                                                                                                                                                                             
			if (!oSelectedItem) {                                                                                                                                                                                                                                       
				oIntentionCtrl.setSelectedItem("");                                                                                                                                                                                                                        
				return;                                                                                                                                                                                                                                                    
			}                                                                                                                                                                                                                                                           
			this._managePeriodFieldsEditability(true);                                                                                                                                                                                                                  
                                                                                                                                                                                                                                                               
			// Check if Tax Rate Maintained for selected intention.                                                                                                                                                                                                     
			// if (oEvent.getSource().getValue()) {                                                                                                                                                                                                                     
			// 	this._fetchValidTaxRates();                                                                                                                                                                                                                             
			// }                                                                                                                                                                                                                                                        
		},                                                                                                                                                                                                                                                           
		//change event handling for hier type                                                                                                                                                                                                                        
		onChangeHierTypeCB: function (oEvent) {                                                                                                                                                                                                                      
			let sKey = oEvent.getSource().getSelectedKey(),                                                                                                                                                                                                             
				oView = this.getView();                                                                                                                                                                                                                                    
			if (sKey === "CS15") {                                                                                                                                                                                                                                      
				oView.byId("idTRFMainRepSmartTable").setVisible(true);                                                                                                                                                                                                     
				oView.getModel("HierDatModel").setData([]);                                                                                                                                                                                                                
				oView.byId("idMainRepSmartTable").setVisible(false);                                                                                                                                                                                                       
			} else {                                                                                                                                                                                                                                                    
				oView.byId("idMainRepSmartTable").setVisible(true);                                                                                                                                                                                                        
				oView.byId("idTRFMainRepSmartTable").setVisible(false);                                                                                                                                                                                                    
				oView.getModel("HierDatModelGL").setData([]);                                                                                                                                                                                                              
			}                                                                                                                                                                                                                                                           
			this._fetchValueHelpHierarchyTxt(sKey);                                                                                                                                                                                                                     
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		onLiveChangePeriodTo: function () {                                                                                                                                                                                                                          
			let oPeriodTo = this.getView().byId("idPeriodToInput");                                                                                                                                                                                                     
			let p_fromyb = parseInt(this.getView().byId("idPeriodFromInput").getValue(), [10]);                                                                                                                                                                         
			let p_toyb = parseInt(oPeriodTo.getValue(), [10]);                                                                                                                                                                                                          
                                                                                                                                                                                                                                                               
			oPeriodTo.setValueState("None");                                                                                                                                                                                                                            
			//	If PeriodTo < PeriodFrom, then do not execute further service call&nbsp;                                                                                                                                                                                 
			if (p_toyb < p_fromyb) {                                                                                                                                                                                                                                    
				oPeriodTo.setValueState("Error");                                                                                                                                                                                                                          
				oPeriodTo.setValueStateText(this.getI18nText("periodToLessThanPeriodFromErrorMsg"));                                                                                                                                                                       
				return;                                                                                                                                                                                                                                                    
			} else if (p_toyb > '012') {                                                                                                                                                                                                                                
				oPeriodTo.setValueState("Error");                                                                                                                                                                                                                          
				oPeriodTo.setValueStateText(this.getI18nText("periodToGreaterThanLastPeriod"));                                                                                                                                                                            
				return;                                                                                                                                                                                                                                                    
			}                                                                                                                                                                                                                                                           
		},                                                                                                                                                                                                                                                           
		onPressOkBtnAppSettingsCTA: function (oEvent) {                                                                                                                                                                                                              
			let bValid = this.getView().byId("idsmartFilterBar").validateMandatoryFields();                                                                                                                                                                             
			if (bValid) {                                                                                                                                                                                                                                               
				this._fetchReconData();                                                                                                                                                                                                                                    
				//	this.oGlobalSmartTable.rebindTable();                                                                                                                                                                                                                   
			}                                                                                                                                                                                                                                                           
			this._oAppSettingDialogCTA.close();                                                                                                                                                                                                                         
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		onValueHelpRequested: function (oEvent) {                                                                                                                                                                                                                    
			let oView = this.getView(),                                                                                                                                                                                                                                 
				aCols = oView.getModel("VHColumnModel").getData().cols,                                                                                                                                                                                                    
				that = this,                                                                                                                                                                                                                                               
				oInputHierId = this.getView().byId("idHierCatTextInpt");                                                                                                                                                                                                   
                                                                                                                                                                                                                                                               
			if (!this._oHierIdVHDialog) {                                                                                                                                                                                                                               
				this._oHierIdVHDialog = sap.ui.xmlfragment("ey.sap.fin.cs.hierarchyReport.fragment.hierarchyIdValueHelp", this);                                                                                                                                           
				this.getView().addDependent(this._oHierIdVHDialog);                                                                                                                                                                                                        
			}                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
			this._oHierIdVHDialog.getTableAsync().then(function (oTable) {                                                                                                                                                                                              
				//setting the rows in the VH  table                                                                                                                                                                                                                        
				oTable.setModel(oView.getModel("hierarCatModel"));                                                                                                                                                                                                         
				//setting the columns in the VH table                                                                                                                                                                                                                      
				oTable.setModel(oView.getModel("VHColumnModel"), "columns");                                                                                                                                                                                               
                                                                                                                                                                                                                                                               
				oTable.bindAggregation("rows", "/");                                                                                                                                                                                                                       
				oTable.attachRowSelectionChange(function (evt) {                                                                                                                                                                                                           
					let oParams = evt.getParameters(), //this has what you need in it                                                                                                                                                                                         
						sHierId = oParams.rowContext.getProperty().HierarchyId;                                                                                                                                                                                                  
					oInputHierId.setSelectedKey(sHierId);                                                                                                                                                                                                                     
					that._oHierIdVHDialog.close();                                                                                                                                                                                                                            
				});                                                                                                                                                                                                                                                        
			});                                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                               
			this._oHierIdVHDialog.open();                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                               
		},                                                                                                                                                                                                                                                           
		onValueHelpCancelPress: function () {                                                                                                                                                                                                                        
			this._oHierIdVHDialog.close();                                                                                                                                                                                                                              
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		onValueHelpAfterClose: function () {                                                                                                                                                                                                                         
			this._oHierIdVHDialog.destroy();                                                                                                                                                                                                                            
			this._oHierIdVHDialog = undefined;                                                                                                                                                                                                                          
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		//inside the value help of hier id when filter is applied and search is hit                                                                                                                                                                                  
		onFilterBarSearch: function (oEvent) {                                                                                                                                                                                                                       
                                                                                                                                                                                                                                                               
			let aSelectionSet = oEvent.getParameter("selectionSet"),                                                                                                                                                                                                    
				aFilters = aSelectionSet.reduce(function (aResult, oControl) {                                                                                                                                                                                             
					if (oControl.getValue()) {                                                                                                                                                                                                                                
						aResult.push(new Filter({                                                                                                                                                                                                                                
							path: oControl.getName(),                                                                                                                                                                                                                               
							operator: FilterOperator.Contains,                                                                                                                                                                                                                      
							value1: oControl.getValue()                                                                                                                                                                                                                             
						}));                                                                                                                                                                                                                                                     
					}                                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                               
					return aResult;                                                                                                                                                                                                                                           
				}, []);                                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                               
			this._filterVHTable(new Filter({                                                                                                                                                                                                                            
				filters: aFilters,                                                                                                                                                                                                                                         
				and: true                                                                                                                                                                                                                                                  
			}));                                                                                                                                                                                                                                                        
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		//whenever a hierarchy is expanded columns need to be adjusted                                                                                                                                                                                               
		onUpdateRows: function (oEvent) {                                                                                                                                                                                                                            
			this.getBusyDialog().open();                                                                                                                                                                                                                                
			let oTable = oEvent.getSource();                                                                                                                                                                                                                            
			var oIntervalCall = window.setInterval(function () {                                                                                                                                                                                                        
				this.onAdjustTableCol(oTable);                                                                                                                                                                                                                             
				window.clearInterval(oIntervalCall);                                                                                                                                                                                                                       
			}.bind(this), 1000);                                                                                                                                                                                                                                        
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		//adjust the column width acc to length of the content                                                                                                                                                                                                       
		onAdjustTableCol: function (oTable) {                                                                                                                                                                                                                        
			let aCols = oTable.getColumns();                                                                                                                                                                                                                            
			for (var i = aCols.length - 1; i >= 0; i--) {                                                                                                                                                                                                               
				// if (i === 0) {                                                                                                                                                                                                                                          
				// 	aCols[i].setResizable(true);                                                                                                                                                                                                                           
				// 	oTable.autoResizeColumn(i);                                                                                                                                                                                                                            
				// 	aCols[i].setResizable(false);                                                                                                                                                                                                                          
				// } else {                                                                                                                                                                                                                                                
				// 	oTable.autoResizeColumn(i);                                                                                                                                                                                                                            
				// }                                                                                                                                                                                                                                                       
				//	aCols[i].setResizable(true);                                                                                                                                                                                                                            
				oTable.autoResizeColumn(i);                                                                                                                                                                                                                                
				//	aCols[i].setResizable(false);                                                                                                                                                                                                                           
			}                                                                                                                                                                                                                                                           
			oTable.setFixedColumnCount(1);                                                                                                                                                                                                                              
			this.getBusyDialog().close();                                                                                                                                                                                                                               
		}                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                               
	});                                                                                                                                                                                                                                                           
});                                                                                                                                                                                                                                                            