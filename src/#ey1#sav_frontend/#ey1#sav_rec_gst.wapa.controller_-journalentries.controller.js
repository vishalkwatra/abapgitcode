sap.ui.define(["./BaseController","sap/ui/core/mvc/Controller","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/m/MessageBox","sap/m/MessageToast","../model/formatter"],function(e,t,n,o,r,i,a){"use strict";return e.extend("ey.sap.fin.cs.recgaapst+
attax.controller.JournalEntries",{formatter:a,onInit:function(){this._oSmartTable=this.getView().byId("idJournalEntriesTable");this.oRouter=this.getOwnerComponent().getRouter();this.oRouter.getRoute("JournalEntries").attachMatched(this._onRouteMatched,th+
is)},_onRouteMatched:function(){let e=this.getModel("JournalEntryData"),t=sap.ui.getCore().getModel("viewCnlVersionModel").getData().ConsolidationVersion.results;let n,o=e.getProperty("/ConsolidationLedger"),r=this,i=[];i=t.filter(e=>e.ConsolidationLedge+
r===o);n=[i[0].ConsolidationVersion];r.getOwnerComponent().getModel("JournalEntryData").getData().ConsolidationVersion=n;r.bIsMessageBoxOpen=false;r.bTableRefresh=false;if(e&&e.getData()){r._oSmartTable.rebindTable()}else{let e=r.getRouter();r.getBusyDia+
log().open();e.navTo("mainreport",{},true)}},onBeforeRebindJournalEntries:function(e){this.getView().byId("idJETaxIntentionDesc").setVisible(true);let t=this.getView().getModel("JournalEntryData"),r=e.getParameter("bindingParams").filters;let i=[new n("C+
onsolidationGroup",o.EQ,t.getProperty("/ConsolidationGroup")),new n("ConsolidationLedger",o.EQ,t.getProperty("/ConsolidationLedger")),new n("GLAccount",o.EQ,t.getProperty("/GLAccount")),new n("PeriodMode",o.EQ,t.getProperty("/PeriodMode")),new n("Consoli+
dationVersion",o.EQ,t.getProperty("/ConsolidationVersion")),new n("FiscalPeriod",o.BT,t.getProperty("/PeriodFrom"),t.getProperty("/PeriodTo")),new n("FiscalYear",o.EQ,t.getProperty("/FiscalYear")),new n("RefConsolidationDocumentType",o.EQ,t.getProperty("+
/RefConsolidationDocumentType")),new n("CompanyCode",o.EQ,t.getProperty("/ConsolidatioUnit"))];if(t.getProperty("/SelectedIntention")){i.push(new n("TaxIntention",o.LE,t.getProperty("/SelectedIntention")))}else{i.push(new n("TaxIntention",o.EQ,""))}if(t.+
getProperty("/NavLedger")==="STATToTAXLedger"){i.push(new n("LedgerGroup",o.NE,"G2S"))}if(r.length>0){i=[...i,...r]}let a=new n({filters:i,and:true}),s=a,l=[];if(t.getProperty("/FinancialTransactionType").length>0){for(var u=0;u<t.getProperty("/Financial+
TransactionType").length;u++){l.push(new n("FinancialTransactionType",o.EQ,t.getProperty("/FinancialTransactionType")[u]))}let e=new n({filters:l});s=new n({filters:[a,e],and:true})}var g=encodeURIComponent("datetime'2018-12-31T00:00:00'");var d="/xEY1xS+
AV_C_CnsldtnJrnlEntry(P_ConsolidationUnitHierarchy='$',P_ConsolidationPrftCtrHier='$',P_ConsolidationSegmentHier='$',P_KeyDate="+g+")/Results";this.getView().byId("idJournalEntriesTable").setTableBindingPath(d);var c=e.getParameter("bindingParams");c.fil+
ters=[s]},onPressConsDoc:function(e){let t=this.getModel("JournalEntryData").getData();var n=e.getSource().getBindingContext().getProperty("RefConsolidationDocumentNumber");var o=e.getSource().getBindingContext().getProperty("CompanyCode");var r=o;while(+
r.length<4){r="0"+r}var i=t.FiscalYear;var a={AccountingDocument:n,CompanyCode:r,FiscalYear:i};this.performCrossAppNavigation("AccountingDocument","manage",true,a)},onJEntriesDataReceived:function(e){this.getBusyDialog().open();let t=this.getView(),n=t.b+
yId("idJETaxIntentionDesc"),o=t.byId("idJETaxIntention");var r=window.setInterval(function(e){this._onAdjustJECol();this._compareSyncedValues(this._findTableSumRowData(this._findTableSumRow()),this.bTableRefresh);if(o.getGrouped()){n.setVisible(true)}els+
e{n.setVisible(false)}window.clearInterval(r)}.bind(this),1e3)},onPressJEDataSync:function(e){this.bTableRefresh=true;this._oSmartTable.rebindTable()},_onAdjustJECol:function(){var e=this.getView().byId("idJournalEntriesTable").getTable();var t=e.getColu+
mns();for(var n=t.length-1;n>=0;n--){e.autoResizeColumn(n)}this.getBusyDialog().close()},_findTableSumRow:function(){let e=this.getView().byId("idJournalEntriesTable");let t=e.getTable();let n=t.getRows();let o=t.getVisibleRowCount();if(!n[o-1]||!n[o-1].+
getBindingContext()){for(let e=0;e<n.length+1;e++){if(!n[e].getBindingContext()){return e-1}}}return o-1},_findTableSumRowData:function(e){let t=this.getView().byId("idJournalEntriesTable").getTable();let n;if(t.getRows()[e]&&t.getRows()[e].getBindingCon+
text()){let o=t.getRows()[e].getBindingContext().sPath;n=t.getModel().getProperty(o)}return n},_compareSyncedValues:function(e,t){let n=this.getModel("JournalEntryData").getData();let o=this.getView().byId("idJEValueHeader");if(e&&e.LocalCurrency!==n.sel+
ectedCurrency&&!e.AmountInLocalCurrency||e&&e.GroupCurrency!==n.selectedCurrency&&!e.AmountInGroupCurrency){i.show(this.getResourceBundle().getText("errorCurrencyColumnNotSelected"));return}if(e&&n.selectedCurrency===e.LocalCurrency&&parseInt(n.Value,[10+
])!==parseInt(e.AmountInLocalCurrency,[10])||e&&n.selectedCurrency===e.GroupCurrency&&parseInt(n.Value,[10])!==parseInt(e.AmountInGroupCurrency,[10])){o.setState("Warning");if(!this.bIsMessageBoxOpen){this._initializeWarningMessageBox(t)}}else{o.setState+
("Success")}},_initializeWarningMessageBox:function(e){this.bIsMessageBoxOpen=true;let t=this;r.warning(this.getResourceBundle().getText("errorMsgSumValueDiffTableSync"),{actions:[r.Action.OK],onClose:function(e){t.bIsMessageBoxOpen=false}})}})});        