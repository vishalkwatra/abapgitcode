sap.ui.define([                                                                                                                                                                                                                                                
	"./BaseController",                                                                                                                                                                                                                                           
	"sap/m/MessageToast"                                                                                                                                                                                                                                          
], function (Controller, MessageToast) {                                                                                                                                                                                                                       
	"use strict";                                                                                                                                                                                                                                                 
                                                                                                                                                                                                                                                               
	return Controller.extend("ey.sap.fin.cs.recgaapstattax.controller.EditGaapStat", {                                                                                                                                                                            
                                                                                                                                                                                                                                                               
		/**                                                                                                                                                                                                                                                          
		 * Called when a controller is instantiated and its View controls (if available) are already created.                                                                                                                                                        
		 * Can be used to modify the View before it is displayed, to bind event handlers and do other one-time initialization.                                                                                                                                       
		 * @memberOf ey.sap.fin.cs.recgaapstattax.view.EditGaapStat                                                                                                                                                                                                  
		 */                                                                                                                                                                                                                                                          
		onInit: function () {                                                                                                                                                                                                                                        
			this.oRouter = this.getOwnerComponent().getRouter();                                                                                                                                                                                                        
			this.table_rendered = false;                                                                                                                                                                                                                                
			this.oRouter.attachRoutePatternMatched(this._onGaapStatMatched, this);                                                                                                                                                                                      
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		_onGaapStatMatched: function () {                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                               
			var aFilters = [];                                                                                                                                                                                                                                          
			aFilters = this.getFilterBar().getFilters();                                                                                                                                                                                                                
                                                                                                                                                                                                                                                               
			var oTable = this.getView().byId("idEditGaapStatTable");                                                                                                                                                                                                    
                                                                                                                                                                                                                                                               
			if (!this.table_rendered) {                                                                                                                                                                                                                                 
				var aColumns = [{                                                                                                                                                                                                                                          
					columnName: "rbunit"                                                                                                                                                                                                                                      
				}, {                                                                                                                                                                                                                                                       
					columnName: "ryear"                                                                                                                                                                                                                                       
				}, {                                                                                                                                                                                                                                                       
					columnName: "racct"                                                                                                                                                                                                                                       
				}, {                                                                                                                                                                                                                                                       
					columnName: "GaapOb"                                                                                                                                                                                                                                      
				}, {                                                                                                                                                                                                                                                       
					columnName: "GaapMovement"                                                                                                                                                                                                                                
				}, {                                                                                                                                                                                                                                                       
					columnName: "GaapCb"                                                                                                                                                                                                                                      
				}, {                                                                                                                                                                                                                                                       
					columnName: "Currency"                                                                                                                                                                                                                                    
				}, {                                                                                                                                                                                                                                                       
					columnName: "G2sPl"                                                                                                                                                                                                                                       
				}, {                                                                                                                                                                                                                                                       
					columnName: "G2sPermanent"                                                                                                                                                                                                                                
				}, {                                                                                                                                                                                                                                                       
					columnName: "G2sEq"                                                                                                                                                                                                                                       
				}, {                                                                                                                                                                                                                                                       
					columnName: "G2sOtherPl"                                                                                                                                                                                                                                  
				}, {                                                                                                                                                                                                                                                       
					columnName: "G2s_Other_Permanent"                                                                                                                                                                                                                         
				}, {                                                                                                                                                                                                                                                       
					columnName: "G2sOtherEq"                                                                                                                                                                                                                                  
				}, {                                                                                                                                                                                                                                                       
					columnName: "StatOb"                                                                                                                                                                                                                                      
				}, {                                                                                                                                                                                                                                                       
					columnName: "StatPya"                                                                                                                                                                                                                                     
				}, {                                                                                                                                                                                                                                                       
					columnName: "StatMovement"                                                                                                                                                                                                                                
				}, {                                                                                                                                                                                                                                                       
					columnName: "StatCb"                                                                                                                                                                                                                                      
				}];                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                               
				for (var i = 0; i < aColumns.length; i++) {                                                                                                                                                                                                                
                                                                                                                                                                                                                                                               
					if (aColumns[i].columnName.toString().includes("G2s")) {                                                                                                                                                                                                  
						oTable.addColumn(new sap.ui.table.Column({                                                                                                                                                                                                               
							label: aColumns[i].columnName,                                                                                                                                                                                                                          
							template: new sap.m.Input({                                                                                                                                                                                                                             
								value: "{" + aColumns[i].columnName + "}"                                                                                                                                                                                                              
							})                                                                                                                                                                                                                                                      
						}));                                                                                                                                                                                                                                                     
					} else {                                                                                                                                                                                                                                                  
						oTable.addColumn(new sap.ui.table.Column({                                                                                                                                                                                                               
								label: aColumns[i].columnName,                                                                                                                                                                                                                         
								template: aColumns[i].columnName                                                                                                                                                                                                                       
							})                                                                                                                                                                                                                                                      
                                                                                                                                                                                                                                                               
						);                                                                                                                                                                                                                                                       
					}                                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                               
				}                                                                                                                                                                                                                                                          
			}                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
			var oModel = this.getView().getModel();                                                                                                                                                                                                                     
                                                                                                                                                                                                                                                               
			oTable.setModel(oModel);                                                                                                                                                                                                                                    
			oTable.bindRows({                                                                                                                                                                                                                                           
				path: "/Z_C_RECON_GAAP_STAT",                                                                                                                                                                                                                              
				parameters: {                                                                                                                                                                                                                                              
					useBatchRequests: true                                                                                                                                                                                                                                    
				},                                                                                                                                                                                                                                                         
				filters: aFilters || []                                                                                                                                                                                                                                    
			});                                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                               
			this.table_rendered = true;                                                                                                                                                                                                                                 
                                                                                                                                                                                                                                                               
		},                                                                                                                                                                                                                                                           
		onBeforeRendering: function () {                                                                                                                                                                                                                             
                                                                                                                                                                                                                                                               
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		onNavBack: function (oEvent) {                                                                                                                                                                                                                               
			// var that = this;                                                                                                                                                                                                                                         
			// var oHistory = sap.ui.core.routing.History.getInstance(),                                                                                                                                                                                                
			// 	sPreviousHash = oHistory.getPreviousHash();                                                                                                                                                                                                             
			// var oCrossAppNavigator = sap.ushell.Container.getService("CrossApplicationNavigation");                                                                                                                                                                  
                                                                                                                                                                                                                                                               
			// this.getOwnerComponent().fnSetVariant(this.variantControl1());                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
			// if (this.bDirtyFlag === true) {                                                                                                                                                                                                                          
			// 	var sQuestion = this.oI18n.getText("DataChanged");                                                                                                                                                                                                      
			// 	sap.m.MessageBox.confirm(sQuestion, {                                                                                                                                                                                                                   
			// 		initialFocus: sap.m.MessageBox.Action.CANCEL,                                                                                                                                                                                                          
			// 		onClose: function (oAction) {                                                                                                                                                                                                                          
			// 			if (oAction === sap.m.MessageBox.Action.OK) {                                                                                                                                                                                                         
			// 				this.onOkNavigate();                                                                                                                                                                                                                                 
			// 			} else {                                                                                                                                                                                                                                              
			// 				this.onCancelNavigate();                                                                                                                                                                                                                             
			// 			}                                                                                                                                                                                                                                                     
			// 		}.bind(this)                                                                                                                                                                                                                                           
			// 	});                                                                                                                                                                                                                                                     
			// } else {                                                                                                                                                                                                                                                 
			// 	oMessageManager.removeAllMessages();                                                                                                                                                                                                                    
			// 	if (sPreviousHash !== undefined) {                                                                                                                                                                                                                      
			// 		// The history contains a previous entry                                                                                                                                                                                                               
			// 		history.go(-1);                                                                                                                                                                                                                                        
			// 	} else {                                                                                                                                                                                                                                                
			// 		// Navigate back My Nominations Worklist                                                                                                                                                                                                               
			// 		this.getRouter().navTo("NominationsWorklist");                                                                                                                                                                                                         
			// 	}                                                                                                                                                                                                                                                       
			// }                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                               
			this.oRouter.navTo("Reconciliation");                                                                                                                                                                                                                       
                                                                                                                                                                                                                                                               
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		onUpdate: function () {                                                                                                                                                                                                                                      
			var aRows = this.getView().byId("idEditGaapStatTable").getRows();                                                                                                                                                                                           
			var aData = [];                                                                                                                                                                                                                                             
			var oValues = {};                                                                                                                                                                                                                                           
			var string;                                                                                                                                                                                                                                                 
			for (var i = 0; i < aRows.length; i++) {                                                                                                                                                                                                                    
				var aCells = aRows[i].getCells();                                                                                                                                                                                                                          
				for (var j = 0; j < aCells.length; j++) {                                                                                                                                                                                                                  
					if (aRows[i].getCells()[j].getMetadata()._sClassName == "sap.m.Input") {                                                                                                                                                                                  
						var value = aRows[i].getCells()[j].getValue();                                                                                                                                                                                                           
					} else {                                                                                                                                                                                                                                                  
						var value = aRows[i].getCells()[j].getText();                                                                                                                                                                                                            
					}                                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                               
					switch (j) {                                                                                                                                                                                                                                              
					case 0:                                                                                                                                                                                                                                                   
						oValues.rbunit = value;                                                                                                                                                                                                                                  
						break;                                                                                                                                                                                                                                                   
					case 1:                                                                                                                                                                                                                                                   
						oValues.ryear = value;                                                                                                                                                                                                                                   
						break;                                                                                                                                                                                                                                                   
					case 2:                                                                                                                                                                                                                                                   
						oValues.racct = value;                                                                                                                                                                                                                                   
						break;                                                                                                                                                                                                                                                   
					case 3:                                                                                                                                                                                                                                                   
						oValues.GaapOb = value;                                                                                                                                                                                                                                  
						break;                                                                                                                                                                                                                                                   
					case 4:                                                                                                                                                                                                                                                   
						oValues.GaapMovement = value;                                                                                                                                                                                                                            
						break;                                                                                                                                                                                                                                                   
					case 5:                                                                                                                                                                                                                                                   
						oValues.GaapCb = value;                                                                                                                                                                                                                                  
						break;                                                                                                                                                                                                                                                   
					case 6:                                                                                                                                                                                                                                                   
						oValues.Currency = value;                                                                                                                                                                                                                                
						break;                                                                                                                                                                                                                                                   
                                                                                                                                                                                                                                                               
					case 7:                                                                                                                                                                                                                                                   
						oValues.G2sPl = value;                                                                                                                                                                                                                                   
						break;                                                                                                                                                                                                                                                   
                                                                                                                                                                                                                                                               
					case 8:                                                                                                                                                                                                                                                   
						oValues.G2sPermanent = value;                                                                                                                                                                                                                            
						break;                                                                                                                                                                                                                                                   
                                                                                                                                                                                                                                                               
					case 9:                                                                                                                                                                                                                                                   
						oValues.G2sEq = value;                                                                                                                                                                                                                                   
						break;                                                                                                                                                                                                                                                   
					case 10:                                                                                                                                                                                                                                                  
						oValues.G2sOtherPl = value;                                                                                                                                                                                                                              
						break;                                                                                                                                                                                                                                                   
					case 11:                                                                                                                                                                                                                                                  
						oValues.G2s_Other_Permanent = value;                                                                                                                                                                                                                     
						break;                                                                                                                                                                                                                                                   
					case 12:                                                                                                                                                                                                                                                  
						oValues.G2sOtherEq = value;                                                                                                                                                                                                                              
						break;                                                                                                                                                                                                                                                   
					case 13:                                                                                                                                                                                                                                                  
						oValues.StatOb = value;                                                                                                                                                                                                                                  
						break;                                                                                                                                                                                                                                                   
					case 14:                                                                                                                                                                                                                                                  
						oValues.StatPya = value;                                                                                                                                                                                                                                 
						break;                                                                                                                                                                                                                                                   
					case 15:                                                                                                                                                                                                                                                  
						oValues.StatMovement = value;                                                                                                                                                                                                                            
						break;                                                                                                                                                                                                                                                   
					case 16:                                                                                                                                                                                                                                                  
						oValues.StatCb = value;                                                                                                                                                                                                                                  
						break;                                                                                                                                                                                                                                                   
					default:                                                                                                                                                                                                                                                  
                                                                                                                                                                                                                                                               
					}                                                                                                                                                                                                                                                         
				}                                                                                                                                                                                                                                                          
                                                                                                                                                                                                                                                               
				aData.push(oValues);                                                                                                                                                                                                                                       
				oValues = {};                                                                                                                                                                                                                                              
			}                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
			var oOdataModel = this.getView().getModel();                                                                                                                                                                                                                
			oOdataModel.setUseBatch(true);                                                                                                                                                                                                                              
			oOdataModel.setChangeGroups({                                                                                                                                                                                                                               
				"/Z_C_RECON_GAAP_STAT": {                                                                                                                                                                                                                                  
					groupId: "myGroupId",                                                                                                                                                                                                                                     
					changeSetId: "ID",                                                                                                                                                                                                                                        
					single: false                                                                                                                                                                                                                                             
				}                                                                                                                                                                                                                                                          
			});                                                                                                                                                                                                                                                         
			oOdataModel.setDeferredGroups(["myGroupId"]);                                                                                                                                                                                                               
                                                                                                                                                                                                                                                               
			var sPath;                                                                                                                                                                                                                                                  
			for (var count = 0; count < aData.length; count++) {                                                                                                                                                                                                        
				sPath = "/Z_C_RECON_GAAP_STAT(racct=" + "'" + aData[count].racct + "'" + "," +                                                                                                                                                                             
					"rbunit=" + "'" + aData[count].rbunit + "'" + "," +                                                                                                                                                                                                       
					"ryear=" + "'" + aData[count].ryear + "'" + ")";                                                                                                                                                                                                          
				oOdataModel.update(sPath, aData[count], {                                                                                                                                                                                                                  
					groupId: "myGroupId"                                                                                                                                                                                                                                      
				});                                                                                                                                                                                                                                                        
			}                                                                                                                                                                                                                                                           
			oOdataModel.submitChanges({                                                                                                                                                                                                                                 
				groupId: "myGroupId",                                                                                                                                                                                                                                      
				success: function (data, response) {                                                                                                                                                                                                                       
					MessageToast.show("Data successfully updated!!");                                                                                                                                                                                                         
				},                                                                                                                                                                                                                                                         
				error: function (e) {                                                                                                                                                                                                                                      
					MessageToast.show("Error,Data was not updated");                                                                                                                                                                                                          
				}                                                                                                                                                                                                                                                          
			});                                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                               
		},                                                                                                                                                                                                                                                           
		onCancel: function () {}                                                                                                                                                                                                                                     
                                                                                                                                                                                                                                                               
		/**                                                                                                                                                                                                                                                          
		 * Similar to onAfterRendering, but this hook is invoked before the controller's View is re-rendered                                                                                                                                                         
		 * (NOT before the first rendering! onInit() is used for that one!).                                                                                                                                                                                         
		 * @memberOf ey.sap.fin.cs.recgaapstattax.view.EditGaapStat                                                                                                                                                                                                  
		 */                                                                                                                                                                                                                                                          
		//	onBeforeRendering: function() {                                                                                                                                                                                                                           
		//                                                                                                                                                                                                                                                           
		//	},                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                               
		/**                                                                                                                                                                                                                                                          
		 * Called when the View has been rendered (so its HTML is part of the document). Post-rendering manipulations of the HTML could be done here.                                                                                                                
		 * This hook is the same one that SAPUI5 controls get after being rendered.                                                                                                                                                                                  
		 * @memberOf ey.sap.fin.cs.recgaapstattax.view.EditGaapStat                                                                                                                                                                                                  
		 */                                                                                                                                                                                                                                                          
		//	onAfterRendering: function() {                                                                                                                                                                                                                            
		//                                                                                                                                                                                                                                                           
		//	},                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                               
		/**                                                                                                                                                                                                                                                          
		 * Called when the Controller is destroyed. Use this one to free resources and finalize activities.                                                                                                                                                          
		 * @memberOf ey.sap.fin.cs.recgaapstattax.view.EditGaapStat                                                                                                                                                                                                  
		 */                                                                                                                                                                                                                                                          
		//	onExit: function() {                                                                                                                                                                                                                                      
		//                                                                                                                                                                                                                                                           
		//	}                                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                               
	});                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
});                                                                                                                                                                                                                                                            