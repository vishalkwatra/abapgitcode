sap.ui.define([                                                                                                                                                                                                                                                
	"./BaseController",                                                                                                                                                                                                                                           
	"sap/ui/model/json/JSONModel",                                                                                                                                                                                                                                
	"../model/formatter",                                                                                                                                                                                                                                         
	"sap/ui/model/Filter",                                                                                                                                                                                                                                        
	"sap/ui/model/FilterOperator",                                                                                                                                                                                                                                
	"sap/m/MessageToast",                                                                                                                                                                                                                                         
	"sap/m/MessageBox",                                                                                                                                                                                                                                           
	"sap/ui/core/ListItem",                                                                                                                                                                                                                                       
	"sap/ui/generic/app/navigation/service/NavigationHandler"                                                                                                                                                                                                     
], function (BaseController, JSONModel, formatter, Filter, FilterOperator, MessageToast, MessageBox, ListItem, NavigationHandler) {                                                                                                                            
	"use strict";                                                                                                                                                                                                                                                 
	const sLocal = "Local",                                                                                                                                                                                                                                       
		sGlobal = "Group";                                                                                                                                                                                                                                           
	let aModelTable = [];                                                                                                                                                                                                                                         
	return BaseController.extend("ey.sap.fin.cs.profitrecon.controller.ProfitRecon", {                                                                                                                                                                            
                                                                                                                                                                                                                                                               
		formatter: formatter,                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                               
		/* =========================================================== */                                                                                                                                                                                            
		/* lifecycle methods                                           */                                                                                                                                                                                            
		/* =========================================================== */                                                                                                                                                                                            
		onInit: function () {                                                                                                                                                                                                                                        
			this.oRouter = this.getOwnerComponent().getRouter();                                                                                                                                                                                                        
			this.oRouter.getRoute("profitrecon").attachMatched(this._onRouteMatched, this);                                                                                                                                                                             
			this.bGlobalParamFetch = false;                                                                                                                                                                                                                             
                                                                                                                                                                                                                                                               
			let oReconDataModel = new JSONModel();                                                                                                                                                                                                                      
			this.setModel(oReconDataModel, "viewConfigDataModel");                                                                                                                                                                                                      
                                                                                                                                                                                                                                                               
			// create an instance of the navigation handler                                                                                                                                                                                                             
			this.oNavigationHandler = new NavigationHandler(this);                                                                                                                                                                                                      
                                                                                                                                                                                                                                                               
			// on back navigation, the previous app state is returned in a Promise                                                                                                                                                                                      
			this.oNavigationHandler                                                                                                                                                                                                                                     
				.parseNavigation()                                                                                                                                                                                                                                         
				.done(this._onNavigationDone.bind(this));                                                                                                                                                                                                                  
                                                                                                                                                                                                                                                               
			//check if app is loaded initially with Global params or navigated from manage tiers with saved state of filters                                                                                                                                            
			if (this.bGlobalParamFetch) {                                                                                                                                                                                                                               
				this._fetchGlobalParameters();                                                                                                                                                                                                                             
			}                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
			this._fetchAdjustmentReasons();                                                                                                                                                                                                                             
                                                                                                                                                                                                                                                               
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		/* =========================================================== */                                                                                                                                                                                            
		/* internal methods  -PRIVATE                                  */                                                                                                                                                                                            
		/* =========================================================== */                                                                                                                                                                                            
                                                                                                                                                                                                                                                               
		_onRouteMatched: function () {                                                                                                                                                                                                                               
			this.getBusyDialog().close();                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                               
			// Declare global variables here                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                               
			// // Freeze 1st Column                                                                                                                                                                                                                                     
			// this.oGlobalSmartTable.getTable().setFixedColumnCount(1);                                                                                                                                                                                                
                                                                                                                                                                                                                                                               
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		//to save the state of the current view                                                                                                                                                                                                                      
		_getFilterData: function () {                                                                                                                                                                                                                                
			let oView = this.getView(),                                                                                                                                                                                                                                 
				oCnsdUnit = oView.byId("idConsUnit"),                                                                                                                                                                                                                      
				oFiscalYear = oView.byId("idFiscalYearFilter"),                                                                                                                                                                                                            
				oIntention = oView.byId("idIntentionComboBox"),                                                                                                                                                                                                            
				oCurrency = oView.byId("idCurrency"),                                                                                                                                                                                                                      
				oPeriodFrom = oView.byId("idPeriodFromInput"),                                                                                                                                                                                                             
				oPeriodTo = oView.byId("idPeriodToInput"),                                                                                                                                                                                                                 
				sCurrency = oCurrency.getSelectedItem().getProperty("additionalText"),                                                                                                                                                                                     
				filterData = {                                                                                                                                                                                                                                             
					"ConsolidationUnit": oCnsdUnit.getSelectedKey(),                                                                                                                                                                                                          
					"FiscalYear": oFiscalYear.getDateValue().getFullYear(),                                                                                                                                                                                                   
					"Intention": oIntention.getSelectedKey(),                                                                                                                                                                                                                 
					"TaxIntention": parseInt(oIntention.getSelectedItem().getBindingContext("intentionVHModel").getObject().TaxIntention, [10]),                                                                                                                              
					"CurrOpenPeriod": parseInt(oIntention.getSelectedItem().getBindingContext("intentionVHModel").getObject().CurrOpenPeriod, [10]),                                                                                                                          
					"status": oIntention.getSelectedItem().getBindingContext("intentionVHModel").getObject().status,                                                                                                                                                          
					"IntentDescription": oIntention.getSelectedItem().getBindingContext("intentionVHModel").getObject().IntentDescription,                                                                                                                                    
					"Country": oCnsdUnit.getSelectedItem().getBindingContext().getObject().Country,                                                                                                                                                                           
					"PeriodTo": oPeriodTo.getValue(),                                                                                                                                                                                                                         
					"PeriodFrom": oPeriodFrom.getValue(),                                                                                                                                                                                                                     
					"ConsolidationChartofAccounts": "",                                                                                                                                                                                                                       
					"ConsolidationGroup": ""                                                                                                                                                                                                                                  
                                                                                                                                                                                                                                                               
				};                                                                                                                                                                                                                                                         
			if (sCurrency === sLocal) {                                                                                                                                                                                                                                 
				filterData.CurrencyType = sLocal;                                                                                                                                                                                                                          
				filterData.LocalCurrencyType = sLocal;                                                                                                                                                                                                                     
				filterData.LocalCurrency = oCurrency.getSelectedKey();                                                                                                                                                                                                     
			} else {                                                                                                                                                                                                                                                    
				filterData.CurrencyType = sGlobal;                                                                                                                                                                                                                         
				filterData.GroupCurrencyType = sGlobal;                                                                                                                                                                                                                    
				filterData.GroupCurrency = oCurrency.getSelectedKey();                                                                                                                                                                                                     
			}                                                                                                                                                                                                                                                           
			return filterData;                                                                                                                                                                                                                                          
                                                                                                                                                                                                                                                               
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		/**                                                                                                                                                                                                                                                          
		 * if navigated back with appstate enabled then rehydrate the page using the                                                                                                                                                                                 
		 * stored data                                                                                                                                                                                                                                               
		 * @param {Object} oAppData data persisted via iAppState                                                                                                                                                                                                     
		 * @param {Object} oURLParameters paramters passed in                                                                                                                                                                                                        
		 * @param {String} sNavType type of navigation                                                                                                                                                                                                               
		 */                                                                                                                                                                                                                                                          
		_onNavigationDone: function (oAppData, oURLParameters, sNavType) {                                                                                                                                                                                           
			let oView = this.getView();                                                                                                                                                                                                                                 
			switch (sNavType) {                                                                                                                                                                                                                                         
			case sap.ui.generic.app.navigation.service.NavType.initial:                                                                                                                                                                                                 
				this.bGlobalParamFetch = true;                                                                                                                                                                                                                             
				break;                                                                                                                                                                                                                                                     
			case sap.ui.generic.app.navigation.service.NavType.iAppState:                                                                                                                                                                                               
				if (oAppData.customData) {                                                                                                                                                                                                                                 
					this.bGlobalParamFetch = false;                                                                                                                                                                                                                           
					//setting the saved state as global params on navigate back from manage tiers                                                                                                                                                                             
					oView.getModel("viewConfigDataModel").setData({                                                                                                                                                                                                           
						"globalParameters": oAppData.customData                                                                                                                                                                                                                  
					});                                                                                                                                                                                                                                                       
					this._setFilterBarParameters(oAppData.customData);                                                                                                                                                                                                        
					this._fetchAllTabData();                                                                                                                                                                                                                                  
				}                                                                                                                                                                                                                                                          
				break;                                                                                                                                                                                                                                                     
			}                                                                                                                                                                                                                                                           
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		_fetchAdjustmentReasons: function () {                                                                                                                                                                                                                       
			let oModel = this.getOwnerComponent().getModel();                                                                                                                                                                                                           
			let sServiceURL = "/xEY1xSAV_C_Recon_Adj_Reason";                                                                                                                                                                                                           
			let that = this;                                                                                                                                                                                                                                            
			oModel.read(sServiceURL, {                                                                                                                                                                                                                                  
				method: "GET",                                                                                                                                                                                                                                             
				success: function (oData, oResponse) {                                                                                                                                                                                                                     
					var oReconModel = that.getModel("viewConfigDataModel");                                                                                                                                                                                                   
					oReconModel.getData().adjustmentReason = oData.results;                                                                                                                                                                                                   
					oReconModel.refresh();                                                                                                                                                                                                                                    
				},                                                                                                                                                                                                                                                         
				error: function (oError) {                                                                                                                                                                                                                                 
					if (parseInt(oError.statusCode, [10]) !== 404) {                                                                                                                                                                                                          
						MessageToast.show(that.getI18nText("adjustmentReasonsServiceCallError"));                                                                                                                                                                                
					}                                                                                                                                                                                                                                                         
				}                                                                                                                                                                                                                                                          
			});                                                                                                                                                                                                                                                         
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		_fetchGlobalParameters: function () {                                                                                                                                                                                                                        
			var that = this;                                                                                                                                                                                                                                            
			var oModel = this.getOwnerComponent().getModel();                                                                                                                                                                                                           
			var oGLPData = {                                                                                                                                                                                                                                            
				"Default": true                                                                                                                                                                                                                                            
			};                                                                                                                                                                                                                                                          
			oModel.callFunction("/GlobalParameter", {                                                                                                                                                                                                                   
				method: "GET",                                                                                                                                                                                                                                             
				urlParameters: oGLPData,                                                                                                                                                                                                                                   
				success: function (oData) {                                                                                                                                                                                                                                
					// Saving global parameters in Model                                                                                                                                                                                                                      
					that.getView().getModel("viewConfigDataModel").setData({                                                                                                                                                                                                  
						"globalParameters": oData                                                                                                                                                                                                                                
					});                                                                                                                                                                                                                                                       
                                                                                                                                                                                                                                                               
					// If 'VARIANT' is being used, Do Not over write global parameters                                                                                                                                                                                        
					let oFilterBar = that.getView().byId("idProfitReconSmartFilterBar");                                                                                                                                                                                      
					if (!oFilterBar.getCurrentVariantId()) {                                                                                                                                                                                                                  
						that._setFilterBarParameters(oData);                                                                                                                                                                                                                     
					}                                                                                                                                                                                                                                                         
				},                                                                                                                                                                                                                                                         
				error: function (oError) {                                                                                                                                                                                                                                 
					MessageBox.error(that.getI18nText("errorReadingGlobalParameters"));                                                                                                                                                                                       
				}                                                                                                                                                                                                                                                          
			});                                                                                                                                                                                                                                                         
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		_setFilterBarParameters: function (oGlobalParameters) {                                                                                                                                                                                                      
			let oView = this.getView(),                                                                                                                                                                                                                                 
				oCurrency = oView.byId("idCurrency");                                                                                                                                                                                                                      
                                                                                                                                                                                                                                                               
			if (oGlobalParameters.LocalCurrencyType && oGlobalParameters.LocalCurrency) {                                                                                                                                                                               
				oCurrency.setSelectedKey(oGlobalParameters.LocalCurrency);                                                                                                                                                                                                 
			} else {                                                                                                                                                                                                                                                    
				oCurrency.setSelectedKey(oGlobalParameters.GroupCurrency);                                                                                                                                                                                                 
			}                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
			if (oGlobalParameters.ConsolidationUnit) {                                                                                                                                                                                                                  
				oView.byId("idConsUnit").setSelectedKey(oGlobalParameters.ConsolidationUnit);                                                                                                                                                                              
				oCurrency.setVisible(true);                                                                                                                                                                                                                                
				this._fetchCurrencyData(true);                                                                                                                                                                                                                             
				this.fetchReconLedgerData();                                                                                                                                                                                                                               
			}                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
			if (oGlobalParameters.FiscalYear) {                                                                                                                                                                                                                         
				// Generating a Date mid-year 6th of June - with provided fiscal year.                                                                                                                                                                                     
				let oFiscalYearDate = new Date("06/06/".concat(oGlobalParameters.FiscalYear.toString()));                                                                                                                                                                  
				oView.byId("idFiscalYearFilter").setDateValue(oFiscalYearDate);                                                                                                                                                                                            
			}                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
			if (oGlobalParameters.Intention) {                                                                                                                                                                                                                          
				oView.byId("idIntentionComboBox").setSelectedKey(oGlobalParameters.Intention);                                                                                                                                                                             
			}                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
			// Fetch data for Intention. This is independent of Intention data stored in Global Parameter App.                                                                                                                                                          
			//	this._fetchIntentionData(aParam);                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                               
			var aParam = [oGlobalParameters.ConsolidationUnit, oGlobalParameters.FiscalYear];                                                                                                                                                                           
			this._fetchIntentionStatus(aParam);                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                               
			if (oGlobalParameters.PeriodFrom) {                                                                                                                                                                                                                         
				oView.byId("idPeriodFromInput").setValue(formatter.convertStringToInt(oGlobalParameters.PeriodFrom));                                                                                                                                                      
			}                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
			if (oGlobalParameters.PeriodTo) {                                                                                                                                                                                                                           
				oView.byId("idPeriodToInput").setValue(formatter.convertStringToInt(oGlobalParameters.PeriodTo));                                                                                                                                                          
			}                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
			// Check If Valid Tax Rate & Tiers are maintained.                                                                                                                                                                                                          
			if (oGlobalParameters.ConsolidationUnit && oGlobalParameters.FiscalYear && oGlobalParameters.Intention) {                                                                                                                                                   
				if (oGlobalParameters.Intention) {                                                                                                                                                                                                                         
					this._fetchValidTaxRates({                                                                                                                                                                                                                                
						ConsolidationUnit: oGlobalParameters.ConsolidationUnit,                                                                                                                                                                                                  
						PeriodTo: oGlobalParameters.PeriodTo,                                                                                                                                                                                                                    
						FiscalYear: oGlobalParameters.FiscalYear                                                                                                                                                                                                                 
					});                                                                                                                                                                                                                                                       
				}                                                                                                                                                                                                                                                          
                                                                                                                                                                                                                                                               
				// Flag to execute Fetch Tiers Service call. Call when DD are binded.                                                                                                                                                                                      
				// this.bGlobalParameterTriggerred = true;                                                                                                                                                                                                                 
			}                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		getI18nText: function (sTextKey) {                                                                                                                                                                                                                           
			return this.getResourceBundle().getText(sTextKey);                                                                                                                                                                                                          
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		_fetchCurrencyData: function (bIsVariantCall) {                                                                                                                                                                                                              
			var oView = this.getView(),                                                                                                                                                                                                                                 
				consKey = oView.byId("idConsUnit").getSelectedKey(),                                                                                                                                                                                                       
				oFilter = new Filter("ConsolidationUnit", FilterOperator.EQ, consKey),                                                                                                                                                                                     
				oServiceCallModel = this.getModel(),                                                                                                                                                                                                                       
				that = this,                                                                                                                                                                                                                                               
				oCurrencyCtrl = oView.byId("idCurrType"),                                                                                                                                                                                                                  
				oCurrControl = oView.byId("idCurrency");                                                                                                                                                                                                                   
                                                                                                                                                                                                                                                               
			oCurrencyCtrl.setVisible(true);                                                                                                                                                                                                                             
			oCurrControl.setBusy(true);                                                                                                                                                                                                                                 
			oServiceCallModel.read("/xEY1xSAV_C_CurrLocalGroupVH", {                                                                                                                                                                                                    
				method: "GET",                                                                                                                                                                                                                                             
				filters: [oFilter],                                                                                                                                                                                                                                        
				success: function (oData, oResponse) {                                                                                                                                                                                                                     
					oCurrControl.setBusy(false);                                                                                                                                                                                                                              
					that.setModel(new JSONModel(oData), "currLocalGroupVHModel");                                                                                                                                                                                             
					if (!bIsVariantCall && oData.results.length > 0) {                                                                                                                                                                                                        
						oCurrControl.setSelectedKey(oData.results[0].Currency);                                                                                                                                                                                                  
					}                                                                                                                                                                                                                                                         
				},                                                                                                                                                                                                                                                         
				error: function (oError) {                                                                                                                                                                                                                                 
					oCurrControl.setBusy(false);                                                                                                                                                                                                                              
					MessageToast.show(that.getI18nText("errorFetchingCurrency"));                                                                                                                                                                                             
				}                                                                                                                                                                                                                                                          
			});                                                                                                                                                                                                                                                         
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		/*	_fetchIntentionData: function () {                                                                                                                                                                                                                        
				let oServiceCallModel = this.getModel(),                                                                                                                                                                                                                   
					sServiceURL = "/xEY1xSAV_C_ReadIntentVH",                                                                                                                                                                                                                 
					that = this;                                                                                                                                                                                                                                              
				this.getBusyDialog().open();                                                                                                                                                                                                                               
				oServiceCallModel.read(sServiceURL, {                                                                                                                                                                                                                      
					method: "GET",                                                                                                                                                                                                                                            
					sorters: [                                                                                                                                                                                                                                                
						new sap.ui.model.Sorter("SerialNumber")                                                                                                                                                                                                                  
					],                                                                                                                                                                                                                                                        
					success: function (oData, oResponse) {                                                                                                                                                                                                                    
						that.getBusyDialog().close();                                                                                                                                                                                                                            
						let oModel = new JSONModel(oData);                                                                                                                                                                                                                       
						that.getView().setModel(oModel, "intentionVHModel");                                                                                                                                                                                                     
						that._managePeriodFieldsEditability(false);                                                                                                                                                                                                              
					},                                                                                                                                                                                                                                                        
					error: function (oError) {                                                                                                                                                                                                                                
						that.getBusyDialog().close();                                                                                                                                                                                                                            
						MessageToast.show(that.getI18nText("errorFetchingIntentions"));                                                                                                                                                                                          
					}                                                                                                                                                                                                                                                         
				});                                                                                                                                                                                                                                                        
			},*/                                                                                                                                                                                                                                                        
		_fetchIntentionStatus: function (aParam) {                                                                                                                                                                                                                   
                                                                                                                                                                                                                                                               
			let oServiceCallModel = this.getModel();                                                                                                                                                                                                                    
			let sBunit = aParam[0],                                                                                                                                                                                                                                     
				sYear = aParam[1],                                                                                                                                                                                                                                         
				sServiceURL = "/xEY1xSAV_C_IntentionsStatus(p_bunit='" + sBunit + "')/Set",                                                                                                                                                                                
				oFilter = new Filter("Gjahr", FilterOperator.EQ, sYear),                                                                                                                                                                                                   
				that = this,                                                                                                                                                                                                                                               
				oView = that.getView(),                                                                                                                                                                                                                                    
				oIntentionCtrl = oView.byId("idIntentionComboBox");                                                                                                                                                                                                        
                                                                                                                                                                                                                                                               
			this.getBusyDialog().open();                                                                                                                                                                                                                                
			oServiceCallModel.read(sServiceURL, {                                                                                                                                                                                                                       
				method: "GET",                                                                                                                                                                                                                                             
				sorters: [                                                                                                                                                                                                                                                 
					new sap.ui.model.Sorter("SerialNumber")                                                                                                                                                                                                                   
				],                                                                                                                                                                                                                                                         
				filters: [oFilter],                                                                                                                                                                                                                                        
				success: function (oData, oResponse) {                                                                                                                                                                                                                     
					that.getBusyDialog().close();                                                                                                                                                                                                                             
                                                                                                                                                                                                                                                               
					if (oData.results.length === 0) {                                                                                                                                                                                                                         
						oIntentionCtrl.setSelectedKey('');                                                                                                                                                                                                                       
						oIntentionCtrl.setEnabled(false);                                                                                                                                                                                                                        
						MessageBox.error(that.getI18nText("IntentionNotYetOpen") + sYear);                                                                                                                                                                                       
						return;                                                                                                                                                                                                                                                  
					}                                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                               
					oIntentionCtrl.setEnabled(true);                                                                                                                                                                                                                          
					let oModel = new JSONModel(oData);                                                                                                                                                                                                                        
					that.getView().setModel(oModel, "intentionVHModel");                                                                                                                                                                                                      
                                                                                                                                                                                                                                                               
					let oGlobalParamter = that.getView().getModel("viewConfigDataModel").getData().globalParameters;                                                                                                                                                          
					oIntentionCtrl.setSelectedKey(oGlobalParamter.Intention);                                                                                                                                                                                                 
                                                                                                                                                                                                                                                               
					//Added Lines                                                                                                                                                                                                                                             
					oIntentionCtrl.setSelectedKey('');                                                                                                                                                                                                                        
					for (let m = 0; m < oData.results.length; m++) {                                                                                                                                                                                                          
						if (oData.results[m].isSelected === "X") {                                                                                                                                                                                                               
							oIntentionCtrl.setSelectedKey(oData.results[m].Intention);                                                                                                                                                                                              
						}                                                                                                                                                                                                                                                        
					}                                                                                                                                                                                                                                                         
					if (oIntentionCtrl.getSelectedKey() === "") {                                                                                                                                                                                                             
						for (let n = 0; n < oData.results.length; n++) {                                                                                                                                                                                                         
							if (oData.results[n].status === "Open") {                                                                                                                                                                                                               
								oIntentionCtrl.setSelectedKey(oData.results[n].Intention);                                                                                                                                                                                             
							}                                                                                                                                                                                                                                                       
						}                                                                                                                                                                                                                                                        
					}                                                                                                                                                                                                                                                         
					//End added Lines                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                               
					that._managePeriodFieldsEditability(false);                                                                                                                                                                                                               
				},                                                                                                                                                                                                                                                         
				error: function (oError) {                                                                                                                                                                                                                                 
					that.getBusyDialog().close();                                                                                                                                                                                                                             
					MessageBox.error(that.getI18nText("errorFetchingIntentionStatus"));                                                                                                                                                                                       
				}                                                                                                                                                                                                                                                          
			});                                                                                                                                                                                                                                                         
		},                                                                                                                                                                                                                                                           
		_managePeriodFieldsEditability: function (bIsChangeEventCalled) {                                                                                                                                                                                            
			let oView = this.getView(),                                                                                                                                                                                                                                 
				oIntentionCtrl = oView.byId("idIntentionComboBox"),                                                                                                                                                                                                        
				oSelectedItem = oIntentionCtrl.getSelectedItem(),                                                                                                                                                                                                          
				oSelectedData = oSelectedItem.getBindingContext("intentionVHModel").getObject(),                                                                                                                                                                           
				oPeriodTo = oView.byId("idPeriodToInput"),                                                                                                                                                                                                                 
				iTaxIntentionVal = formatter.convertStringToInt(oSelectedData.TaxIntention);                                                                                                                                                                               
                                                                                                                                                                                                                                                               
			if (iTaxIntentionVal !== formatter.convertStringToInt(0)) {                                                                                                                                                                                                 
				oPeriodTo.setEditable(false);                                                                                                                                                                                                                              
				oPeriodTo.setValue(formatter.convertStringToInt(oSelectedData.PeriodTo));                                                                                                                                                                                  
				this._manageIntentionStatus(oSelectedData);                                                                                                                                                                                                                
			} else {                                                                                                                                                                                                                                                    
				// IF 'PERIODIC' selected, then set Editable                                                                                                                                                                                                               
				oPeriodTo.setEditable(true);                                                                                                                                                                                                                               
				oPeriodTo.setValue(formatter.convertStringToInt(oSelectedData.CurrOpenPeriod));                                                                                                                                                                            
				let paramToYb = parseInt(oPeriodTo.getValue(), [10]);                                                                                                                                                                                                      
				// oPeriodTo.setValue(0);                                                                                                                                                                                                                                  
				this._managePerodicIntentionStatus(paramToYb);                                                                                                                                                                                                             
			}                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		},                                                                                                                                                                                                                                                           
		_manageIntentionStatus: function (oSelectedData) {                                                                                                                                                                                                           
			let that = this;                                                                                                                                                                                                                                            
			if (oSelectedData.status === this.getI18nText("YetToOpen")) {                                                                                                                                                                                               
				that.getBusyDialog().close();                                                                                                                                                                                                                              
				MessageBox.error((this.getModel("i18n").getResourceBundle().getText("ThisIntentionNotYetOpen", [oSelectedData.IntentDescription,                                                                                                                           
					oSelectedData.Gjahr                                                                                                                                                                                                                                       
				])));                                                                                                                                                                                                                                                      
				return;                                                                                                                                                                                                                                                    
			} else {                                                                                                                                                                                                                                                    
				return;                                                                                                                                                                                                                                                    
			}                                                                                                                                                                                                                                                           
		},                                                                                                                                                                                                                                                           
		_managePerodicIntentionStatus: function (paramToYb) {                                                                                                                                                                                                        
			let oSelectedIntention = this.getView().byId("idIntentionComboBox").getSelectedItem().getBindingContext("intentionVHModel").getObject(),                                                                                                                    
				iCurrentPeriod = parseInt(oSelectedIntention.CurrOpenPeriod, [10]);                                                                                                                                                                                        
			if (paramToYb > iCurrentPeriod) {                                                                                                                                                                                                                           
				this.getBusyDialog().close();                                                                                                                                                                                                                              
				MessageBox.error(this.getModel("i18n").getResourceBundle().getText("errorPeriodnotopen", [paramToYb, iCurrentPeriod]));                                                                                                                                    
				return;                                                                                                                                                                                                                                                    
			} else {                                                                                                                                                                                                                                                    
				return;                                                                                                                                                                                                                                                    
			}                                                                                                                                                                                                                                                           
		},                                                                                                                                                                                                                                                           
		_getIntentionForManageTier: function () {                                                                                                                                                                                                                    
			let iPeriodTo = this.getView().byId("idPeriodToInput").getValue(),                                                                                                                                                                                          
				sIntention;                                                                                                                                                                                                                                                
			if (parseInt(iPeriodTo, [10]) <= 3) {                                                                                                                                                                                                                       
				sIntention = "Q1";                                                                                                                                                                                                                                         
			} else if (parseInt(iPeriodTo, [10]) > 3 && parseInt(iPeriodTo, [10]) <= 6) {                                                                                                                                                                               
				sIntention = "Q2";                                                                                                                                                                                                                                         
			} else if (parseInt(iPeriodTo, [10]) > 6 && parseInt(iPeriodTo, [10]) <= 9) {                                                                                                                                                                               
				sIntention = "Q3";                                                                                                                                                                                                                                         
			} else {                                                                                                                                                                                                                                                    
				sIntention = "TXP";                                                                                                                                                                                                                                        
			}                                                                                                                                                                                                                                                           
			return sIntention;                                                                                                                                                                                                                                          
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		_getDataFooter: function (dataFooter, aValues, aLabels, aHighlighted, aBold) {                                                                                                                                                                               
			/* dataFooter: OData results from service call.                                                                                                                                                                                                             
			aValues: Array of String - Which values needs to be displayed.                                                                                                                                                                                              
			aLabels: Array of String - Corresponding Labels needs to be Displayed.                                                                                                                                                                                      
			aHighlighted = Array of Boolean - true(if data to be highlighted in Semantic colors), false(if data to be displayed normally)                                                                                                                               
			*/                                                                                                                                                                                                                                                          
                                                                                                                                                                                                                                                               
			let dataSetFooter = {                                                                                                                                                                                                                                       
				results: []                                                                                                                                                                                                                                                
			};                                                                                                                                                                                                                                                          
                                                                                                                                                                                                                                                               
			if (aValues.length === aLabels.length) {                                                                                                                                                                                                                    
				for (var i = 0; i < aValues.length; i++) {                                                                                                                                                                                                                 
					let sCurrentValue = aValues[i],                                                                                                                                                                                                                           
						sCurrentLabel = aLabels[i],                                                                                                                                                                                                                              
						bCurrentHighlight = aHighlighted[i],                                                                                                                                                                                                                     
						bCurrentBold = aBold[i],                                                                                                                                                                                                                                 
						aDataFooterMap = dataFooter.map(item => parseInt(item[sCurrentValue], [10]) !== parseInt("0.00", [10])),                                                                                                                                                 
						oTempEntry = {                                                                                                                                                                                                                                           
							value: aDataFooterMap.indexOf(true) === -1 ? "0.00" : dataFooter[aDataFooterMap.indexOf(true)][sCurrentValue],                                                                                                                                          
							text: this.getI18nText(sCurrentLabel),                                                                                                                                                                                                                  
							bLabelCheck: bCurrentHighlight,                                                                                                                                                                                                                         
							bLabelBold: bCurrentBold                                                                                                                                                                                                                                
						};                                                                                                                                                                                                                                                       
					dataSetFooter.results.push(oTempEntry);                                                                                                                                                                                                                   
				}                                                                                                                                                                                                                                                          
			} else {                                                                                                                                                                                                                                                    
				MessageToast.show(this.getI18nText("errorFooterDetailsInvalid"));                                                                                                                                                                                          
			}                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
			return dataSetFooter;                                                                                                                                                                                                                                       
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		_fetchCnsldVersion: function () {                                                                                                                                                                                                                            
			let oServiceCallModel = this.getModel(),                                                                                                                                                                                                                    
				oReconLedgerData = this.getModel("viewConfigDataModel").getData(),                                                                                                                                                                                         
				sCongr = oReconLedgerData.globalParameters.ConsolidationGroup,                                                                                                                                                                                             
                                                                                                                                                                                                                                                               
				sServiceUrl = "/xEY1xSAV_C_Get_Version(p_congr='" + sCongr + "')/Set",                                                                                                                                                                                     
				that = this,                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                               
				oCnlVersionModel = new JSONModel();                                                                                                                                                                                                                        
			sap.ui.getCore().setModel(oCnlVersionModel, "viewCnlVersionModel");                                                                                                                                                                                         
                                                                                                                                                                                                                                                               
			oServiceCallModel.read(sServiceUrl, {                                                                                                                                                                                                                       
				method: "GET",                                                                                                                                                                                                                                             
				sorters: [                                                                                                                                                                                                                                                 
					new sap.ui.model.Sorter("FiscalYear")                                                                                                                                                                                                                     
				],                                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                               
				success: function (oData, oResponse) {                                                                                                                                                                                                                     
					sap.ui.getCore().getModel("viewCnlVersionModel").setData({                                                                                                                                                                                                
						"ConsolidationVersion": oData                                                                                                                                                                                                                            
					});                                                                                                                                                                                                                                                       
				},                                                                                                                                                                                                                                                         
				error: function (oError) {                                                                                                                                                                                                                                 
					if (parseInt(oError.statusCode, [10]) !== 404) {                                                                                                                                                                                                          
						MessageToast.show(that.getI18nText("GetConsolidationVersionServiceCallError"));                                                                                                                                                                          
					}                                                                                                                                                                                                                                                         
				}                                                                                                                                                                                                                                                          
			});                                                                                                                                                                                                                                                         
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		_createJournalEntriesFilterData: function (oEvent) {                                                                                                                                                                                                         
			let aControlCustomData = oEvent.getSource().getCustomData(),                                                                                                                                                                                                
				sModelName = aControlCustomData[aControlCustomData.map(item => item.getProperty("key")).indexOf("modelName")].getValue();                                                                                                                                  
                                                                                                                                                                                                                                                               
			let oBindingContext = oEvent.getSource().getBindingContext(sModelName);                                                                                                                                                                                     
			// If SUM row is clicked, then Do Not Execute code further                                                                                                                                                                                                  
			if (!oBindingContext.getProperty("GLAccount")) {                                                                                                                                                                                                            
				return;                                                                                                                                                                                                                                                    
			}                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
			let oReconLedgerData = this.getModel("viewConfigDataModel").getData(),                                                                                                                                                                                      
                                                                                                                                                                                                                                                               
				oFiscalYear = this.getView().byId("idFiscalYearFilter"),                                                                                                                                                                                                   
				sFiscalYearVal = oFiscalYear.getDateValue().getFullYear(),                                                                                                                                                                                                 
                                                                                                                                                                                                                                                               
				sPeriodFrom = parseInt(this.getView().byId("idPeriodFromInput").getValue(), [10]),                                                                                                                                                                         
				sPeriodTo = parseInt(this.getView().byId("idPeriodToInput").getValue(), [10]),                                                                                                                                                                             
				oCnsldtnUnit = this.getView().byId("idConsUnit"),                                                                                                                                                                                                          
				oLocalOrGroupCurrency = this.getView().byId("idCurrency"),                                                                                                                                                                                                 
				oSelectedIntention = this.getView().byId("idIntentionComboBox").getSelectedItem().getBindingContext("intentionVHModel").getObject(),                                                                                                                       
				sIntentValue = formatter.convertStringToInt(oSelectedIntention.PeriodTo) === 0 ? '' : formatter.convertStringToInt(                                                                                                                                        
					oSelectedIntention.TaxIntention),                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                               
				// If multiple Custom Data controls are maintained, select the one which is used for Ledger Mapping                                                                                                                                                        
				aMappedLedgerValue = [],                                                                                                                                                                                                                                   
				aMappedTransType = [],                                                                                                                                                                                                                                     
				sCongr = oReconLedgerData.globalParameters.ConsolidationGroup;                                                                                                                                                                                             
                                                                                                                                                                                                                                                               
			let sMappedLedger = aControlCustomData[aControlCustomData.map(item => item.getProperty("key")).indexOf("mappedLedger")].getValue();                                                                                                                         
			aMappedLedgerValue.push(oReconLedgerData.reconData[sMappedLedger]);                                                                                                                                                                                         
                                                                                                                                                                                                                                                               
			for (let obj of aControlCustomData) {                                                                                                                                                                                                                       
				let sCustomDataValue = obj.getValue();                                                                                                                                                                                                                     
				let sCustomDataKey = obj.getKey();                                                                                                                                                                                                                         
				if (sCustomDataKey === "mappedAdjReason" && (sCustomDataValue === "P&L" || sCustomDataValue === "EQ" || sCustomDataValue ===                                                                                                                               
						"OP&L" || sCustomDataValue === "OPERMANENT" || sCustomDataValue === "OEQ" || sCustomDataValue === "PERMANENT")) {                                                                                                                                        
					for (let i = 0; i < oReconLedgerData.adjustmentReason.length; i++) {                                                                                                                                                                                      
						if (oReconLedgerData.adjustmentReason[i].AdjustmentReason === sCustomDataValue) {                                                                                                                                                                        
                                                                                                                                                                                                                                                               
							aMappedTransType.push(oReconLedgerData.adjustmentReason[i].TransType);                                                                                                                                                                                  
						}                                                                                                                                                                                                                                                        
					}                                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                               
					continue;                                                                                                                                                                                                                                                 
				}                                                                                                                                                                                                                                                          
			}                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
			let sGLAccount = oBindingContext.getProperty("GLAccount").padStart(10, "0");                                                                                                                                                                                
                                                                                                                                                                                                                                                               
			// Find Column heading Text                                                                                                                                                                                                                                 
			let oBindingParts = oEvent.getSource().getBindingInfo("text").parts,                                                                                                                                                                                        
				linkedProperty = oBindingParts[oBindingParts.map(item => item.path.indexOf("MainCurrency") !== 0).indexOf(true)].path;                                                                                                                                     
                                                                                                                                                                                                                                                               
			//  Find the Binded entity Set Property List                                                                                                                                                                                                                
			// let propertyData = this.serviceDataProperty.property;                                                                                                                                                                                                    
			// propertyData = propertyData[propertyData.map(item => item.name).indexOf(linkedProperty)];                                                                                                                                                                
			// let labelData = propertyData.extensions;                                                                                                                                                                                                                 
			// labelData = labelData[labelData.map(item => item.name).indexOf("label")];                                                                                                                                                                                
                                                                                                                                                                                                                                                               
			let sColHeaderValue = aControlCustomData[aControlCustomData.map(item => item.getProperty("key")).indexOf("columnHeader")].getValue();                                                                                                                       
                                                                                                                                                                                                                                                               
			return {                                                                                                                                                                                                                                                    
				"ConsolidationChartOfAccounts": oReconLedgerData.globalParameters.ConsolidationChartofAccounts,                                                                                                                                                            
				"FiscalYear": sFiscalYearVal,                                                                                                                                                                                                                              
				"PeriodFrom": sPeriodFrom || "1",                                                                                                                                                                                                                          
				"PeriodTo": sPeriodTo || "12",                                                                                                                                                                                                                             
				"ConsolidatioUnit": oCnsldtnUnit.getSelectedKey(),                                                                                                                                                                                                         
				"ConsolidationLedger": aMappedLedgerValue,                                                                                                                                                                                                                 
				"Value": oBindingContext.getProperty(linkedProperty),                                                                                                                                                                                                      
				"Currency": oBindingContext.getProperty("MainCurrency"),                                                                                                                                                                                                   
				"GLAccount": sGLAccount,                                                                                                                                                                                                                                   
				"GLAccountDesc": oBindingContext.getProperty("GLAccountMdmText"),                                                                                                                                                                                          
				"ConsolidationVersion": "",                                                                                                                                                                                                                                
				"SelectedIntention": sIntentValue,                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                               
				"ConsolidationGroup": "",                                                                                                                                                                                                                                  
				"PeriodMode": "PER",                                                                                                                                                                                                                                       
				"RefConsolidationDocumentType": "W",                                                                                                                                                                                                                       
                                                                                                                                                                                                                                                               
				// Currently selected currency                                                                                                                                                                                                                             
				"selectedCurrency": oLocalOrGroupCurrency.getSelectedKey(),                                                                                                                                                                                                
				//	Column heading                                                                                                                                                                                                                                          
				"SectionName": sColHeaderValue,                                                                                                                                                                                                                            
				"FinancialTransactionType": aMappedTransType,                                                                                                                                                                                                              
				"MapLedger": sMappedLedger,                                                                                                                                                                                                                                
				"Congr": sCongr                                                                                                                                                                                                                                            
			};                                                                                                                                                                                                                                                          
                                                                                                                                                                                                                                                               
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		_createPTAEntriesFilterData: function (oEvent) {                                                                                                                                                                                                             
                                                                                                                                                                                                                                                               
			let oBindingContext = oEvent.getSource().getBindingContext("PTATableModel"),                                                                                                                                                                                
				oFiscalYear = this.getView().byId("idFiscalYearFilter"),                                                                                                                                                                                                   
				sFiscalYearVal = oFiscalYear.getDateValue().getFullYear(),                                                                                                                                                                                                 
				oPeriodFrom = parseInt(this.getView().byId("idPeriodFromInput").getValue(), [10]),                                                                                                                                                                         
				oPeriodTo = parseInt(this.getView().byId("idPeriodToInput").getValue(), [10]),                                                                                                                                                                             
				oCnsldtnUnit = this.getView().byId("idConsUnit"),                                                                                                                                                                                                          
				sGLAccount = oBindingContext.getProperty("GLAccount"),                                                                                                                                                                                                     
				iTaxIntentionVal = parseInt(this.getView().byId("idIntentionComboBox").getSelectedItem().getBindingContext("intentionVHModel").getObject()                                                                                                                 
					.TaxIntention, [10]),                                                                                                                                                                                                                                     
				sIntentValue = iTaxIntentionVal > 12 ? iTaxIntentionVal : "";                                                                                                                                                                                              
                                                                                                                                                                                                                                                               
			// Find Column heading Text                                                                                                                                                                                                                                 
			// let linkedProperty = oEvent.getSource().getBindingInfo("text").parts[0].path;                                                                                                                                                                            
			let oBindingParts = oEvent.getSource().getBindingInfo("text").parts,                                                                                                                                                                                        
				linkedProperty = oBindingParts[oBindingParts.map(item => item.path.indexOf("MainCurrency") !== 0).indexOf(true)].path;                                                                                                                                     
                                                                                                                                                                                                                                                               
			// Find the Binded entity Set Property List                                                                                                                                                                                                                 
			// let propertyData = this.serviceDataProperty.property;                                                                                                                                                                                                    
			// propertyData = propertyData[propertyData.map(item => item.name).indexOf(linkedProperty)];                                                                                                                                                                
			// let labelData = propertyData.extensions;                                                                                                                                                                                                                 
			// labelData = labelData[labelData.map(item => item.name).indexOf("label")];                                                                                                                                                                                
                                                                                                                                                                                                                                                               
			return {                                                                                                                                                                                                                                                    
				"FiscalYear": sFiscalYearVal,                                                                                                                                                                                                                              
				"PeriodFrom": oPeriodFrom,                                                                                                                                                                                                                                 
				"PeriodTo": oPeriodTo,                                                                                                                                                                                                                                     
				"ConsolidationUnit": oCnsldtnUnit.getSelectedKey(),                                                                                                                                                                                                        
				"Value": oBindingContext.getProperty(linkedProperty),                                                                                                                                                                                                      
				"Currency": oBindingContext.getProperty("MainCurrency"),                                                                                                                                                                                                   
				"GLAccount": sGLAccount,                                                                                                                                                                                                                                   
				"GLAccountDesc": oBindingContext.getProperty("GLAccountMdmText"),                                                                                                                                                                                          
				"SectionName": this.getI18nText("colHeaderPTAPmnt"),                                                                                                                                                                                                       
				"SelectedIntention": sIntentValue                                                                                                                                                                                                                          
			};                                                                                                                                                                                                                                                          
                                                                                                                                                                                                                                                               
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		//*****service Call for profit before tax section                                                                                                                                                                                                            
		_serviceCallPBT: function (oFilters, sServiceURLPBT) {                                                                                                                                                                                                       
			let oServiceCallModel = this.getModel(),                                                                                                                                                                                                                    
				oPBTTable = this.getView().byId("idPBT"),                                                                                                                                                                                                                  
				that = this;                                                                                                                                                                                                                                               
			oPBTTable.setBusy(true);                                                                                                                                                                                                                                    
			oServiceCallModel.read(sServiceURLPBT, {                                                                                                                                                                                                                    
				method: "GET",                                                                                                                                                                                                                                             
				filters: [oFilters],                                                                                                                                                                                                                                       
				success: function (oData, oResponSse) {                                                                                                                                                                                                                    
					oPBTTable.setBusy(false);                                                                                                                                                                                                                                 
					oPBTTable.setModel(new JSONModel(oData), "PBTTableModel");                                                                                                                                                                                                
					aModelTable.push(oPBTTable.getModel("PBTTableModel"));                                                                                                                                                                                                    
				},                                                                                                                                                                                                                                                         
				error: function (oError) {                                                                                                                                                                                                                                 
					oPBTTable.setBusy(false);                                                                                                                                                                                                                                 
					MessageToast.show(that.getI18nText("GAAPIncLossCYServiceCallError"));                                                                                                                                                                                     
                                                                                                                                                                                                                                                               
				}                                                                                                                                                                                                                                                          
			});                                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                               
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		//*****service call for CYTE section                                                                                                                                                                                                                         
		_serviceCallCYTE: function (oFilters, sServiceURLCYTE) {                                                                                                                                                                                                     
			let oServiceCallModel = this.getModel(),                                                                                                                                                                                                                    
				oCYTTable = this.getView().byId("idCYTA"),                                                                                                                                                                                                                 
				that = this;                                                                                                                                                                                                                                               
			oCYTTable.setBusy(true);                                                                                                                                                                                                                                    
			oServiceCallModel.read(sServiceURLCYTE, {                                                                                                                                                                                                                   
				method: "GET",                                                                                                                                                                                                                                             
				filters: [oFilters],                                                                                                                                                                                                                                       
				success: function (oData, oResponse) {                                                                                                                                                                                                                     
					oCYTTable.setBusy(false);                                                                                                                                                                                                                                 
					oCYTTable.setModel(new JSONModel(oData), "CYTETableModel");                                                                                                                                                                                               
					oCYTTable.setVisibleRowCount(oCYTTable.getModel("CYTETableModel").getData().results.length);                                                                                                                                                              
					aModelTable.push(oCYTTable.getModel("CYTETableModel"));                                                                                                                                                                                                   
				},                                                                                                                                                                                                                                                         
				error: function (oError) {                                                                                                                                                                                                                                 
					oCYTTable.setBusy(false);                                                                                                                                                                                                                                 
					MessageToast.show(that.getI18nText("CYTEServiceCallError"));                                                                                                                                                                                              
				}                                                                                                                                                                                                                                                          
			});                                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                               
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		//*****service call for CYTE footer section                                                                                                                                                                                                                  
		_serviceCallCYTEFooter: function (oFilters, sServiceURLCYTEDetails) {                                                                                                                                                                                        
			let oServiceCallModel = this.getModel(),                                                                                                                                                                                                                    
				oFooterTableCYTA = this.getView().byId("idCYTAFooter"),                                                                                                                                                                                                    
				dataFooter = [],                                                                                                                                                                                                                                           
				that = this;                                                                                                                                                                                                                                               
			oFooterTableCYTA.setBusy(true);                                                                                                                                                                                                                             
			oServiceCallModel.read(sServiceURLCYTEDetails, {                                                                                                                                                                                                            
				method: "GET",                                                                                                                                                                                                                                             
				filters: [oFilters],                                                                                                                                                                                                                                       
				success: function (oData, oResponse) {                                                                                                                                                                                                                     
					oFooterTableCYTA.setBusy(false);                                                                                                                                                                                                                          
					if (oData.results.length) {                                                                                                                                                                                                                               
						dataFooter = that._getDataFooter(oData.results, ["TotalCYTE", "GAAPIncomeLossBT", "ReconciliationCheck"], ["totalCYTELabel",                                                                                                                             
							"GAAPIncLossBTLabel", "RecCheckRepGaapLabel"                                                                                                                                                                                                            
						], [false, false, true], [true, true, true]);                                                                                                                                                                                                            
					}                                                                                                                                                                                                                                                         
					oFooterTableCYTA.setModel(new JSONModel(dataFooter), "CYTEFooterTableModel");                                                                                                                                                                             
					aModelTable.push(oFooterTableCYTA.getModel("CYTEFooterTableModel"));                                                                                                                                                                                      
				},                                                                                                                                                                                                                                                         
				error: function (oError) {                                                                                                                                                                                                                                 
					oFooterTableCYTA.setBusy(false);                                                                                                                                                                                                                          
					MessageToast.show(that.getI18nText("CYTEServiceCallError"));                                                                                                                                                                                              
				}                                                                                                                                                                                                                                                          
			});                                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                               
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		//*****service call for G2S section                                                                                                                                                                                                                          
		_serviceCallG2S: function (oFilters, sServiceURLG2S) {                                                                                                                                                                                                       
			let oServiceCallModel = this.getModel(),                                                                                                                                                                                                                    
				oG2SATable = this.getView().byId("idG2SA"),                                                                                                                                                                                                                
				that = this;                                                                                                                                                                                                                                               
			oG2SATable.setBusy(true);                                                                                                                                                                                                                                   
			oServiceCallModel.read(sServiceURLG2S, {                                                                                                                                                                                                                    
				method: "GET",                                                                                                                                                                                                                                             
				filters: [oFilters],                                                                                                                                                                                                                                       
				success: function (oData, oResponse) {                                                                                                                                                                                                                     
					oG2SATable.setBusy(false);                                                                                                                                                                                                                                
					oG2SATable.setModel(new JSONModel(oData), "G2STableModel");                                                                                                                                                                                               
					oG2SATable.setVisibleRowCount(oG2SATable.getModel("G2STableModel").getData().results.length);                                                                                                                                                             
					aModelTable.push(oG2SATable.getModel("G2STableModel"));                                                                                                                                                                                                   
				},                                                                                                                                                                                                                                                         
				error: function (oError) {                                                                                                                                                                                                                                 
					oG2SATable.setBusy(false);                                                                                                                                                                                                                                
					MessageToast.show(that.getI18nText("G2SAServiceCallError"));                                                                                                                                                                                              
				}                                                                                                                                                                                                                                                          
			});                                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                               
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		//*****service call for G2SA footer section                                                                                                                                                                                                                  
		_serviceCallG2SFooter: function (oFilters, sServiceURLG2SDetails) {                                                                                                                                                                                          
			let oServiceCallModel = this.getModel(),                                                                                                                                                                                                                    
				oFooterTableG2SA = this.getView().byId("idG2SAFooter"),                                                                                                                                                                                                    
				dataFooter = [],                                                                                                                                                                                                                                           
				that = this;                                                                                                                                                                                                                                               
			oFooterTableG2SA.setBusy(true);                                                                                                                                                                                                                             
			oServiceCallModel.read(sServiceURLG2SDetails, {                                                                                                                                                                                                             
				method: "GET",                                                                                                                                                                                                                                             
				filters: [oFilters],                                                                                                                                                                                                                                       
				success: function (oData, oResponse) {                                                                                                                                                                                                                     
					oFooterTableG2SA.setBusy(false);                                                                                                                                                                                                                          
					if (oData.results.length) {                                                                                                                                                                                                                               
						dataFooter = that._getDataFooter(oData.results, ["TotalG2S", "STATIncomeLossBT", "ReconciliationCheck"], ["totalG2SALabel",                                                                                                                              
							"STATIncLossBTLabel", "RecCheckStatGaapLabel"                                                                                                                                                                                                           
						], [false, false, true], [true, true, true]);                                                                                                                                                                                                            
					}                                                                                                                                                                                                                                                         
					oFooterTableG2SA.setModel(new JSONModel(dataFooter), "G2SFooterTableModel");                                                                                                                                                                              
					aModelTable.push(oFooterTableG2SA.getModel("G2SFooterTableModel"));                                                                                                                                                                                       
				},                                                                                                                                                                                                                                                         
				error: function (oError) {                                                                                                                                                                                                                                 
					oFooterTableG2SA.setBusy(false);                                                                                                                                                                                                                          
					MessageToast.show(that.getI18nText("G2SAServiceCallError"));                                                                                                                                                                                              
				}                                                                                                                                                                                                                                                          
			});                                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                               
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		//*****service call for S2T section                                                                                                                                                                                                                          
		_serviceCallS2T: function (oFilters, sServiceURLS2T) {                                                                                                                                                                                                       
			let oServiceCallModel = this.getModel(),                                                                                                                                                                                                                    
				oS2TATable = this.getView().byId("idS2TA"),                                                                                                                                                                                                                
				that = this;                                                                                                                                                                                                                                               
			oS2TATable.setBusy(true);                                                                                                                                                                                                                                   
			oServiceCallModel.read(sServiceURLS2T, {                                                                                                                                                                                                                    
				method: "GET",                                                                                                                                                                                                                                             
				filters: [oFilters],                                                                                                                                                                                                                                       
				success: function (oData, oResponse) {                                                                                                                                                                                                                     
					oS2TATable.setBusy(false);                                                                                                                                                                                                                                
					oS2TATable.setModel(new JSONModel(oData), "S2TTableModel");                                                                                                                                                                                               
					oS2TATable.setVisibleRowCount(oS2TATable.getModel("S2TTableModel").getData().results.length);                                                                                                                                                             
					aModelTable.push(oS2TATable.getModel("S2TTableModel"));                                                                                                                                                                                                   
				},                                                                                                                                                                                                                                                         
				error: function (oError) {                                                                                                                                                                                                                                 
					oS2TATable.setBusy(false);                                                                                                                                                                                                                                
					MessageToast.show(that.getI18nText("S2TAServiceCallError"));                                                                                                                                                                                              
				}                                                                                                                                                                                                                                                          
			});                                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                               
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		//*****service call for S2TA footer section                                                                                                                                                                                                                  
		_serviceCallS2TFooter: function (oFilters, sServiceURLS2TDetails) {                                                                                                                                                                                          
			let oServiceCallModel = this.getModel(),                                                                                                                                                                                                                    
				oFooterTableS2TA = this.getView().byId("idS2TAFooter"),                                                                                                                                                                                                    
				dataFooter = [],                                                                                                                                                                                                                                           
				that = this;                                                                                                                                                                                                                                               
			oFooterTableS2TA.setBusy(true);                                                                                                                                                                                                                             
			oServiceCallModel.read(sServiceURLS2TDetails, {                                                                                                                                                                                                             
				method: "GET",                                                                                                                                                                                                                                             
				filters: [oFilters],                                                                                                                                                                                                                                       
				success: function (oData, oResponse) {                                                                                                                                                                                                                     
					oFooterTableS2TA.setBusy(false);                                                                                                                                                                                                                          
					if (oData.results.length) {                                                                                                                                                                                                                               
						dataFooter = that._getDataFooter(oData.results, ["TotalS2T", "FiscalIncomeLossBT", "ReconciliationCheck"], [                                                                                                                                             
							"totalS2TALabel",                                                                                                                                                                                                                                       
							"fiscaalProfitLossBTLabel", "RecCheckTaxLabel"                                                                                                                                                                                                          
						], [false, false, true], [true, true, true]);                                                                                                                                                                                                            
					}                                                                                                                                                                                                                                                         
					oFooterTableS2TA.setModel(new JSONModel(                                                                                                                                                                                                                  
						dataFooter                                                                                                                                                                                                                                               
					), "S2TFooterTableModel");                                                                                                                                                                                                                                
					aModelTable.push(oFooterTableS2TA.getModel("S2TFooterTableModel"));                                                                                                                                                                                       
				},                                                                                                                                                                                                                                                         
				error: function (oError) {                                                                                                                                                                                                                                 
					oFooterTableS2TA.setBusy(false);                                                                                                                                                                                                                          
					MessageToast.show(that.getI18nText("S2TAServiceCallError"));                                                                                                                                                                                              
				}                                                                                                                                                                                                                                                          
			});                                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                               
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		//----------------------	Service Call for PTA section	--------------------------                                                                                                                                                                             
		_serviceCallPTA: function (oFilters, sServiceURLPTA) {                                                                                                                                                                                                       
			let oServiceCallModel = this.getModel(),                                                                                                                                                                                                                    
				oPTATable = this.getView().byId("idTablePTA"),                                                                                                                                                                                                             
				that = this;                                                                                                                                                                                                                                               
			oPTATable.setBusy(true);                                                                                                                                                                                                                                    
			oServiceCallModel.read(sServiceURLPTA, {                                                                                                                                                                                                                    
				method: "GET",                                                                                                                                                                                                                                             
				filters: [oFilters],                                                                                                                                                                                                                                       
				success: function (oData, oResponse) {                                                                                                                                                                                                                     
					oPTATable.setBusy(false);                                                                                                                                                                                                                                 
					oPTATable.setModel(new JSONModel(oData), "PTATableModel");                                                                                                                                                                                                
					oPTATable.setVisibleRowCount(oData.results.length);                                                                                                                                                                                                       
					aModelTable.push(oPTATable.getModel("PTATableModel"));                                                                                                                                                                                                    
					// oPTATable.setVisibleRowCount(3);                                                                                                                                                                                                                       
				},                                                                                                                                                                                                                                                         
				error: function (oError) {                                                                                                                                                                                                                                 
					oPTATable.setBusy(false);                                                                                                                                                                                                                                 
					MessageToast.show(that.getI18nText("PTAServiceCallError"));                                                                                                                                                                                               
				}                                                                                                                                                                                                                                                          
			});                                                                                                                                                                                                                                                         
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		//----------------------	Service Call for PTA Footer	--------------------------                                                                                                                                                                              
		_serviceCallPTAFooter: function (oFilters, sServiceURLPTADetails) {                                                                                                                                                                                          
			let oServiceCallModel = this.getModel(),                                                                                                                                                                                                                    
				oFooterTablePTA = this.getView().byId("idPTAFooter"),                                                                                                                                                                                                      
				dataFooter = [],                                                                                                                                                                                                                                           
				that = this;                                                                                                                                                                                                                                               
			oFooterTablePTA.setBusy(true);                                                                                                                                                                                                                              
			oServiceCallModel.read(sServiceURLPTADetails, {                                                                                                                                                                                                             
				method: "GET",                                                                                                                                                                                                                                             
				filters: [oFilters],                                                                                                                                                                                                                                       
				success: function (oData, oResponse) {                                                                                                                                                                                                                     
					oFooterTablePTA.setBusy(false);                                                                                                                                                                                                                           
					if (oData.results.length) {                                                                                                                                                                                                                               
						dataFooter = that._getDataFooter(oData.results, ["TotalPTA"], ["TotalPTALabel"], [false], [true]);                                                                                                                                                       
					}                                                                                                                                                                                                                                                         
					oFooterTablePTA.setModel(new JSONModel(dataFooter), "PTAFooterTableModel");                                                                                                                                                                               
					aModelTable.push(oFooterTablePTA.getModel("PTAFooterTableModel"));                                                                                                                                                                                        
				},                                                                                                                                                                                                                                                         
				error: function (oError) {                                                                                                                                                                                                                                 
					oFooterTablePTA.setBusy(false);                                                                                                                                                                                                                           
					MessageToast.show(that.getI18nText("S2TAServiceCallError"));                                                                                                                                                                                              
				}                                                                                                                                                                                                                                                          
			});                                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                               
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		//----------------------	Service Call for OTA section	--------------------------                                                                                                                                                                             
		_serviceCallOTA: function (oFilters, sServiceURLOTA) {                                                                                                                                                                                                       
			let oServiceCallModel = this.getModel(),                                                                                                                                                                                                                    
				oOTATable = this.getView().byId("idTableOTA"),                                                                                                                                                                                                             
				that = this;                                                                                                                                                                                                                                               
			oOTATable.setBusy(true);                                                                                                                                                                                                                                    
			oServiceCallModel.read(sServiceURLOTA, {                                                                                                                                                                                                                    
				method: "GET",                                                                                                                                                                                                                                             
				filters: [oFilters],                                                                                                                                                                                                                                       
				success: function (oData, oResponse) {                                                                                                                                                                                                                     
					oOTATable.setBusy(false);                                                                                                                                                                                                                                 
					oOTATable.setModel(new JSONModel(oData), "OTATableModel");                                                                                                                                                                                                
					oOTATable.setVisibleRowCount(oData.results.length);                                                                                                                                                                                                       
					aModelTable.push(oOTATable.getModel("OTATableModel"));                                                                                                                                                                                                    
				},                                                                                                                                                                                                                                                         
				error: function (oError) {                                                                                                                                                                                                                                 
					oOTATable.setBusy(false);                                                                                                                                                                                                                                 
					MessageToast.show(that.getI18nText("OTAServiceCallError"));                                                                                                                                                                                               
				}                                                                                                                                                                                                                                                          
			});                                                                                                                                                                                                                                                         
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		//----------------------	Service Call for OTA Footer	--------------------------                                                                                                                                                                              
		_serviceCallOTAFooter: function (oFilters, sServiceURLOTADetails) {                                                                                                                                                                                          
			let oServiceCallModel = this.getModel(),                                                                                                                                                                                                                    
				oFooterTableOTA = this.getView().byId("idOTAFooter"),                                                                                                                                                                                                      
				dataFooter = [],                                                                                                                                                                                                                                           
				that = this;                                                                                                                                                                                                                                               
			oFooterTableOTA.setBusy(true);                                                                                                                                                                                                                              
			oServiceCallModel.read(sServiceURLOTADetails, {                                                                                                                                                                                                             
				method: "GET",                                                                                                                                                                                                                                             
				filters: [oFilters],                                                                                                                                                                                                                                       
				success: function (oData, oResponse) {                                                                                                                                                                                                                     
					oFooterTableOTA.setBusy(false);                                                                                                                                                                                                                           
					if (oData.results.length) {                                                                                                                                                                                                                               
						dataFooter = that._getDataFooter(oData.results, ["TotalOTA", "TaxableIncLossBCL", "TransferInOut", "LossesUtilized",                                                                                                                                     
							"TaxableIncLoss"                                                                                                                                                                                                                                        
						], ["totalOTALabel", "taxableIncLossBCLLabel", "transferInOutLabel", "lossesUtilizedLabel", "taxableIncomeLossLabel"], [                                                                                                                                 
							false, false, false, false, false                                                                                                                                                                                                                       
						], [                                                                                                                                                                                                                                                     
							true, true, false, false, true                                                                                                                                                                                                                          
						]);                                                                                                                                                                                                                                                      
					}                                                                                                                                                                                                                                                         
					oFooterTableOTA.setModel(new JSONModel(dataFooter), "OTAFooterTableModel");                                                                                                                                                                               
					aModelTable.push(oFooterTableOTA.getModel("OTAFooterTableModel"));                                                                                                                                                                                        
				},                                                                                                                                                                                                                                                         
				error: function (oError) {                                                                                                                                                                                                                                 
					oFooterTableOTA.setBusy(false);                                                                                                                                                                                                                           
					MessageToast.show(that.getI18nText("OTAFooterServiceCallError"));                                                                                                                                                                                         
				}                                                                                                                                                                                                                                                          
			});                                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                               
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		//----------------------	Service Call for CTE section	--------------------------                                                                                                                                                                             
		_serviceCallCTE: function (sServiceURLCTE) {                                                                                                                                                                                                                 
			let oServiceCallModel = this.getModel(),                                                                                                                                                                                                                    
				oCTETable = this.getView().byId("idTableCTE"),                                                                                                                                                                                                             
				that = this;                                                                                                                                                                                                                                               
			oCTETable.setBusy(true);                                                                                                                                                                                                                                    
			oServiceCallModel.read(sServiceURLCTE, {                                                                                                                                                                                                                    
				method: "GET",                                                                                                                                                                                                                                             
				sorters: [                                                                                                                                                                                                                                                 
					new sap.ui.model.Sorter("Sequence")                                                                                                                                                                                                                       
				],                                                                                                                                                                                                                                                         
				success: function (oData, oResponse) {                                                                                                                                                                                                                     
					oCTETable.setBusy(false);                                                                                                                                                                                                                                 
                                                                                                                                                                                                                                                               
					// Move Statutory Tax Rate entry to End                                                                                                                                                                                                                   
					let oTempResult = oData.results[oData.results.map(item => item.Sequence).indexOf("")];                                                                                                                                                                    
					if (oTempResult) {                                                                                                                                                                                                                                        
						oData.results.splice(oData.results.map(item => item.Sequence).indexOf(""), 1);                                                                                                                                                                           
						oData.results.push(oTempResult);                                                                                                                                                                                                                         
					}                                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                               
					oCTETable.setModel(new JSONModel(oData), "CTETableModel");                                                                                                                                                                                                
					oCTETable.setVisibleRowCount(oData.results.length);                                                                                                                                                                                                       
					aModelTable.push(oCTETable.getModel("CTETableModel"));                                                                                                                                                                                                    
				},                                                                                                                                                                                                                                                         
				error: function (oError) {                                                                                                                                                                                                                                 
					oCTETable.setBusy(false);                                                                                                                                                                                                                                 
					MessageToast.show(that.getI18nText("CTEServiceCallError"));                                                                                                                                                                                               
				}                                                                                                                                                                                                                                                          
			});                                                                                                                                                                                                                                                         
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		//----------------------	Service Call for CTE Statutory Footer	--------------------------                                                                                                                                                                    
		_serviceCallCTEStatutoryFooter: function (oFilters, sServiceURLCTEStatDetails) {                                                                                                                                                                             
			let oServiceCallModel = this.getModel(),                                                                                                                                                                                                                    
				oFooterTableCTA = this.getView().byId("idCTEStatFooter"),                                                                                                                                                                                                  
				that = this,                                                                                                                                                                                                                                               
				dataFooter = [];                                                                                                                                                                                                                                           
			oFooterTableCTA.setBusy(true);                                                                                                                                                                                                                              
			oServiceCallModel.read(sServiceURLCTEStatDetails, {                                                                                                                                                                                                         
				method: "GET",                                                                                                                                                                                                                                             
				sorters: [                                                                                                                                                                                                                                                 
					new sap.ui.model.Sorter("Sequence")                                                                                                                                                                                                                       
				],                                                                                                                                                                                                                                                         
				// filters: [oFilters],                                                                                                                                                                                                                                    
				success: function (oData, oResponse) {                                                                                                                                                                                                                     
					oFooterTableCTA.setBusy(false);                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
					// -------------------- Footer Data to be always shown --------- IF footer data not available - use empty data                                                                                                                                            
					// Prepare data Required for Footer.                                                                                                                                                                                                                      
					let aProperties = [],                                                                                                                                                                                                                                     
						aLabels = ["labelTotalForCTECurrentYear", "labelOtherTaxCreditsUtilized", "labelTotalCurrentCorpIncTaxExp",                                                                                                                                              
							"labelCorpIncTaxReceivable", "labelWitholdingTaxCredit", "labelCorpIncTaxPayCY", "transferInOutLabel", "labelSubTotal",                                                                                                                                 
							"labelCTA", "labelCorpIncReceivable"                                                                                                                                                                                                                    
						],                                                                                                                                                                                                                                                       
						aHighlighted = [false, false, false, false, false, false, false, false, false, false],                                                                                                                                                                   
						aDesign = [true, false, true, true, false, false, false, true, false, true];                                                                                                                                                                             
                                                                                                                                                                                                                                                               
					// IF data is available - use provided data.                                                                                                                                                                                                              
					if (oData.results.length > 0) {                                                                                                                                                                                                                           
						aProperties = ["SumTax", "OtherTaxCredit", "TotalCurrentCorpIncTaxExp", "CorpIncTaxReceivable", "WitholdingTaxCredit",                                                                                                                                   
							"CorpIncTaxPayCY", "TransferInOut", "SubTotal", "CTA", "CorpIncReceivable"                                                                                                                                                                              
						];                                                                                                                                                                                                                                                       
					} else { // IF data is not available, Use 'Zero' entry                                                                                                                                                                                                    
						oData.results.push({                                                                                                                                                                                                                                     
							iZeroEntry: "0.00"                                                                                                                                                                                                                                      
						});                                                                                                                                                                                                                                                      
						aProperties = ["iZeroEntry", "iZeroEntry", "iZeroEntry", "iZeroEntry", "iZeroEntry", "iZeroEntry", "iZeroEntry", "iZeroEntry",                                                                                                                           
							"iZeroEntry", "iZeroEntry"                                                                                                                                                                                                                              
						];                                                                                                                                                                                                                                                       
					}                                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                               
					dataFooter = that._getDataFooter(oData.results, aProperties, aLabels, aHighlighted, aDesign);                                                                                                                                                             
					oFooterTableCTA.setModel(new JSONModel(dataFooter), "CTEFooterTableModel");                                                                                                                                                                               
					aModelTable.push(oFooterTableCTA.getModel("CTEFooterTableModel"));                                                                                                                                                                                        
				},                                                                                                                                                                                                                                                         
				error: function (oError) {                                                                                                                                                                                                                                 
					oFooterTableCTA.setBusy(false);                                                                                                                                                                                                                           
					MessageToast.show(that.getI18nText("CTEFooterServiceCallError"));                                                                                                                                                                                         
				}                                                                                                                                                                                                                                                          
			});                                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                               
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		fetchReconLedgerData: function () {                                                                                                                                                                                                                          
			let oServiceCallModel = this.getModel();                                                                                                                                                                                                                    
			let sServiceURL = oServiceCallModel.createKey("/xEY1xSAV_C_Recon_Ledger", {                                                                                                                                                                                 
				"bunit": this.byId("idConsUnit").getSelectedKey()                                                                                                                                                                                                          
			});                                                                                                                                                                                                                                                         
			let that = this;                                                                                                                                                                                                                                            
			oServiceCallModel.read(sServiceURL, {                                                                                                                                                                                                                       
				method: "GET",                                                                                                                                                                                                                                             
				success: function (oData, oResponse) {                                                                                                                                                                                                                     
					var oModel = that.getModel("viewConfigDataModel");                                                                                                                                                                                                        
					oModel.getData().reconData = oData;                                                                                                                                                                                                                       
					oModel.refresh();                                                                                                                                                                                                                                         
					that._fetchCnsldVersion();                                                                                                                                                                                                                                
				},                                                                                                                                                                                                                                                         
				error: function (oError) {                                                                                                                                                                                                                                 
					if (parseInt(oError.statusCode, [10]) !== 404) {                                                                                                                                                                                                          
						MessageToast.show(that.getI18nText("reconServiceCallError"));                                                                                                                                                                                            
					}                                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                               
				}                                                                                                                                                                                                                                                          
			});                                                                                                                                                                                                                                                         
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		_fetchValidTaxRates: function (oParams) {                                                                                                                                                                                                                    
			oParams = oParams ? oParams : {};                                                                                                                                                                                                                           
			let that = this,                                                                                                                                                                                                                                            
				oView = this.getView(),                                                                                                                                                                                                                                    
				sCnsldtnUnitKey = oView.byId("idConsUnit").getSelectedKey(),                                                                                                                                                                                               
				oSelectedItem = oView.byId("idIntentionComboBox").getSelectedItem(),                                                                                                                                                                                       
				oFiscalDate = oView.byId("idFiscalYearFilter").getDateValue(),                                                                                                                                                                                             
				oServiceCallModel = this.getModel();                                                                                                                                                                                                                       
                                                                                                                                                                                                                                                               
			// For change Events of controls - If value blank, do not proceed.                                                                                                                                                                                          
			// if (!sCnsldtnUnitKey || !oSelectedItem || !oFiscalDate) {                                                                                                                                                                                                
			// 	return;                                                                                                                                                                                                                                                 
			// }                                                                                                                                                                                                                                                        
			if (!oSelectedItem) {                                                                                                                                                                                                                                       
				return;                                                                                                                                                                                                                                                    
			}                                                                                                                                                                                                                                                           
			let sConsldtnUnit = oParams.ConsolidationUnit ? oParams.ConsolidationUnit : sCnsldtnUnitKey,                                                                                                                                                                
				iPeriodTo = oParams.PeriodTo ? oParams.PeriodTo : oSelectedItem.getBindingContext("intentionVHModel").getObject().PeriodTo,                                                                                                                                
				sFiscalYearVal = oParams.FiscalYear ? oParams.FiscalYear : oFiscalDate.getFullYear();                                                                                                                                                                      
                                                                                                                                                                                                                                                               
			// If no value exists - return                                                                                                                                                                                                                              
			if (!sConsldtnUnit || !iPeriodTo || !sFiscalYearVal) {                                                                                                                                                                                                      
				return;                                                                                                                                                                                                                                                    
			}                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
			let sServiceURL = "/xEY1xSAV_C_Fetch_Tax_Rates(p_toperiod='" + iPeriodTo + "',p_ryear='" + sFiscalYearVal + "')/Set";                                                                                                                                       
			oServiceCallModel.read(sServiceURL, {                                                                                                                                                                                                                       
				method: "GET",                                                                                                                                                                                                                                             
				filters: [new Filter("ConsolidationUnit", "EQ", sConsldtnUnit)],                                                                                                                                                                                           
				success: function (oData) {                                                                                                                                                                                                                                
					if (oData.results.length < 1) {                                                                                                                                                                                                                           
						MessageBox.warning(that.getI18nText("errorTaxRatesNotMaintained"));                                                                                                                                                                                      
					}                                                                                                                                                                                                                                                         
				},                                                                                                                                                                                                                                                         
				error: function (oError) {                                                                                                                                                                                                                                 
					MessageToast.show(that.getI18nText("warningFetchingTaxRates"));                                                                                                                                                                                           
				}                                                                                                                                                                                                                                                          
			});                                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                               
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		_fetchTiers: function () {                                                                                                                                                                                                                                   
			let that = this,                                                                                                                                                                                                                                            
				oView = this.getView(),                                                                                                                                                                                                                                    
				sCountryKeyVal = oView.byId("idConsUnit").getSelectedItem().getBindingContext().getObject().Country,                                                                                                                                                       
				sFiscalYearVal = oView.byId("idFiscalYearFilter").getDateValue().getFullYear(),                                                                                                                                                                            
				sIntention = oView.byId("idIntentionComboBox").getSelectedKey(),                                                                                                                                                                                           
				oServiceCallModel = this.getModel();                                                                                                                                                                                                                       
                                                                                                                                                                                                                                                               
			if (sIntention === "PER") {                                                                                                                                                                                                                                 
				sIntention = this._getIntentionForManageTier();                                                                                                                                                                                                            
			};                                                                                                                                                                                                                                                          
                                                                                                                                                                                                                                                               
			// If no value exists - return                                                                                                                                                                                                                              
			if (!sCountryKeyVal || !sFiscalYearVal || !sIntention) {                                                                                                                                                                                                    
				return;                                                                                                                                                                                                                                                    
			}                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
			let sServiceURL = "/xEY1xSAV_C_TIERS";                                                                                                                                                                                                                      
			oServiceCallModel.read(sServiceURL, {                                                                                                                                                                                                                       
				method: "GET",                                                                                                                                                                                                                                             
				filters: [new Filter("CountryKey", "EQ", sCountryKeyVal), new Filter("FiscalYear", "EQ", sFiscalYearVal), new Filter("Intention",                                                                                                                          
					"EQ", sIntention)],                                                                                                                                                                                                                                       
				success: function (oData) {                                                                                                                                                                                                                                
					if (oData.results.length < 1) {                                                                                                                                                                                                                           
						MessageBox.warning(that.getI18nText("errorTiersNotMaintained"));                                                                                                                                                                                         
					}                                                                                                                                                                                                                                                         
				},                                                                                                                                                                                                                                                         
				error: function (oError) {                                                                                                                                                                                                                                 
					MessageToast.show(that.getI18nText("warningFetchingTierss"));                                                                                                                                                                                             
				}                                                                                                                                                                                                                                                          
			});                                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                               
		},                                                                                                                                                                                                                                                           
		_EmptyTableCall: function () {                                                                                                                                                                                                                               
			let oView = this.getView();                                                                                                                                                                                                                                 
			oView.byId("idPBT").getModel("PBTTableModel").setData([]);                                                                                                                                                                                                  
			oView.byId("idCYTA").getModel("CYTETableModel").setData([]);                                                                                                                                                                                                
			oView.byId("idCYTAFooter").getModel("CYTEFooterTableModel").setData([]);                                                                                                                                                                                    
			oView.byId("idG2SA").getModel("G2STableModel").setData([]);                                                                                                                                                                                                 
			oView.byId("idG2SAFooter").getModel("G2SFooterTableModel").setData([]);                                                                                                                                                                                     
			oView.byId("idS2TA").getModel("S2TTableModel").setData([]);                                                                                                                                                                                                 
			oView.byId("idS2TAFooter").getModel("S2TFooterTableModel").setData([]);                                                                                                                                                                                     
			oView.byId("idTablePTA").getModel("PTATableModel").setData([]);                                                                                                                                                                                             
			oView.byId("idPTAFooter").getModel("PTAFooterTableModel").setData([]);                                                                                                                                                                                      
			oView.byId("idTableOTA").getModel("OTATableModel").setData([]);                                                                                                                                                                                             
			oView.byId("idOTAFooter").getModel("OTAFooterTableModel").setData([]);                                                                                                                                                                                      
			oView.byId("idTableCTE").getModel("CTETableModel").setData([]);                                                                                                                                                                                             
			oView.byId("idCTEStatFooter").getModel("CTEFooterTableModel").setData([]);                                                                                                                                                                                  
		},                                                                                                                                                                                                                                                           
		//service calls to fetch data for all the tabs                                                                                                                                                                                                               
		_fetchAllTabData: function () {                                                                                                                                                                                                                              
                                                                                                                                                                                                                                                               
			let oView = this.getView(),                                                                                                                                                                                                                                 
				globalParameterData = oView.getModel("viewConfigDataModel").getData();                                                                                                                                                                                     
			if (!globalParameterData.globalParameters || !globalParameterData.globalParameters.ConsolidationChartofAccounts || !                                                                                                                                        
				globalParameterData.globalParameters.ConsolidationGroup) {                                                                                                                                                                                                 
				MessageBox.error(this.getI18nText("errorMaintainGlobalParameter"));                                                                                                                                                                                        
				return;                                                                                                                                                                                                                                                    
			}                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
			let oConsUnit = oView.byId("idConsUnit"),                                                                                                                                                                                                                   
				sConsUnit = oConsUnit.getSelectedKey(),                                                                                                                                                                                                                    
				idCurrType = oView.byId("idCurrency"),                                                                                                                                                                                                                     
				sCurrencyUnit = idCurrType.getSelectedKey(),                                                                                                                                                                                                               
				sCurrText = (idCurrType.getSelectedItem()) ? idCurrType.getSelectedItem().getProperty("additionalText") : globalParameterData.globalParameters                                                                                                             
				.CurrencyType,                                                                                                                                                                                                                                             
				sCountry = (oConsUnit.getSelectedItem()) ? oConsUnit.getSelectedItem().getBindingContext().getObject().Country :                                                                                                                                           
				globalParameterData.globalParameters.Country,                                                                                                                                                                                                              
				sIntention = oView.byId("idIntentionComboBox").getSelectedKey(),                                                                                                                                                                                           
				oFiscalYear = oView.byId("idFiscalYearFilter"),                                                                                                                                                                                                            
				sFiscalYearVal = oFiscalYear.getDateValue().getFullYear(),                                                                                                                                                                                                 
				oPeriodTo = oView.byId("idPeriodToInput"),                                                                                                                                                                                                                 
				paramToYB = parseInt(oPeriodTo.getValue(), [10]),                                                                                                                                                                                                          
				oFilters;                                                                                                                                                                                                                                                  
			if (oView.byId("idIntentionComboBox").getEnabled() === false) {                                                                                                                                                                                             
				MessageBox.error(this.getI18nText("IntentionNotYetOpen") + sFiscalYearVal);                                                                                                                                                                                
				if (aModelTable.length > 0) {                                                                                                                                                                                                                              
					this._EmptyTableCall();                                                                                                                                                                                                                                   
				}                                                                                                                                                                                                                                                          
				return;                                                                                                                                                                                                                                                    
			}                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
			// Intention Filter Data                                                                                                                                                                                                                                    
			let iCurrentPeriod = (oView.byId("idIntentionComboBox").getSelectedItem()) ? parseInt(oView.byId("idIntentionComboBox").getSelectedItem()                                                                                                                   
					.getBindingContext("intentionVHModel").getObject().CurrOpenPeriod, [10]) : globalParameterData.globalParameters.CurrOpenPeriod,                                                                                                                           
				sStatus = (oView.byId("idIntentionComboBox").getSelectedItem()) ? oView.byId("idIntentionComboBox").getSelectedItem()                                                                                                                                      
				.getBindingContext("intentionVHModel").getObject().status : globalParameterData.globalParameters.status,                                                                                                                                                   
				sDesc = (oView.byId("idIntentionComboBox").getSelectedItem()) ? oView.byId("idIntentionComboBox").getSelectedItem()                                                                                                                                        
				.getBindingContext("intentionVHModel").getObject().IntentDescription : globalParameterData.globalParameters.IntentDescription,                                                                                                                             
				sYear = (oView.byId("idIntentionComboBox").getSelectedItem()) ? parseInt(oView.byId("idIntentionComboBox").getSelectedItem()                                                                                                                               
					.getBindingContext("intentionVHModel").getObject().Gjahr, [10]) : globalParameterData.globalParameters.FiscalYear;                                                                                                                                        
                                                                                                                                                                                                                                                               
			if (sStatus === this.getI18nText("YetToOpen")) {                                                                                                                                                                                                            
				this.getBusyDialog().close();                                                                                                                                                                                                                              
				MessageBox.error((this.getModel("i18n").getResourceBundle().getText("ThisIntentionNotYetOpen", [sDesc, sYear])));                                                                                                                                          
				MessageBox.error(sDesc + " " + this.getI18nText("ThisIntentionNotYetOpen") + sYear);                                                                                                                                                                       
				if (aModelTable.length > 0) {                                                                                                                                                                                                                              
					this._EmptyTableCall();                                                                                                                                                                                                                                   
				}                                                                                                                                                                                                                                                          
				return;                                                                                                                                                                                                                                                    
			}                                                                                                                                                                                                                                                           
			if (paramToYB > iCurrentPeriod) {                                                                                                                                                                                                                           
				this.getBusyDialog().close();                                                                                                                                                                                                                              
				MessageBox.error(this.getModel("i18n").getResourceBundle().getText("errorPeriodnotopen", [paramToYB, iCurrentPeriod]));                                                                                                                                    
				if (aModelTable.length > 0) {                                                                                                                                                                                                                              
					this._EmptyTableCall();                                                                                                                                                                                                                                   
				}                                                                                                                                                                                                                                                          
				return;                                                                                                                                                                                                                                                    
			}                                                                                                                                                                                                                                                           
			// Intention Filter Data                                                                                                                                                                                                                                    
			let iTaxIntentionVal = (oView.byId("idIntentionComboBox").getSelectedItem()) ? parseInt(oView.byId("idIntentionComboBox").getSelectedItem()                                                                                                                 
					.getBindingContext("intentionVHModel").getObject().TaxIntention, [10]) : globalParameterData.globalParameters.TaxIntention,                                                                                                                               
				//intentionValue = sIntention,//iSpecialPeriodVal > 12 ? iSpecialPeriodVal : '',                                                                                                                                                                           
				intentionValue = iTaxIntentionVal > 100 ? iTaxIntentionVal : '',                                                                                                                                                                                           
				// Filters                                                                                                                                                                                                                                                 
				oMandFilters = new Filter({                                                                                                                                                                                                                                
					filters: [new Filter("ConsolidationUnit", FilterOperator.EQ, sConsUnit),                                                                                                                                                                                  
						//	new Filter("ChartOfAccounts", FilterOperator.EQ, "CANA"),                                                                                                                                                                                             
						new Filter("ConsolidationChartofAccounts", FilterOperator.EQ, globalParameterData.globalParameters.ConsolidationChartofAccounts),                                                                                                                        
						new Filter("MainCurrency", FilterOperator.EQ, sCurrencyUnit)                                                                                                                                                                                             
					],                                                                                                                                                                                                                                                        
					and: true                                                                                                                                                                                                                                                 
				});                                                                                                                                                                                                                                                        
			oFilters = oMandFilters;                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                               
			if (sIntention === "PER") {                                                                                                                                                                                                                                 
				sIntention = this._getIntentionForManageTier();                                                                                                                                                                                                            
			}                                                                                                                                                                                                                                                           
			aModelTable = [];                                                                                                                                                                                                                                           
			//---------------------------------- Service Call - Profit Before Tax section -------------------------------------------                                                                                                                                   
			let sServiceURLPBT = "/xEY1xSAV_C_PR_ProfitBeforeTax(p_toperiod='" + paramToYB +                                                                                                                                                                            
				"',p_ryear='" + sFiscalYearVal + "',p_taxintention='" + intentionValue + "')/Set";                                                                                                                                                                         
			this._serviceCallPBT(oFilters, sServiceURLPBT);                                                                                                                                                                                                             
                                                                                                                                                                                                                                                               
			//---------------------------------- Service Call - Current Year Tax Expense section-------------------------------------                                                                                                                                   
			let sServiceURLCYTE = "/xEY1xSAV_C_PR_CYTE_Mvmnt(p_toperiod='" + paramToYB +                                                                                                                                                                                
				"',p_ryear='" + sFiscalYearVal + "',p_taxintention='" + intentionValue + "')/Set";                                                                                                                                                                         
			this._serviceCallCYTE(oFilters, sServiceURLCYTE);                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
			//---------------------------------- Service Call - Current Year Tax Expense Footer section-------------------------------------                                                                                                                            
			let sServiceURLCYTEDetails = "/xEY1xSAV_C_PR_CYTE_Details(p_toperiod='" + paramToYB +                                                                                                                                                                       
				"',p_ryear='" + sFiscalYearVal + "',p_taxintention='" + intentionValue + "')/Set";                                                                                                                                                                         
                                                                                                                                                                                                                                                               
			this._serviceCallCYTEFooter(oFilters, sServiceURLCYTEDetails);                                                                                                                                                                                              
                                                                                                                                                                                                                                                               
			//---------------------------------- Service Call - G2S section-----------------------------------------------------------                                                                                                                                  
			let sServiceURLG2S = "/xEY1xSAV_C_PR_G2S_Mvmnt(p_toperiod='" + paramToYB +                                                                                                                                                                                  
				"',p_ryear='" + sFiscalYearVal + "',p_taxintention='" + intentionValue + "')/Set";                                                                                                                                                                         
			this._serviceCallG2S(oFilters, sServiceURLG2S);                                                                                                                                                                                                             
                                                                                                                                                                                                                                                               
			//---------------------------------- Service Call - G2S Footer section-----------------------------------------------------------                                                                                                                           
			let sServiceURLG2SDetails = "/xEY1xSAV_C_PR_G2S_Details(p_toperiod='" + paramToYB +                                                                                                                                                                         
				"',p_ryear='" + sFiscalYearVal + "',p_taxintention='" + intentionValue + "')/Set";                                                                                                                                                                         
			this._serviceCallG2SFooter(oFilters, sServiceURLG2SDetails);                                                                                                                                                                                                
                                                                                                                                                                                                                                                               
			//---------------------------------- Service Call - S2T section-----------------------------------------------------------                                                                                                                                  
			let sServiceURLS2T = "/xEY1xSAV_C_PR_S2T_Mvmnt(p_toperiod='" + paramToYB +                                                                                                                                                                                  
				"',p_ryear='" + sFiscalYearVal + "',p_taxintention='" + intentionValue + "')/Set";                                                                                                                                                                         
			this._serviceCallS2T(oFilters, sServiceURLS2T);                                                                                                                                                                                                             
                                                                                                                                                                                                                                                               
			//---------------------------------- Service Call - S2T Footer section-----------------------------------------------------------                                                                                                                           
			let sServiceURLS2TDetails = "/xEY1xSAV_C_PR_S2T_Details(p_toperiod='" + paramToYB +                                                                                                                                                                         
				"',p_ryear='" + sFiscalYearVal + "',p_taxintention='" + intentionValue + "')/Set";                                                                                                                                                                         
			this._serviceCallS2TFooter(oFilters, sServiceURLS2TDetails);                                                                                                                                                                                                
                                                                                                                                                                                                                                                               
			// --------------------	Service URL for PTA section	-----------------------------------                                                                                                                                                                     
			let _iTaxIntention = iTaxIntentionVal > 12 ? iTaxIntentionVal : '';                                                                                                                                                                                         
			// let iPeriodValue = _iTaxIntention ? _iTaxIntention : paramToYB;                                                                                                                                                                                          
			let sServiceURLPTA = "/xEY1xSAV_C_PR_PTA_Mvmnt(p_toperiod='" + paramToYB + "',p_ryear='" + sFiscalYearVal +                                                                                                                                                 
				"',p_taxintention='" + intentionValue + "')/Set";                                                                                                                                                                                                          
			this._serviceCallPTA(oFilters, sServiceURLPTA);                                                                                                                                                                                                             
                                                                                                                                                                                                                                                               
			// --------------------	Service URL for PTA Footer	-----------------------------------                                                                                                                                                                      
			let sServiceURLPTADetails = "/xEY1xSAV_C_PR_PTA_Details(p_toperiod='" + paramToYB + "',p_ryear='" + sFiscalYearVal +                                                                                                                                        
				"',p_taxintention='" + intentionValue + "')/Set";                                                                                                                                                                                                          
			this._serviceCallPTAFooter(oFilters, sServiceURLPTADetails);                                                                                                                                                                                                
                                                                                                                                                                                                                                                               
			// --------------------	Service URL for OTA section	-----------------------------------                                                                                                                                                                     
			let sServiceURLOTA = "/xEY1xSAV_C_PR_OTA_Mvmnts(p_toperiod='" + paramToYB + "',p_ryear='" + sFiscalYearVal +                                                                                                                                                
				"',p_taxintention='" +                                                                                                                                                                                                                                     
				intentionValue + "')/Set";                                                                                                                                                                                                                                 
			this._serviceCallOTA(oFilters, sServiceURLOTA);                                                                                                                                                                                                             
                                                                                                                                                                                                                                                               
			// --------------------	Service URL for OTA Footer	-----------------------------------                                                                                                                                                                      
			let sServiceURLOTADetails = "/xEY1xSAV_C_PR_OTA_Details(p_toperiod='" + paramToYB + "',p_ryear='" + sFiscalYearVal +                                                                                                                                        
				"',p_taxintention='" + intentionValue + "')/Set";                                                                                                                                                                                                          
			this._serviceCallOTAFooter(oFilters, sServiceURLOTADetails);                                                                                                                                                                                                
                                                                                                                                                                                                                                                               
			// --------------------	Service URL for CTE section	-----------------------------------                                                                                                                                                                     
			let sServiceURLCTE = "/xEY1xSAV_C_PR_CTE_Details(p_cntry='" + sCountry + "',p_ryear='" + sFiscalYearVal +                                                                                                                                                   
				"',p_toperiod='" + paramToYB + "',p_taxintention='" + intentionValue + "',p_currtype='" + sCurrText + "',p_intention='" +                                                                                                                                  
				sIntention + "')/Set";                                                                                                                                                                                                                                     
                                                                                                                                                                                                                                                               
			this._serviceCallCTE(sServiceURLCTE);                                                                                                                                                                                                                       
                                                                                                                                                                                                                                                               
			// --------------------	Service URL for CTE Statutory Footer	-----------------------------------                                                                                                                                                            
			let sServiceURLCTEStatDetails = "/xEY1xSAV_C_PR_CTE_Total(p_cntry='" + sCountry + "',p_ryear='" + sFiscalYearVal +                                                                                                                                          
				"',p_toperiod='" + paramToYB + "',p_taxintention='" + intentionValue + "',p_currtype='" + sCurrText + "',p_intention='" +                                                                                                                                  
				sIntention + "')/Set";                                                                                                                                                                                                                                     
			// oFilterStat = new Filter("CurrencyType", FilterOperator.EQ, sCurrText);                                                                                                                                                                                  
                                                                                                                                                                                                                                                               
			this._serviceCallCTEStatutoryFooter([], sServiceURLCTEStatDetails);                                                                                                                                                                                         
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		/* =========================================================== */                                                                                                                                                                                            
		/* event handlers                                              */                                                                                                                                                                                            
		/* =========================================================== */                                                                                                                                                                                            
                                                                                                                                                                                                                                                               
		//cross app navigation to Manager tiers app                                                                                                                                                                                                                  
		onPressNavtoManageTier: function () {                                                                                                                                                                                                                        
			let oView = this.getView(),                                                                                                                                                                                                                                 
				that = this,                                                                                                                                                                                                                                               
				dGlobalParam = this.getView().getModel("viewConfigDataModel").getData().globalParameters,                                                                                                                                                                  
				oConsUnit = oView.byId("idConsUnit"),                                                                                                                                                                                                                      
				sCnslunitItem = oConsUnit.getSelectedItem(),                                                                                                                                                                                                               
				sCountry, sFiscalYear, sIntention, sCnslUnit,                                                                                                                                                                                                              
				oFiscalYear = oView.byId("idFiscalYearFilter"),                                                                                                                                                                                                            
				sFiscalYearVal = oFiscalYear.getDateValue(),                                                                                                                                                                                                               
				oIntention = oView.byId("idIntentionComboBox"),                                                                                                                                                                                                            
				sIntentionVal = oIntention.getSelectedKey(),                                                                                                                                                                                                               
				oFilterData = this._getFilterData();                                                                                                                                                                                                                       
			oFilterData.ConsolidationChartofAccounts = dGlobalParam.ConsolidationChartofAccounts;                                                                                                                                                                       
			oFilterData.ConsolidationGroup = dGlobalParam.ConsolidationGroup;                                                                                                                                                                                           
			if (sIntentionVal === "PER") {                                                                                                                                                                                                                              
				sIntentionVal = this._getIntentionForManageTier();                                                                                                                                                                                                         
			}                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
			if (sCnslunitItem) {                                                                                                                                                                                                                                        
				sCnslUnit = oConsUnit.getSelectedKey();                                                                                                                                                                                                                    
				sCountry = sCnslunitItem.getBindingContext().getObject().Country;                                                                                                                                                                                          
			} else {                                                                                                                                                                                                                                                    
				sCnslUnit = "";                                                                                                                                                                                                                                            
				sCountry = "";                                                                                                                                                                                                                                             
			}                                                                                                                                                                                                                                                           
			if (sFiscalYearVal) {                                                                                                                                                                                                                                       
				sFiscalYear = sFiscalYearVal.getFullYear().toString();                                                                                                                                                                                                     
			} else {                                                                                                                                                                                                                                                    
				sFiscalYear = "";                                                                                                                                                                                                                                          
			}                                                                                                                                                                                                                                                           
			if (sIntentionVal) {                                                                                                                                                                                                                                        
				sIntention = sIntentionVal;                                                                                                                                                                                                                                
			} else {                                                                                                                                                                                                                                                    
				sIntention = "";                                                                                                                                                                                                                                           
			}                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
			let oNavigationParams = {                                                                                                                                                                                                                                   
				"ConsolidationUnit": sCnslUnit,                                                                                                                                                                                                                            
				"FiscalYear": sFiscalYear,                                                                                                                                                                                                                                 
				"Intention": sIntention,                                                                                                                                                                                                                                   
				"Country": sCountry                                                                                                                                                                                                                                        
			};                                                                                                                                                                                                                                                          
                                                                                                                                                                                                                                                               
			//pass state to be saved as custom data                                                                                                                                                                                                                     
			var oInnerAppData = {                                                                                                                                                                                                                                       
				customData: oFilterData                                                                                                                                                                                                                                    
			};                                                                                                                                                                                                                                                          
			// callback function in case of errors                                                                                                                                                                                                                      
			var fnOnError = function (oError) {                                                                                                                                                                                                                         
				MessageBox.error(that.getI18nText("navigationError"));                                                                                                                                                                                                     
			};                                                                                                                                                                                                                                                          
			//	this.performCrossAppNavigation("ManageTier", "manage", false, oNavigationParams);                                                                                                                                                                        
                                                                                                                                                                                                                                                               
			//(sSemanticObject, sActionName, vParameters?, oAppData?, fnError?)                                                                                                                                                                                         
			this.oNavigationHandler.navigate("ManageTier", "manage", oNavigationParams, oInnerAppData, fnOnError);                                                                                                                                                      
                                                                                                                                                                                                                                                               
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		onSearchButtonPressed: function (oEvent) {                                                                                                                                                                                                                   
                                                                                                                                                                                                                                                               
			this._fetchAllTabData();                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                               
			// Trigger this only once - After the Dropdowns are binded                                                                                                                                                                                                  
			// if (this.bGlobalParameterTriggerred) {                                                                                                                                                                                                                   
			this._fetchTiers();                                                                                                                                                                                                                                         
			// 	this.bGlobalParameterTriggerred = false;                                                                                                                                                                                                                
			// }                                                                                                                                                                                                                                                        
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		// <!--	~~~~~~~~~~~~~~~~~~~~~~~~~ Drill Down to Journal Entries	~~~~~~~~~~~~~~~~~~~~~~~~	-->                                                                                                                                                                 
		onPressJournalEntriesDetail: function (oEvent) {                                                                                                                                                                                                             
			// Generate Data for Journal Entries Filter                                                                                                                                                                                                                 
			var oJournalEntryData = this._createJournalEntriesFilterData(oEvent);                                                                                                                                                                                       
                                                                                                                                                                                                                                                               
			// If oJournalEntryData does not exist, then Do Not Execute code further                                                                                                                                                                                    
			if (!oJournalEntryData) {                                                                                                                                                                                                                                   
				return;                                                                                                                                                                                                                                                    
			}                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
			var oModel = new JSONModel(oJournalEntryData);                                                                                                                                                                                                              
			this.getOwnerComponent().setModel(oModel, "JournalEntryData");                                                                                                                                                                                              
                                                                                                                                                                                                                                                               
			this.oRouter.navTo("JournalEntries");                                                                                                                                                                                                                       
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		// <!--	~~~~~~~~~~~~~~~~~~~~~~~~~	PTA Drill Down	~~~~~~~~~~~~~~~~~~~~~~~~	-->                                                                                                                                                                                
		onPressPTAEntriesDetail: function (oEvent) {                                                                                                                                                                                                                 
			// Generate Data for PTA Entries Filter                                                                                                                                                                                                                     
			var oPTAEntryData = this._createPTAEntriesFilterData(oEvent);                                                                                                                                                                                               
                                                                                                                                                                                                                                                               
			if (oPTAEntryData.GLAccount === this.getI18nText("BalanceCheckSumLabel")) {                                                                                                                                                                                 
				return;                                                                                                                                                                                                                                                    
			}                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
			var oModel = new JSONModel(oPTAEntryData);                                                                                                                                                                                                                  
			this.getOwnerComponent().setModel(oModel, "PTAEntryConfigData");                                                                                                                                                                                            
			this.oRouter.navTo("PTAEntries");                                                                                                                                                                                                                           
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		onBeforeVariantSaveFilterBar: function (oEvent) {                                                                                                                                                                                                            
			let oView = this.getView(),                                                                                                                                                                                                                                 
				oFilterBar = oView.byId("idProfitReconSmartFilterBar"),                                                                                                                                                                                                    
				oCnsdUnit = oView.byId("idConsUnit"),                                                                                                                                                                                                                      
				oFiscalYear = oView.byId("idFiscalYearFilter"),                                                                                                                                                                                                            
				oIntention = oView.byId("idIntentionComboBox"),                                                                                                                                                                                                            
				oCurrency = oView.byId("idCurrency"),                                                                                                                                                                                                                      
				oPeriodTo = oView.byId("idPeriodToInput");                                                                                                                                                                                                                 
                                                                                                                                                                                                                                                               
			oFilterBar.setFilterData({                                                                                                                                                                                                                                  
				"_CUSTOM": {                                                                                                                                                                                                                                               
					"ConsolidationUnit": oCnsdUnit.getSelectedKey(),                                                                                                                                                                                                          
					"FiscalYear": oFiscalYear.getValue(),                                                                                                                                                                                                                     
					"Intention": oIntention.getSelectedKey(),                                                                                                                                                                                                                 
					"CurrType": oCurrency.getSelectedKey(),                                                                                                                                                                                                                   
					"PeriodTo": oPeriodTo.getValue(),                                                                                                                                                                                                                         
					"VariantID": oFilterBar.getCurrentVariantId()                                                                                                                                                                                                             
				}                                                                                                                                                                                                                                                          
			});                                                                                                                                                                                                                                                         
		},                                                                                                                                                                                                                                                           
		onAfterVariantLoadFilterBar: function (oEvent) {                                                                                                                                                                                                             
			var oView = this.getView();                                                                                                                                                                                                                                 
			var oFilterBar = oView.byId("idProfitReconSmartFilterBar");                                                                                                                                                                                                 
			var oCnsdUnit = oView.byId("idConsUnit");                                                                                                                                                                                                                   
			var oFiscalYear = oView.byId("idFiscalYearFilter");                                                                                                                                                                                                         
			let oIntention = oView.byId("idIntentionComboBox");                                                                                                                                                                                                         
			var oCurrency = oView.byId("idCurrency");                                                                                                                                                                                                                   
			let oPeriodTo = this.getView().byId("idPeriodToInput");                                                                                                                                                                                                     
			var oFilterData = oFilterBar.getFilterData()["_CUSTOM"];                                                                                                                                                                                                    
                                                                                                                                                                                                                                                               
			//	Setting Data to filter fields                                                                                                                                                                                                                            
			oCnsdUnit.setSelectedKey(oFilterData.ConsolidationUnit);                                                                                                                                                                                                    
			oFiscalYear.setValue(oFilterData.FiscalYear);                                                                                                                                                                                                               
			oIntention.setSelectedKey(oFilterData.Intention);                                                                                                                                                                                                           
			oCurrency.setSelectedKey(oFilterData.CurrType);                                                                                                                                                                                                             
			oPeriodTo.setValue(formatter.convertStringToInt(oFilterData.PeriodTo));                                                                                                                                                                                     
                                                                                                                                                                                                                                                               
			// If Consolidation Unit is loaded, then call Ledger Data                                                                                                                                                                                                   
			if (oFilterData.ConsolidationUnit) {                                                                                                                                                                                                                        
				this.fetchReconLedgerData();                                                                                                                                                                                                                               
			}                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
			// Fetch Currency Data for Dropdown                                                                                                                                                                                                                         
			if (oFilterData.CurrType) {                                                                                                                                                                                                                                 
				oCurrency.setVisible(true);                                                                                                                                                                                                                                
				this._fetchCurrencyData(true);                                                                                                                                                                                                                             
			}                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
			if (oFilterData.ConsolidationUnit && oFilterData.FiscalYear && oFilterData.Intention) {                                                                                                                                                                     
				this._fetchValidTaxRates({                                                                                                                                                                                                                                 
					ConsolidationUnit: oFilterData.ConsolidationUnit,                                                                                                                                                                                                         
					PeriodTo: oFilterData.PeriodTo,                                                                                                                                                                                                                           
					FiscalYear: oFilterData.FiscalYear.getFullYear()                                                                                                                                                                                                          
				});                                                                                                                                                                                                                                                        
			}                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
			// Intention Data to be loaded.                                                                                                                                                                                                                             
			// If Intention is 'Empty' in Saved Variant, still we need data in DropDown list.                                                                                                                                                                           
			//this._fetchIntentionData();                                                                                                                                                                                                                               
			let aParam = [oFilterData.ConsolidationUnit, oFilterData.FiscalYear.getFullYear()];                                                                                                                                                                         
			this._fetchIntentionStatus(aParam);                                                                                                                                                                                                                         
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		onChangeDatePickerFilter: function (oEvent) {                                                                                                                                                                                                                
			let oDP = oEvent.getSource(),                                                                                                                                                                                                                               
				oReconLedgerData = this.getModel("viewConfigDataModel").getData(),                                                                                                                                                                                         
				sBunit = oReconLedgerData.globalParameters.ConsolidationUnit;                                                                                                                                                                                              
			sBunit = this.getView().byId("idConsUnit").getProperty("selectedKey");                                                                                                                                                                                      
			if (oEvent.getParameter("valid")) {                                                                                                                                                                                                                         
				oDP.setValueState("None");                                                                                                                                                                                                                                 
				let sYear = oDP.getDateValue().getFullYear();                                                                                                                                                                                                              
				sYear = this.getView().byId("idFiscalYearFilter").getDateValue().getFullYear();                                                                                                                                                                            
				let aParam = [sBunit, sYear];                                                                                                                                                                                                                              
				this._fetchIntentionStatus(aParam);                                                                                                                                                                                                                        
			} else {                                                                                                                                                                                                                                                    
				oDP.setValueState("Error");                                                                                                                                                                                                                                
			}                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
			// Check if Tax Rate Maintained for selected intention.                                                                                                                                                                                                     
			if (oEvent.getSource().getValue()) {                                                                                                                                                                                                                        
				this._fetchValidTaxRates();                                                                                                                                                                                                                                
			}                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
			// Check if Tiers maintained.                                                                                                                                                                                                                               
			// this._fetchTiers();                                                                                                                                                                                                                                      
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		onConsUnitChange: function (oEvent) {                                                                                                                                                                                                                        
			this._fetchCurrencyData(false);                                                                                                                                                                                                                             
			this.fetchReconLedgerData();                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                               
			// Check if Tax Rate Maintained for selected intention.                                                                                                                                                                                                     
			if (oEvent.getSource().getValue()) {                                                                                                                                                                                                                        
				this._fetchValidTaxRates();                                                                                                                                                                                                                                
			}                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
			let oBunit = this.getView().byId("idConsUnit").getProperty("selectedKey");                                                                                                                                                                                  
			let aParam = [oBunit, this.getView().byId("idFiscalYearFilter").getDateValue().getFullYear()];                                                                                                                                                              
			this._fetchIntentionStatus(aParam);                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                               
			// Check if Tiers maintained.                                                                                                                                                                                                                               
			// this._fetchTiers();                                                                                                                                                                                                                                      
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		onChangeIntentionComboBox: function (oEvent) {                                                                                                                                                                                                               
			let oView = this.getView(),                                                                                                                                                                                                                                 
				oIntentionCtrl = oView.byId("idIntentionComboBox"),                                                                                                                                                                                                        
				oSelectedItem = oIntentionCtrl.getSelectedItem();                                                                                                                                                                                                          
                                                                                                                                                                                                                                                               
			// Validation for Invalid data	                                                                                                                                                                                                                             
			if (!oSelectedItem) {                                                                                                                                                                                                                                       
				oIntentionCtrl.setSelectedItem("");                                                                                                                                                                                                                        
				return;                                                                                                                                                                                                                                                    
			}                                                                                                                                                                                                                                                           
			this._managePeriodFieldsEditability(true);                                                                                                                                                                                                                  
                                                                                                                                                                                                                                                               
			// Check if Tax Rate Maintained for selected intention.                                                                                                                                                                                                     
			if (oEvent.getSource().getValue()) {                                                                                                                                                                                                                        
				this._fetchValidTaxRates();                                                                                                                                                                                                                                
			}                                                                                                                                                                                                                                                           
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		onLiveChangePeriodTo: function () {                                                                                                                                                                                                                          
			let oPeriodTo = this.getView().byId("idPeriodToInput");                                                                                                                                                                                                     
			let p_fromyb = parseInt(this.getView().byId("idPeriodFromInput").getValue(), [10]);                                                                                                                                                                         
			let p_toyb = parseInt(oPeriodTo.getValue(), [10]);                                                                                                                                                                                                          
                                                                                                                                                                                                                                                               
			oPeriodTo.setValueState("None");                                                                                                                                                                                                                            
			if (isNaN(p_toyb)) {                                                                                                                                                                                                                                        
				return;                                                                                                                                                                                                                                                    
			}                                                                                                                                                                                                                                                           
			//	If PeriodTo < PeriodFrom, then do not execute further service call&nbsp;                                                                                                                                                                                 
			if (p_toyb < p_fromyb) {                                                                                                                                                                                                                                    
				oPeriodTo.setValueState("Error");                                                                                                                                                                                                                          
				oPeriodTo.setValueStateText(this.getI18nText("periodToLessThanPeriodFromErrorMsg"));                                                                                                                                                                       
				return;                                                                                                                                                                                                                                                    
			} else if (p_toyb > '012') {                                                                                                                                                                                                                                
				oPeriodTo.setValueState("Error");                                                                                                                                                                                                                          
				oPeriodTo.setValueStateText(this.getI18nText("periodToGreaterThanLastPeriod"));                                                                                                                                                                            
				return;                                                                                                                                                                                                                                                    
			} else {                                                                                                                                                                                                                                                    
				this._managePerodicIntentionStatus(p_toyb);                                                                                                                                                                                                                
			}                                                                                                                                                                                                                                                           
		}                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                               
	});                                                                                                                                                                                                                                                           
});                                                                                                                                                                                                                                                            